###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         25/Aug/2018  23:10:05 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  F:\work\iot-hardware\logger\logger\Components\stac #
#                          k\zdo\ZDProfile.c                                  #
#    Command line       =  -f F:\work\iot-hardware\logger\logger\Projects\zst #
#                          ack\Samples\GenericApp\CC2530DB\..\..\..\Tools\CC2 #
#                          530DB\f8wEndev.cfg (-DCPU32MHZ -DROOT=__near_func  #
#                          -DMAC_CFG_TX_DATA_MAX=3 -DMAC_CFG_TX_MAX=6         #
#                          -DMAC_CFG_RX_MAX=3) -f F:\work\iot-hardware\logger #
#                          \logger\Projects\zstack\Samples\GenericApp\CC2530D #
#                          B\..\..\..\Tools\CC2530DB\f8wConfig.cfg            #
#                          (-DZIGBEEPRO -DSECURE=0 -DZG_SECURE_DYNAMIC=0      #
#                          -DREFLECTOR -DDEFAULT_CHANLIST=0x00000800          #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 F:\work\iot-hardware\logger #
#                          \logger\Components\stack\zdo\ZDProfile.c -D        #
#                          NWK_AUTO_POLL -D ZTOOL_P1 -D MT_TASK -D            #
#                          MT_SYS_FUNC -D MT_ZDO_FUNC -D LCD_SUPPORTED=DEBUG  #
#                          -D xPOWER_SAVING -lC F:\work\iot-hardware\logger\l #
#                          ogger\Projects\zstack\Samples\GenericApp\CC2530DB\ #
#                          EndDeviceEB\List\ -lA F:\work\iot-hardware\logger\ #
#                          logger\Projects\zstack\Samples\GenericApp\CC2530DB #
#                          \EndDeviceEB\List\ --diag_suppress Pe001,Pa010 -o  #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\EndDeviceEB\Obj\ -e   #
#                          --no_cse --no_unroll --no_inline --no_code_motion  #
#                          --no_tbaa --debug --core=plain --dptr=16,1         #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I F:\work\iot-hardware\logger\logger\Projects\zst #
#                          ack\Samples\GenericApp\CC2530DB\ -I                #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\Source\ -I         #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\ZMain\TI2530 #
#                          DB\ -I F:\work\iot-hardware\logger\logger\Projects #
#                          \zstack\Samples\GenericApp\CC2530DB\..\..\..\..\.. #
#                          \Components\hal\include\ -I                        #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\hal\target\CC2530EB\ -I                       #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\mac\include\ -I F:\work\iot-hardware\logger\l #
#                          ogger\Projects\zstack\Samples\GenericApp\CC2530DB\ #
#                          ..\..\..\..\..\Components\mac\high_level\ -I       #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\mac\low_level\srf04\ -I                       #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\mac\low_level\srf04\single_chip\ -I           #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\mt\ -I F:\work\iot-hardware\logger\logger\Pro #
#                          jects\zstack\Samples\GenericApp\CC2530DB\..\..\..\ #
#                          ..\..\Components\osal\include\ -I                  #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\services\saddr\ -I F:\work\iot-hardware\logge #
#                          r\logger\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\Components\services\sdata\ -I    #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\stack\af\ -I F:\work\iot-hardware\logger\logg #
#                          er\Projects\zstack\Samples\GenericApp\CC2530DB\..\ #
#                          ..\..\..\..\Components\stack\nwk\ -I               #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\stack\sapi\ -I F:\work\iot-hardware\logger\lo #
#                          gger\Projects\zstack\Samples\GenericApp\CC2530DB\. #
#                          .\..\..\..\..\Components\stack\sec\ -I             #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\stack\sys\ -I F:\work\iot-hardware\logger\log #
#                          ger\Projects\zstack\Samples\GenericApp\CC2530DB\.. #
#                          \..\..\..\..\Components\stack\zdo\ -I              #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\zmac\ -I F:\work\iot-hardware\logger\logger\P #
#                          rojects\zstack\Samples\GenericApp\CC2530DB\..\..\. #
#                          .\..\..\Components\zmac\f8w\ -Ol                   #
#                          --require_prototypes                               #
#    List file          =  F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\EndDeviceEB\List\ZDPr #
#                          ofile.lst                                          #
#    Object file        =  F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\EndDeviceEB\Obj\ZDPro #
#                          file.r51                                           #
#                                                                             #
#                                                                             #
###############################################################################

F:\work\iot-hardware\logger\logger\Components\stack\zdo\ZDProfile.c
      1          /**************************************************************************************************
      2            Filename:       ZDProfile.c
      3            Revised:        $Date: 2010-10-13 10:54:13 -0700 (Wed, 13 Oct 2010) $
      4            Revision:       $Revision: 24112 $
      5          
      6            Description:    This is the Zigbee Device Profile.
      7          
      8          
      9            Copyright 2004-2010 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41           * INCLUDES
     42           */
     43          #include "ZComdef.h"
     44          #include "OSAL.h"
     45          #include "AF.h"
     46          #include "NLMEDE.h"
     47          #include "nwk_util.h"
     48          #include "APS.h"
     49          
     50          #include "AddrMgr.h"
     51          #include "ZDConfig.h"
     52          #include "ZDProfile.h"
     53          #include "ZDObject.h"
     54          #include "ZDNwkMgr.h"
     55          
     56          #if defined( LCD_SUPPORTED )
     57            #include "OnBoard.h"
     58          #endif
     59          
     60          #include "nwk_util.h"
     61          
     62          #if defined( MT_ZDO_FUNC )
     63            #include "MT_ZDO.h"
     64          #endif
     65          
     66          /*********************************************************************
     67           * MACROS
     68           */
     69          
     70          #define ZADDR_TO_AFADDR( pZADDR, AFADDR ) {                            \
     71            (AFADDR).endPoint = ZDP_AF_ENDPOINT;                                 \
     72            (AFADDR).addrMode = (afAddrMode_t)(pZADDR)->addrMode;                \
     73            (AFADDR).addr.shortAddr = (pZADDR)->addr.shortAddr;                  \
     74          }
     75          
     76          #define FillAndSendBuffer( TRANSSEQ, ADDR, ID, LEN, BUF ) {     \
     77            afStatus_t stat;                                    \
     78            ZDP_TmpBuf = (BUF)+1;                               \
     79            stat = fillAndSend( (TRANSSEQ), (ADDR), (ID), (LEN) );          \
     80            osal_mem_free( (BUF) );                             \
     81            ZDP_TmpBuf = ZDP_Buf+1;                             \
     82            return stat;                                        \
     83          }
     84          
     85          #define FillAndSendTxOptions( TRANSSEQ, ADDR, ID, LEN, TxO ) {  \
     86            afStatus_t stat;                                    \
     87            ZDP_TxOptions = (TxO);                              \
     88            stat = fillAndSend( (TRANSSEQ), (ADDR), (ID), (LEN) );          \
     89            ZDP_TxOptions = AF_TX_OPTIONS_NONE;                 \
     90            return stat;                                        \
     91          }
     92          
     93          #define FillAndSendBufferTxOptions( TRANSSEQ, ADDR, ID, LEN, BUF, TxO ) { \
     94            afStatus_t stat;                                    \
     95            ZDP_TmpBuf = (BUF)+1;                               \
     96            ZDP_TxOptions = (TxO);                              \
     97            stat = fillAndSend( (TRANSSEQ), (ADDR), (ID), (LEN) );          \
     98            osal_mem_free( (BUF) );                             \
     99            ZDP_TmpBuf = ZDP_Buf+1;                             \
    100            ZDP_TxOptions = AF_TX_OPTIONS_NONE;                 \
    101            return stat;                                        \
    102          }
    103          
    104          /*********************************************************************
    105           * CONSTANTS
    106           */
    107          
    108          #define ZDP_BUF_SZ          80
    109          

   \                                 In  segment CODE_C, align 1
    110          CONST byte ZDP_AF_ENDPOINT = 0;
   \                     ZDP_AF_ENDPOINT:
   \   000000   00           DB 0
    111          
    112          /*********************************************************************
    113           * TYPEDEFS
    114           */
    115          typedef struct
    116          {
    117            void *next;
    118            uint8 taskID;
    119            uint16 clusterID;
    120          } ZDO_MsgCB_t;
    121          
    122          
    123          /*********************************************************************
    124           * GLOBAL VARIABLES
    125           */
    126          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    127          byte ZDP_TransID = 0;
   \                     ZDP_TransID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    128          
    129          /*********************************************************************
    130           * EXTERNAL VARIABLES
    131           */
    132          
    133          extern endPointDesc_t ZDApp_epDesc;
    134          
    135          /*********************************************************************
    136           * EXTERNAL FUNCTIONS
    137           */
    138          
    139          /*********************************************************************
    140           * LOCAL FUNCTIONS
    141           */
    142          
    143          static afStatus_t fillAndSend( uint8 *transSeq, zAddrType_t *addr, cId_t clusterID, byte len );
    144          uint8 ZDO_SendMsgCBs( zdoIncomingMsg_t *inMsg );
    145          void zdpProcessAddrReq( zdoIncomingMsg_t *inMsg );
    146          
    147          /*********************************************************************
    148           * LOCAL VARIABLES
    149           */
    150          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    151          static uint8  ZDP_Buf[ ZDP_BUF_SZ ];
   \                     ZDP_Buf:
   \   000000                DS 80
   \   000050                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_I, align 1, keep-with-next
    152          static uint8 *ZDP_TmpBuf = ZDP_Buf+1;
   \                     ZDP_TmpBuf:
   \   000000                DS 2
   \   000002                REQUIRE `?<Initializer for ZDP_TmpBuf>`
   \   000002                REQUIRE __INIT_XDATA_I
    153          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    154          byte ZDP_TxOptions = AF_TX_OPTIONS_NONE;
   \                     ZDP_TxOptions:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    155          ZDO_MsgCB_t *zdoMsgCBs = (ZDO_MsgCB_t *)NULL;
   \                     zdoMsgCBs:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    156          
    157          /*********************************************************************
    158           * ZDO Message Processing table
    159           */
    160          
    161          typedef void (*pfnZDPMsgProcessor)( zdoIncomingMsg_t *inMsg );
    162          
    163          typedef struct
    164          {
    165            uint16                clusterID;
    166            pfnZDPMsgProcessor    pFn;
    167          } zdpMsgProcItem_t;
    168          

   \                                 In  segment CODE_C, align 1
    169          CONST zdpMsgProcItem_t zdpMsgProcs[] =
   \                     zdpMsgProcs:
   \   000000   0100         DW 1
   \   000002   ....         DW ??zdpProcessAddrReq?relay
   \   000004   0200         DW 2
   \   000006   ....         DW ??ZDO_ProcessNodeDescReq?relay
   \   000008   0300         DW 3
   \   00000A   ....         DW ??ZDO_ProcessPowerDescReq?relay
   \   00000C   0400         DW 4
   \   00000E   ....         DW ??ZDO_ProcessSimpleDescReq?relay
   \   000010   0500         DW 5
   \   000012   ....         DW ??ZDO_ProcessActiveEPReq?relay
   \   000014   0600         DW 6
   \   000016   ....         DW ??ZDO_ProcessMatchDescReq?relay
   \   000018   1100         DW 17
   \   00001A   ....         DW ??ZDO_ProcessUserDescReq?relay
   \   00001C   1400         DW 20
   \   00001E   ....         DW ??ZDO_ProcessUserDescSet?relay
   \   000020   1500         DW 21
   \   000022   ....         DW ??ZDO_ProcessServerDiscReq?relay
   \   000024   FFFF         DW 65535
   \   000026   0000         DW 0H
    170          {
    171          #if ( RFD_RCVC_ALWAYS_ON==TRUE ) || ( ZG_BUILD_RTR_TYPE )
    172            // These aren't processed by sleeping end devices.
    173            { NWK_addr_req,           zdpProcessAddrReq },
    174            { Device_annce,           ZDO_ProcessDeviceAnnce },
    175          #endif
    176            { IEEE_addr_req,          zdpProcessAddrReq },
    177            { Node_Desc_req,          ZDO_ProcessNodeDescReq },
    178            { Power_Desc_req,         ZDO_ProcessPowerDescReq },
    179            { Simple_Desc_req,        ZDO_ProcessSimpleDescReq },
    180            { Active_EP_req,          ZDO_ProcessActiveEPReq },
    181            { Match_Desc_req,         ZDO_ProcessMatchDescReq },
    182          #if defined ( ZDO_MGMT_NWKDISC_RESPONSE )
    183            { Mgmt_NWK_Disc_req,      ZDO_ProcessMgmtNwkDiscReq },
    184          #endif
    185          #if defined ( ZDO_MGMT_LQI_RESPONSE ) && ( ZG_BUILD_RTR_TYPE )
    186            { Mgmt_Lqi_req,           ZDO_ProcessMgmtLqiReq },
    187          #endif
    188          #if defined ( ZDO_MGMT_RTG_RESPONSE ) && ( ZG_BUILD_RTR_TYPE )
    189            { Mgmt_Rtg_req,           ZDO_ProcessMgmtRtgReq },
    190          #endif
    191          #if defined ( ZDO_MGMT_BIND_RESPONSE ) && defined ( REFLECTOR )
    192            { Mgmt_Bind_req,          ZDO_ProcessMgmtBindReq },
    193          #endif
    194          #if defined ( ZDO_MGMT_JOINDIRECT_RESPONSE ) && ( ZG_BUILD_RTR_TYPE )
    195            { Mgmt_Direct_Join_req,   ZDO_ProcessMgmtDirectJoinReq },
    196          #endif
    197          #if defined ( ZDO_MGMT_LEAVE_RESPONSE )
    198            { Mgmt_Leave_req,         ZDO_ProcessMgmtLeaveReq },
    199          #endif
    200          #if defined ( ZDO_MGMT_PERMIT_JOIN_RESPONSE )  && ( ZG_BUILD_RTR_TYPE )
    201            { Mgmt_Permit_Join_req,   ZDO_ProcessMgmtPermitJoinReq },
    202          #endif
    203          #if defined ( ZDO_USERDESC_RESPONSE )
    204            { User_Desc_req,          ZDO_ProcessUserDescReq },
    205          #endif
    206          #if defined ( ZDO_USERDESCSET_RESPONSE )
    207            { User_Desc_set,          ZDO_ProcessUserDescSet },
    208          #endif
    209          #if defined ( ZDO_SERVERDISC_RESPONSE )
    210            { Server_Discovery_req,   ZDO_ProcessServerDiscReq },
    211          #endif
    212            {0xFFFF, NULL} // Last
    213          };
    214          
    215          /*********************************************************************
    216           * @fn          fillAndSend
    217           *
    218           * @brief       Combined to reduce space
    219           *
    220           * @param
    221           * @param
    222           *
    223           * @return      afStatus_t
    224           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    225          static afStatus_t fillAndSend( uint8 *transSeq, zAddrType_t *addr, cId_t clusterID, byte len )
   \                     fillAndSend:
    226          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 12
   \   000005   74F4         MOV     A,#-0xc
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 2,R2
   \   00000C   8B..         MOV     ?V0 + 3,R3
   \   00000E   EC           MOV     A,R4
   \   00000F   FE           MOV     R6,A
   \   000010   ED           MOV     A,R5
   \   000011   FF           MOV     R7,A
   \   000012   89..         MOV     ?V0 + 4,R1
   \   000014   741A         MOV     A,#0x1a
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F5..         MOV     ?V0 + 0,A
   \   00001C   A3           INC     DPTR
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F5..         MOV     ?V0 + 1,A
    227            afAddrType_t afAddr;
    228          
    229            osal_memset( &afAddr, 0, sizeof(afAddrType_t) );
   \   000020                ; Setup parameters for call to function osal_memset
   \   000020   7C0C         MOV     R4,#0xc
   \   000022   7D00         MOV     R5,#0x0
   \   000024   7900         MOV     R1,#0x0
   \   000026   85..82       MOV     DPL,?XSP + 0
   \   000029   85..83       MOV     DPH,?XSP + 1
   \   00002C   AA82         MOV     R2,DPL
   \   00002E   AB83         MOV     R3,DPH
   \   000030   12....       LCALL   ??osal_memset?relay
    230            ZADDR_TO_AFADDR( addr, afAddr );
   \   000033   90....       MOV     DPTR,#ZDP_AF_ENDPOINT
   \   000036   E4           CLR     A
   \   000037   93           MOVC    A,@A+DPTR
   \   000038   C0E0         PUSH    A
   \   00003A   7409         MOV     A,#0x9
   \   00003C   12....       LCALL   ?XSTACK_DISP0_8
   \   00003F   D0E0         POP     A
   \   000041   F0           MOVX    @DPTR,A
   \   000042   8E82         MOV     DPL,R6
   \   000044   8F83         MOV     DPH,R7
   \   000046   A3           INC     DPTR
   \   000047   A3           INC     DPTR
   \   000048   A3           INC     DPTR
   \   000049   A3           INC     DPTR
   \   00004A   A3           INC     DPTR
   \   00004B   A3           INC     DPTR
   \   00004C   A3           INC     DPTR
   \   00004D   A3           INC     DPTR
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   C0E0         PUSH    A
   \   000051   7408         MOV     A,#0x8
   \   000053   12....       LCALL   ?XSTACK_DISP0_8
   \   000056   D0E0         POP     A
   \   000058   F0           MOVX    @DPTR,A
   \   000059   8E82         MOV     DPL,R6
   \   00005B   8F83         MOV     DPH,R7
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   F8           MOV     R0,A
   \   00005F   A3           INC     DPTR
   \   000060   E0           MOVX    A,@DPTR
   \   000061   F9           MOV     R1,A
   \   000062   85..82       MOV     DPL,?XSP + 0
   \   000065   85..83       MOV     DPH,?XSP + 1
   \   000068   E8           MOV     A,R0
   \   000069   F0           MOVX    @DPTR,A
   \   00006A   A3           INC     DPTR
   \   00006B   E9           MOV     A,R1
   \   00006C   F0           MOVX    @DPTR,A
    231          
    232            *(ZDP_TmpBuf-1) = *transSeq;
   \   00006D   85..82       MOV     DPL,?V0 + 2
   \   000070   85..83       MOV     DPH,?V0 + 3
   \   000073   E0           MOVX    A,@DPTR
   \   000074   C0E0         PUSH    A
   \   000076   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000079   E0           MOVX    A,@DPTR
   \   00007A   24FF         ADD     A,#-0x1
   \   00007C   F8           MOV     R0,A
   \   00007D   A3           INC     DPTR
   \   00007E   E0           MOVX    A,@DPTR
   \   00007F   34FF         ADDC    A,#-0x1
   \   000081   F9           MOV     R1,A
   \   000082   8882         MOV     DPL,R0
   \   000084   8983         MOV     DPH,R1
   \   000086   D0E0         POP     A
   \   000088   F0           MOVX    @DPTR,A
    233          
    234            return AF_DataRequest( &afAddr, &ZDApp_epDesc, clusterID,
    235                                     (uint16)(len+1), (uint8*)(ZDP_TmpBuf-1),
    236                                     transSeq, ZDP_TxOptions,  AF_DEFAULT_RADIUS );
   \   000089                ; Setup parameters for call to function AF_DataRequest
   \   000089   75..1E       MOV     ?V0 + 5,#0x1e
   \   00008C   78..         MOV     R0,#?V0 + 5
   \   00008E   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000091   78..         MOV     R0,#?V0 + 2
   \   000093   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000096   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000099   E0           MOVX    A,@DPTR
   \   00009A   24FF         ADD     A,#-0x1
   \   00009C   F5..         MOV     ?V0 + 2,A
   \   00009E   A3           INC     DPTR
   \   00009F   E0           MOVX    A,@DPTR
   \   0000A0   34FF         ADDC    A,#-0x1
   \   0000A2   F5..         MOV     ?V0 + 3,A
   \   0000A4   78..         MOV     R0,#?V0 + 2
   \   0000A6   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000A9   85....       MOV     ?V0 + 2,?V0 + 4
   \   0000AC   75..00       MOV     ?V0 + 3,#0x0
   \   0000AF   E5..         MOV     A,?V0 + 2
   \   0000B1   2401         ADD     A,#0x1
   \   0000B3   F5..         MOV     ?V0 + 2,A
   \   0000B5   E5..         MOV     A,?V0 + 3
   \   0000B7   3400         ADDC    A,#0x0
   \   0000B9   F5..         MOV     ?V0 + 3,A
   \   0000BB   78..         MOV     R0,#?V0 + 2
   \   0000BD   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000C0   78..         MOV     R0,#?V0 + 0
   \   0000C2   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000C5   90....       MOV     DPTR,#ZDP_TxOptions
   \   0000C8   E0           MOVX    A,@DPTR
   \   0000C9   F9           MOV     R1,A
   \   0000CA   7C..         MOV     R4,#ZDApp_epDesc & 0xff
   \   0000CC   7D..         MOV     R5,#(ZDApp_epDesc >> 8) & 0xff
   \   0000CE   7409         MOV     A,#0x9
   \   0000D0   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D3   AA82         MOV     R2,DPL
   \   0000D5   AB83         MOV     R3,DPH
   \   0000D7   12....       LCALL   ??AF_DataRequest?relay
   \   0000DA   7409         MOV     A,#0x9
   \   0000DC   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000DF   740C         MOV     A,#0xc
   \   0000E1   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000E4   7F06         MOV     R7,#0x6
   \   0000E6   02....       LJMP    ?BANKED_LEAVE_XDATA
    237          
    238          }
    239          
    240          /*********************************************************************
    241           * @fn          ZDP_SendData
    242           *
    243           * @brief       This builds and send a request message that has
    244           *              NWKAddrOfInterest as its only parameter.
    245           *
    246           * @param       dstAddr - destination address
    247           * @param       cmd - clusterID
    248           * @param       dataLen - number of bytes of data
    249           * @param       data - pointer to the data
    250           * @param       SecurityEnable - Security Options
    251           *
    252           * @return      afStatus_t
    253           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    254          afStatus_t ZDP_SendData( uint8 *TransSeq, zAddrType_t *dstAddr, uint16 cmd,
   \                     ZDP_SendData:
    255                                  byte len, uint8 *buf, byte SecurityEnable )
    256          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   740E         MOV     A,#0xe
   \   000009   12....       LCALL   ?XSTACK_DISP0_8
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   F5..         MOV     ?V0 + 2,A
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   F5..         MOV     ?V0 + 3,A
   \   000013   7410         MOV     A,#0x10
   \   000015   12....       LCALL   ?XSTACK_DISP0_8
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F5..         MOV     ?V0 + 4,A
   \   00001B   A3           INC     DPTR
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F5..         MOV     ?V0 + 5,A
   \   00001F   7412         MOV     A,#0x12
   \   000021   12....       LCALL   ?XSTACK_DISP0_8
   \   000024   E0           MOVX    A,@DPTR
   \   000025   F5..         MOV     ?V0 + 1,A
    257            uint8 *pBuf = ZDP_TmpBuf;
   \   000027   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   F8           MOV     R0,A
   \   00002C   A3           INC     DPTR
   \   00002D   E0           MOVX    A,@DPTR
   \   00002E   F9           MOV     R1,A
    258            byte cnt = len;
   \   00002F   EE           MOV     A,R6
   \   000030   FF           MOV     R7,A
   \   000031   8022         SJMP    ??ZDP_SendData_0
    259          
    260            while ( cnt-- )
    261            {
    262              *pBuf++ = *buf++;
   \                     ??ZDP_SendData_1:
   \   000033   85..82       MOV     DPL,?V0 + 4
   \   000036   85..83       MOV     DPH,?V0 + 5
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   8882         MOV     DPL,R0
   \   00003C   8983         MOV     DPH,R1
   \   00003E   F0           MOVX    @DPTR,A
   \   00003F   85..82       MOV     DPL,?V0 + 4
   \   000042   85..83       MOV     DPH,?V0 + 5
   \   000045   A3           INC     DPTR
   \   000046   8582..       MOV     ?V0 + 4,DPL
   \   000049   8583..       MOV     ?V0 + 5,DPH
   \   00004C   8882         MOV     DPL,R0
   \   00004E   8983         MOV     DPH,R1
   \   000050   A3           INC     DPTR
   \   000051   A882         MOV     R0,DPL
   \   000053   A983         MOV     R1,DPH
    263            }
   \                     ??ZDP_SendData_0:
   \   000055   8F..         MOV     ?V0 + 0,R7
   \   000057   74FF         MOV     A,#-0x1
   \   000059   25..         ADD     A,?V0 + 0
   \   00005B   FF           MOV     R7,A
   \   00005C   E5..         MOV     A,?V0 + 0
   \   00005E   70D3         JNZ     ??ZDP_SendData_1
    264          
    265            FillAndSendTxOptions( TransSeq, dstAddr, cmd, len, ((SecurityEnable) ? AF_EN_SECURITY : 0) );
   \   000060   E5..         MOV     A,?V0 + 1
   \   000062   6004         JZ      ??ZDP_SendData_2
   \   000064   7440         MOV     A,#0x40
   \   000066   8002         SJMP    ??ZDP_SendData_3
   \                     ??ZDP_SendData_2:
   \   000068   7400         MOV     A,#0x0
   \                     ??ZDP_SendData_3:
   \   00006A   90....       MOV     DPTR,#ZDP_TxOptions
   \   00006D   F0           MOVX    @DPTR,A
   \   00006E                ; Setup parameters for call to function fillAndSend
   \   00006E   78..         MOV     R0,#?V0 + 2
   \   000070   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000073   EE           MOV     A,R6
   \   000074   F9           MOV     R1,A
   \   000075   12....       LCALL   ??fillAndSend?relay
   \   000078   7402         MOV     A,#0x2
   \   00007A   12....       LCALL   ?DEALLOC_XSTACK8
   \   00007D   E9           MOV     A,R1
   \   00007E   F9           MOV     R1,A
   \   00007F   90....       MOV     DPTR,#ZDP_TxOptions
   \   000082   7400         MOV     A,#0x0
   \   000084   F0           MOVX    @DPTR,A
   \   000085   7F06         MOV     R7,#0x6
   \   000087   02....       LJMP    ?BANKED_LEAVE_XDATA
    266          }
    267          
    268          /*********************************************************************
    269           * @fn          ZDP_NWKAddrOfInterestReq
    270           *
    271           * @brief       This builds and send a request message that has
    272           *              NWKAddrOfInterest as its only parameter.
    273           *
    274           * @param       dstAddr - destination address
    275           * @param       nwkAddr - 16 bit address
    276           * @param       SecurityEnable - Security Options
    277           *
    278           * @return      afStatus_t
    279           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    280          afStatus_t ZDP_NWKAddrOfInterestReq( zAddrType_t *dstAddr, uint16 nwkAddr,
   \                     ZDP_NWKAddrOfInterestReq:
    281                                               byte cmd, byte SecurityEnable )
    282          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    283            (void)SecurityEnable;  // Intentionally unreferenced parameter
    284          
    285            ZDP_TmpBuf[0] = LO_UINT16( nwkAddr );
   \   000007   EC           MOV     A,R4
   \   000008   C0E0         PUSH    A
   \   00000A   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F8           MOV     R0,A
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   F583         MOV     DPH,A
   \   000013   8882         MOV     DPL,R0
   \   000015   D0E0         POP     A
   \   000017   F0           MOVX    @DPTR,A
    286            ZDP_TmpBuf[1] = HI_UINT16( nwkAddr );
   \   000018   E4           CLR     A
   \   000019   ED           MOV     A,R5
   \   00001A   FC           MOV     R4,A
   \   00001B   C0E0         PUSH    A
   \   00001D   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000020   E0           MOVX    A,@DPTR
   \   000021   F8           MOV     R0,A
   \   000022   A3           INC     DPTR
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F583         MOV     DPH,A
   \   000026   8882         MOV     DPL,R0
   \   000028   A3           INC     DPTR
   \   000029   D0E0         POP     A
   \   00002B   F0           MOVX    @DPTR,A
    287          
    288            return fillAndSend( &ZDP_TransID, dstAddr, cmd, 2 );
   \   00002C                ; Setup parameters for call to function fillAndSend
   \   00002C   8E..         MOV     ?V0 + 0,R6
   \   00002E   75..00       MOV     ?V0 + 1,#0x0
   \   000031   78..         MOV     R0,#?V0 + 0
   \   000033   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000036   7902         MOV     R1,#0x2
   \   000038   EA           MOV     A,R2
   \   000039   FC           MOV     R4,A
   \   00003A   EB           MOV     A,R3
   \   00003B   FD           MOV     R5,A
   \   00003C   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   00003E   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   000040   12....       LCALL   ??fillAndSend?relay
   \   000043   7402         MOV     A,#0x2
   \   000045   12....       LCALL   ?DEALLOC_XSTACK8
   \   000048   7F02         MOV     R7,#0x2
   \   00004A   02....       LJMP    ?BANKED_LEAVE_XDATA
    289          }
    290          
    291          /*********************************************************************
    292           * Address Requests
    293           */
    294          
    295          /*********************************************************************
    296           * @fn          ZDP_NwkAddrReq
    297           *
    298           * @brief       This builds and send a NWK_addr_req message.  This
    299           *              function sends a broadcast message looking for a 16
    300           *              bit address with a 64 bit address as bait.
    301           *
    302           * @param       IEEEAddress - looking for this device
    303           * @param       SecurityEnable - Security Options
    304           *
    305           * @return      afStatus_t
    306           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    307          afStatus_t ZDP_NwkAddrReq( uint8 *IEEEAddress, byte ReqType,
   \                     ZDP_NwkAddrReq:
    308                                     byte StartIndex, byte SecurityEnable )
    309          {
   \   000000   74F3         MOV     A,#-0xd
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 13
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   89..         MOV     ?V0 + 2,R1
   \   000010   8C..         MOV     ?V0 + 3,R4
    310            uint8 *pBuf = ZDP_TmpBuf;
   \   000012   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000015   E0           MOVX    A,@DPTR
   \   000016   FE           MOV     R6,A
   \   000017   A3           INC     DPTR
   \   000018   E0           MOVX    A,@DPTR
   \   000019   FF           MOV     R7,A
    311            byte len = Z_EXTADDR_LEN + 1 + 1;  // IEEEAddress + ReqType + StartIndex.
   \   00001A   75..0A       MOV     ?V0 + 4,#0xa
    312            zAddrType_t dstAddr;
    313          
    314            (void)SecurityEnable;  // Intentionally unreferenced parameter
    315          
    316            if ( osal_ExtAddrEqual( saveExtAddr, IEEEAddress ) == FALSE )
   \   00001D                ; Setup parameters for call to function sAddrExtCmp
   \   00001D   AC..         MOV     R4,?V0 + 0
   \   00001F   AD..         MOV     R5,?V0 + 1
   \   000021   7A..         MOV     R2,#saveExtAddr & 0xff
   \   000023   7B..         MOV     R3,#(saveExtAddr >> 8) & 0xff
   \   000025   12....       LCALL   ??sAddrExtCmp?relay
   \   000028   E9           MOV     A,R1
   \   000029   7017         JNZ     ??ZDP_NwkAddrReq_0
    317            {
    318              dstAddr.addrMode = AddrBroadcast;
   \   00002B   7408         MOV     A,#0x8
   \   00002D   12....       LCALL   ?XSTACK_DISP0_8
   \   000030   740F         MOV     A,#0xf
   \   000032   F0           MOVX    @DPTR,A
    319              dstAddr.addr.shortAddr = NWK_BROADCAST_SHORTADDR_DEVRXON;
   \   000033   85..82       MOV     DPL,?XSP + 0
   \   000036   85..83       MOV     DPH,?XSP + 1
   \   000039   74FD         MOV     A,#-0x3
   \   00003B   F0           MOVX    @DPTR,A
   \   00003C   A3           INC     DPTR
   \   00003D   74FF         MOV     A,#-0x1
   \   00003F   F0           MOVX    @DPTR,A
   \   000040   801B         SJMP    ??ZDP_NwkAddrReq_1
    320            }
    321            else
    322            {
    323              dstAddr.addrMode = Addr16Bit;
   \                     ??ZDP_NwkAddrReq_0:
   \   000042   7408         MOV     A,#0x8
   \   000044   12....       LCALL   ?XSTACK_DISP0_8
   \   000047   7402         MOV     A,#0x2
   \   000049   F0           MOVX    @DPTR,A
    324              dstAddr.addr.shortAddr = ZDAppNwkAddr.addr.shortAddr;
   \   00004A   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   F8           MOV     R0,A
   \   00004F   A3           INC     DPTR
   \   000050   E0           MOVX    A,@DPTR
   \   000051   F9           MOV     R1,A
   \   000052   85..82       MOV     DPL,?XSP + 0
   \   000055   85..83       MOV     DPH,?XSP + 1
   \   000058   E8           MOV     A,R0
   \   000059   F0           MOVX    @DPTR,A
   \   00005A   A3           INC     DPTR
   \   00005B   E9           MOV     A,R1
   \   00005C   F0           MOVX    @DPTR,A
    325            }
    326          
    327            pBuf = osal_cpyExtAddr( pBuf, IEEEAddress );
   \                     ??ZDP_NwkAddrReq_1:
   \   00005D                ; Setup parameters for call to function sAddrExtCpy
   \   00005D   AC..         MOV     R4,?V0 + 0
   \   00005F   AD..         MOV     R5,?V0 + 1
   \   000061   EE           MOV     A,R6
   \   000062   FA           MOV     R2,A
   \   000063   EF           MOV     A,R7
   \   000064   FB           MOV     R3,A
   \   000065   12....       LCALL   ??sAddrExtCpy?relay
   \   000068   8A..         MOV     ?V0 + 0,R2
   \   00006A   8B..         MOV     ?V0 + 1,R3
   \   00006C   AE..         MOV     R6,?V0 + 0
   \   00006E   AF..         MOV     R7,?V0 + 1
    328          
    329            *pBuf++ = ReqType;
   \   000070   E5..         MOV     A,?V0 + 2
   \   000072   8E82         MOV     DPL,R6
   \   000074   8F83         MOV     DPH,R7
   \   000076   E5..         MOV     A,?V0 + 2
   \   000078   F0           MOVX    @DPTR,A
   \   000079   8E82         MOV     DPL,R6
   \   00007B   8F83         MOV     DPH,R7
   \   00007D   A3           INC     DPTR
   \   00007E   AE82         MOV     R6,DPL
   \   000080   AF83         MOV     R7,DPH
    330            *pBuf++ = StartIndex;
   \   000082   E5..         MOV     A,?V0 + 3
   \   000084   8E82         MOV     DPL,R6
   \   000086   8F83         MOV     DPH,R7
   \   000088   E5..         MOV     A,?V0 + 3
   \   00008A   F0           MOVX    @DPTR,A
   \   00008B   8E82         MOV     DPL,R6
   \   00008D   8F83         MOV     DPH,R7
   \   00008F   A3           INC     DPTR
   \   000090   AE82         MOV     R6,DPL
   \   000092   AF83         MOV     R7,DPH
    331          
    332            return fillAndSend( &ZDP_TransID, &dstAddr, NWK_addr_req, len );
   \   000094                ; Setup parameters for call to function fillAndSend
   \   000094   E4           CLR     A
   \   000095   F5..         MOV     ?V0 + 0,A
   \   000097   F5..         MOV     ?V0 + 1,A
   \   000099   78..         MOV     R0,#?V0 + 0
   \   00009B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00009E   A9..         MOV     R1,?V0 + 4
   \   0000A0   7402         MOV     A,#0x2
   \   0000A2   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A5   AC82         MOV     R4,DPL
   \   0000A7   AD83         MOV     R5,DPH
   \   0000A9   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   0000AB   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   0000AD   12....       LCALL   ??fillAndSend?relay
   \   0000B0   7402         MOV     A,#0x2
   \   0000B2   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000B5   7409         MOV     A,#0x9
   \   0000B7   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000BA   7F05         MOV     R7,#0x5
   \   0000BC   02....       LJMP    ?BANKED_LEAVE_XDATA
    333          }
    334          
    335          /*********************************************************************
    336           * @fn          ZDP_IEEEAddrReq
    337           *
    338           * @brief       This builds and send a IEEE_addr_req message.  This
    339           *              function sends a unicast message looking for a 64
    340           *              bit IEEE address with a 16 bit address as bait.
    341           *
    342           * @param       ReqType - ZDP_IEEEADDR_REQTYPE_SINGLE or
    343           *                        ZDP_IEEEADDR_REQTYPE_EXTENDED
    344           * @param       SecurityEnable - Security Options
    345           *
    346           * @return      afStatus_t
    347           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    348          afStatus_t ZDP_IEEEAddrReq( uint16 shortAddr, byte ReqType,
   \                     ZDP_IEEEAddrReq:
    349                                      byte StartIndex, byte SecurityEnable )
    350          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   89..         MOV     ?V0 + 0,R1
   \   00000C   8C..         MOV     ?V0 + 1,R4
    351            uint8 *pBuf = ZDP_TmpBuf;
   \   00000E   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000011   E0           MOVX    A,@DPTR
   \   000012   FE           MOV     R6,A
   \   000013   A3           INC     DPTR
   \   000014   E0           MOVX    A,@DPTR
   \   000015   FF           MOV     R7,A
    352            byte len = 2 + 1 + 1;  // shortAddr + ReqType + StartIndex.
   \   000016   7904         MOV     R1,#0x4
    353            zAddrType_t dstAddr;
    354          
    355            (void)SecurityEnable;  // Intentionally unreferenced parameter
    356          
    357            dstAddr.addrMode = (afAddrMode_t)Addr16Bit;
   \   000018   7408         MOV     A,#0x8
   \   00001A   12....       LCALL   ?XSTACK_DISP0_8
   \   00001D   7402         MOV     A,#0x2
   \   00001F   F0           MOVX    @DPTR,A
    358            dstAddr.addr.shortAddr = shortAddr;
   \   000020   85..82       MOV     DPL,?XSP + 0
   \   000023   85..83       MOV     DPH,?XSP + 1
   \   000026   EA           MOV     A,R2
   \   000027   F0           MOVX    @DPTR,A
   \   000028   A3           INC     DPTR
   \   000029   EB           MOV     A,R3
   \   00002A   F0           MOVX    @DPTR,A
    359          
    360            *pBuf++ = LO_UINT16( shortAddr );
   \   00002B   EA           MOV     A,R2
   \   00002C   8E82         MOV     DPL,R6
   \   00002E   8F83         MOV     DPH,R7
   \   000030   F0           MOVX    @DPTR,A
   \   000031   8E82         MOV     DPL,R6
   \   000033   8F83         MOV     DPH,R7
   \   000035   A3           INC     DPTR
   \   000036   AE82         MOV     R6,DPL
   \   000038   AF83         MOV     R7,DPH
    361            *pBuf++ = HI_UINT16( shortAddr );
   \   00003A   E4           CLR     A
   \   00003B   EB           MOV     A,R3
   \   00003C   FA           MOV     R2,A
   \   00003D   8E82         MOV     DPL,R6
   \   00003F   8F83         MOV     DPH,R7
   \   000041   F0           MOVX    @DPTR,A
   \   000042   8E82         MOV     DPL,R6
   \   000044   8F83         MOV     DPH,R7
   \   000046   A3           INC     DPTR
   \   000047   AE82         MOV     R6,DPL
   \   000049   AF83         MOV     R7,DPH
    362          
    363            *pBuf++ = ReqType;
   \   00004B   E5..         MOV     A,?V0 + 0
   \   00004D   8E82         MOV     DPL,R6
   \   00004F   8F83         MOV     DPH,R7
   \   000051   E5..         MOV     A,?V0 + 0
   \   000053   F0           MOVX    @DPTR,A
   \   000054   8E82         MOV     DPL,R6
   \   000056   8F83         MOV     DPH,R7
   \   000058   A3           INC     DPTR
   \   000059   AE82         MOV     R6,DPL
   \   00005B   AF83         MOV     R7,DPH
    364            *pBuf++ = StartIndex;
   \   00005D   E5..         MOV     A,?V0 + 1
   \   00005F   8E82         MOV     DPL,R6
   \   000061   8F83         MOV     DPH,R7
   \   000063   E5..         MOV     A,?V0 + 1
   \   000065   F0           MOVX    @DPTR,A
   \   000066   8E82         MOV     DPL,R6
   \   000068   8F83         MOV     DPH,R7
   \   00006A   A3           INC     DPTR
   \   00006B   AE82         MOV     R6,DPL
   \   00006D   AF83         MOV     R7,DPH
    365          
    366            return fillAndSend( &ZDP_TransID, &dstAddr, IEEE_addr_req, len );
   \   00006F                ; Setup parameters for call to function fillAndSend
   \   00006F   75..01       MOV     ?V0 + 2,#0x1
   \   000072   75..00       MOV     ?V0 + 3,#0x0
   \   000075   78..         MOV     R0,#?V0 + 2
   \   000077   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00007A   7402         MOV     A,#0x2
   \   00007C   12....       LCALL   ?XSTACK_DISP0_8
   \   00007F   AC82         MOV     R4,DPL
   \   000081   AD83         MOV     R5,DPH
   \   000083   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   000085   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   000087   12....       LCALL   ??fillAndSend?relay
   \   00008A   7402         MOV     A,#0x2
   \   00008C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00008F   7409         MOV     A,#0x9
   \   000091   12....       LCALL   ?DEALLOC_XSTACK8
   \   000094   7F04         MOV     R7,#0x4
   \   000096   02....       LJMP    ?BANKED_LEAVE_XDATA
    367          }
    368          
    369          /*********************************************************************
    370           * @fn          ZDP_MatchDescReq
    371           *
    372           * @brief       This builds and send a Match_Desc_req message.  This
    373           *              function sends a broadcast or unicast message
    374           *              requesting the list of endpoint/interfaces that
    375           *              match profile ID and cluster IDs.
    376           *
    377           * @param       dstAddr - destination address
    378           * @param       nwkAddr - network address of interest
    379           * @param       ProfileID - Profile ID
    380           * @param       NumInClusters - number of input clusters
    381           * @param       InClusterList - input cluster ID list
    382           * @param       NumOutClusters - number of output clusters
    383           * @param       OutClusterList - output cluster ID list
    384           * @param       SecurityEnable - Security Options
    385           *
    386           * @return      afStatus_t
    387           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    388          afStatus_t ZDP_MatchDescReq( zAddrType_t *dstAddr, uint16 nwkAddr,
   \                     ZDP_MatchDescReq:
    389                                          uint16 ProfileID,
    390                                          byte NumInClusters, cId_t *InClusterList,
    391                                          byte NumOutClusters, cId_t *OutClusterList,
    392                                          byte SecurityEnable )
    393          {
   \   000000   74ED         MOV     A,#-0x13
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 19
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   7413         MOV     A,#0x13
   \   000009   12....       LCALL   ?XSTACK_DISP0_8
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   F5..         MOV     ?V0 + 0,A
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   F5..         MOV     ?V0 + 1,A
   \   000013   7415         MOV     A,#0x15
   \   000015   12....       LCALL   ?XSTACK_DISP0_8
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F5..         MOV     ?V0 + 8,A
   \   00001B   A3           INC     DPTR
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F5..         MOV     ?V0 + 9,A
   \   00001F   7417         MOV     A,#0x17
   \   000021   12....       LCALL   ?XSTACK_DISP0_8
   \   000024   E0           MOVX    A,@DPTR
   \   000025   F5..         MOV     ?V0 + 10,A
   \   000027   7418         MOV     A,#0x18
   \   000029   12....       LCALL   ?XSTACK_DISP0_8
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F5..         MOV     ?V0 + 6,A
   \   00002F   A3           INC     DPTR
   \   000030   E0           MOVX    A,@DPTR
   \   000031   F5..         MOV     ?V0 + 7,A
    394            uint8 *pBuf = ZDP_TmpBuf;
   \   000033   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000036   E0           MOVX    A,@DPTR
   \   000037   F8           MOV     R0,A
   \   000038   A3           INC     DPTR
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   F9           MOV     R1,A
    395            // nwkAddr+ProfileID+NumInClusters+NumOutClusters.
    396            byte i, len = 2 + 2 + 1 + 1;  // nwkAddr+ProfileID+NumInClusters+NumOutClusters.
   \   00003B   7F06         MOV     R7,#0x6
    397          
    398            (void)SecurityEnable;  // Intentionally unreferenced parameter
    399          
    400            len += (NumInClusters + NumOutClusters) * sizeof(uint16);
   \   00003D   75F002       MOV     B,#0x2
   \   000040   8E..         MOV     ?V0 + 4,R6
   \   000042   75..00       MOV     ?V0 + 5,#0x0
   \   000045   85....       MOV     ?V0 + 2,?V0 + 10
   \   000048   75..00       MOV     ?V0 + 3,#0x0
   \   00004B   E5..         MOV     A,?V0 + 4
   \   00004D   25..         ADD     A,?V0 + 2
   \   00004F   F5..         MOV     ?V0 + 2,A
   \   000051   E5..         MOV     A,?V0 + 5
   \   000053   35..         ADDC    A,?V0 + 3
   \   000055   F5..         MOV     ?V0 + 3,A
   \   000057   E5..         MOV     A,?V0 + 2
   \   000059   A4           MUL     AB
   \   00005A   2F           ADD     A,R7
   \   00005B   FF           MOV     R7,A
    401          
    402            if ( len >= ZDP_BUF_SZ-1 )
   \   00005C   EF           MOV     A,R7
   \   00005D   C3           CLR     C
   \   00005E   944F         SUBB    A,#0x4f
   \   000060   4005         JC      ??ZDP_MatchDescReq_0
    403            {
    404              return afStatus_MEM_FAIL;
   \   000062   7910         MOV     R1,#0x10
   \   000064   02....       LJMP    ??ZDP_MatchDescReq_1 & 0xFFFF
    405            }
    406          
    407            // The spec changed in Zigbee 2007 (2.4.3.1.7.1) to not allow sending
    408            // this command to 0xFFFF.  So, here we will filter this and replace 
    409            // with 0xFFFD to only send to devices with RX ON.  This includes the 
    410            // network address of interest.
    411            if ( ((dstAddr->addrMode == AddrBroadcast) || (dstAddr->addrMode == Addr16Bit))
    412                && (dstAddr->addr.shortAddr == NWK_BROADCAST_SHORTADDR_DEVALL) )
   \                     ??ZDP_MatchDescReq_0:
   \   000067   8A82         MOV     DPL,R2
   \   000069   8B83         MOV     DPH,R3
   \   00006B   A3           INC     DPTR
   \   00006C   A3           INC     DPTR
   \   00006D   A3           INC     DPTR
   \   00006E   A3           INC     DPTR
   \   00006F   A3           INC     DPTR
   \   000070   A3           INC     DPTR
   \   000071   A3           INC     DPTR
   \   000072   A3           INC     DPTR
   \   000073   E0           MOVX    A,@DPTR
   \   000074   640F         XRL     A,#0xf
   \   000076   6011         JZ      ??ZDP_MatchDescReq_2
   \   000078   8A82         MOV     DPL,R2
   \   00007A   8B83         MOV     DPH,R3
   \   00007C   A3           INC     DPTR
   \   00007D   A3           INC     DPTR
   \   00007E   A3           INC     DPTR
   \   00007F   A3           INC     DPTR
   \   000080   A3           INC     DPTR
   \   000081   A3           INC     DPTR
   \   000082   A3           INC     DPTR
   \   000083   A3           INC     DPTR
   \   000084   E0           MOVX    A,@DPTR
   \   000085   6402         XRL     A,#0x2
   \   000087   701A         JNZ     ??ZDP_MatchDescReq_3
   \                     ??ZDP_MatchDescReq_2:
   \   000089   8A82         MOV     DPL,R2
   \   00008B   8B83         MOV     DPH,R3
   \   00008D   E0           MOVX    A,@DPTR
   \   00008E   64FF         XRL     A,#0xff
   \   000090   7004         JNZ     ??ZDP_MatchDescReq_4
   \   000092   A3           INC     DPTR
   \   000093   E0           MOVX    A,@DPTR
   \   000094   64FF         XRL     A,#0xff
   \                     ??ZDP_MatchDescReq_4:
   \   000096   700B         JNZ     ??ZDP_MatchDescReq_3
    413            {
    414              dstAddr->addr.shortAddr = NWK_BROADCAST_SHORTADDR_DEVRXON;
   \   000098   8A82         MOV     DPL,R2
   \   00009A   8B83         MOV     DPH,R3
   \   00009C   74FD         MOV     A,#-0x3
   \   00009E   F0           MOVX    @DPTR,A
   \   00009F   A3           INC     DPTR
   \   0000A0   74FF         MOV     A,#-0x1
   \   0000A2   F0           MOVX    @DPTR,A
    415            }
    416            if ( nwkAddr == NWK_BROADCAST_SHORTADDR_DEVALL )
   \                     ??ZDP_MatchDescReq_3:
   \   0000A3   74FF         MOV     A,#-0x1
   \   0000A5   6C           XRL     A,R4
   \   0000A6   7003         JNZ     ??ZDP_MatchDescReq_5
   \   0000A8   74FF         MOV     A,#-0x1
   \   0000AA   6D           XRL     A,R5
   \                     ??ZDP_MatchDescReq_5:
   \   0000AB   7004         JNZ     ??ZDP_MatchDescReq_6
    417            {
    418              nwkAddr = NWK_BROADCAST_SHORTADDR_DEVRXON;
   \   0000AD   7CFD         MOV     R4,#-0x3
   \   0000AF   7DFF         MOV     R5,#-0x1
    419            }
    420            
    421            *pBuf++ = LO_UINT16( nwkAddr );   // NWKAddrOfInterest
   \                     ??ZDP_MatchDescReq_6:
   \   0000B1   EC           MOV     A,R4
   \   0000B2   8882         MOV     DPL,R0
   \   0000B4   8983         MOV     DPH,R1
   \   0000B6   F0           MOVX    @DPTR,A
   \   0000B7   8882         MOV     DPL,R0
   \   0000B9   8983         MOV     DPH,R1
   \   0000BB   A3           INC     DPTR
   \   0000BC   A882         MOV     R0,DPL
   \   0000BE   A983         MOV     R1,DPH
    422            *pBuf++ = HI_UINT16( nwkAddr );
   \   0000C0   E4           CLR     A
   \   0000C1   ED           MOV     A,R5
   \   0000C2   FC           MOV     R4,A
   \   0000C3   8882         MOV     DPL,R0
   \   0000C5   8983         MOV     DPH,R1
   \   0000C7   F0           MOVX    @DPTR,A
   \   0000C8   8882         MOV     DPL,R0
   \   0000CA   8983         MOV     DPH,R1
   \   0000CC   A3           INC     DPTR
   \   0000CD   A882         MOV     R0,DPL
   \   0000CF   A983         MOV     R1,DPH
    423          
    424            *pBuf++ = LO_UINT16( ProfileID );   // Profile ID
   \   0000D1   E5..         MOV     A,?V0 + 0
   \   0000D3   8882         MOV     DPL,R0
   \   0000D5   8983         MOV     DPH,R1
   \   0000D7   E5..         MOV     A,?V0 + 0
   \   0000D9   F0           MOVX    @DPTR,A
   \   0000DA   8882         MOV     DPL,R0
   \   0000DC   8983         MOV     DPH,R1
   \   0000DE   A3           INC     DPTR
   \   0000DF   A882         MOV     R0,DPL
   \   0000E1   A983         MOV     R1,DPH
    425            *pBuf++ = HI_UINT16( ProfileID );
   \   0000E3   E4           CLR     A
   \   0000E4   E5..         MOV     A,?V0 + 1
   \   0000E6   F5..         MOV     ?V0 + 0,A
   \   0000E8   E5..         MOV     A,?V0 + 0
   \   0000EA   8882         MOV     DPL,R0
   \   0000EC   8983         MOV     DPH,R1
   \   0000EE   E5..         MOV     A,?V0 + 0
   \   0000F0   F0           MOVX    @DPTR,A
   \   0000F1   8882         MOV     DPL,R0
   \   0000F3   8983         MOV     DPH,R1
   \   0000F5   A3           INC     DPTR
   \   0000F6   A882         MOV     R0,DPL
   \   0000F8   A983         MOV     R1,DPH
    426          
    427            *pBuf++ = NumInClusters; // Input cluster list
   \   0000FA   EE           MOV     A,R6
   \   0000FB   8882         MOV     DPL,R0
   \   0000FD   8983         MOV     DPH,R1
   \   0000FF   F0           MOVX    @DPTR,A
   \   000100   8882         MOV     DPL,R0
   \   000102   8983         MOV     DPH,R1
   \   000104   A3           INC     DPTR
   \   000105   A882         MOV     R0,DPL
   \   000107   A983         MOV     R1,DPH
    428            if ( NumInClusters )
   \   000109   EE           MOV     A,R6
   \   00010A   7003         JNZ     $+5
   \   00010C   02....       LJMP    ??ZDP_MatchDescReq_7 & 0xFFFF
    429            {
    430              for (i=0; i<NumInClusters; ++i)  {
   \   00010F   75..00       MOV     ?V0 + 0,#0x0
   \   000112   807E         SJMP    ??ZDP_MatchDescReq_8
    431                *pBuf++ = LO_UINT16( InClusterList[i] );
   \                     ??ZDP_MatchDescReq_9:
   \   000114   E5..         MOV     A,?V0 + 0
   \   000116   AC..         MOV     R4,?V0 + 0
   \   000118   7D00         MOV     R5,#0x0
   \   00011A   EC           MOV     A,R4
   \   00011B   75F002       MOV     B,#0x2
   \   00011E   A4           MUL     AB
   \   00011F   CC           XCH     A,R4
   \   000120   85F0..       MOV     ?V0 + 1,B
   \   000123   75F000       MOV     B,#0x0
   \   000126   A4           MUL     AB
   \   000127   25..         ADD     A,?V0 + 1
   \   000129   F5..         MOV     ?V0 + 1,A
   \   00012B   75F002       MOV     B,#0x2
   \   00012E   ED           MOV     A,R5
   \   00012F   A4           MUL     AB
   \   000130   25..         ADD     A,?V0 + 1
   \   000132   FD           MOV     R5,A
   \   000133   E5..         MOV     A,?V0 + 8
   \   000135   2C           ADD     A,R4
   \   000136   F582         MOV     DPL,A
   \   000138   E5..         MOV     A,?V0 + 9
   \   00013A   3D           ADDC    A,R5
   \   00013B   F583         MOV     DPH,A
   \   00013D   E0           MOVX    A,@DPTR
   \   00013E   FC           MOV     R4,A
   \   00013F   A3           INC     DPTR
   \   000140   E0           MOVX    A,@DPTR
   \   000141   FD           MOV     R5,A
   \   000142   EC           MOV     A,R4
   \   000143   8882         MOV     DPL,R0
   \   000145   8983         MOV     DPH,R1
   \   000147   F0           MOVX    @DPTR,A
   \   000148   8882         MOV     DPL,R0
   \   00014A   8983         MOV     DPH,R1
   \   00014C   A3           INC     DPTR
   \   00014D   A882         MOV     R0,DPL
   \   00014F   A983         MOV     R1,DPH
    432                *pBuf++ = HI_UINT16( InClusterList[i] );
   \   000151   E5..         MOV     A,?V0 + 0
   \   000153   AC..         MOV     R4,?V0 + 0
   \   000155   7D00         MOV     R5,#0x0
   \   000157   EC           MOV     A,R4
   \   000158   75F002       MOV     B,#0x2
   \   00015B   A4           MUL     AB
   \   00015C   CC           XCH     A,R4
   \   00015D   85F0..       MOV     ?V0 + 1,B
   \   000160   75F000       MOV     B,#0x0
   \   000163   A4           MUL     AB
   \   000164   25..         ADD     A,?V0 + 1
   \   000166   F5..         MOV     ?V0 + 1,A
   \   000168   75F002       MOV     B,#0x2
   \   00016B   ED           MOV     A,R5
   \   00016C   A4           MUL     AB
   \   00016D   25..         ADD     A,?V0 + 1
   \   00016F   FD           MOV     R5,A
   \   000170   E5..         MOV     A,?V0 + 8
   \   000172   2C           ADD     A,R4
   \   000173   F582         MOV     DPL,A
   \   000175   E5..         MOV     A,?V0 + 9
   \   000177   3D           ADDC    A,R5
   \   000178   F583         MOV     DPH,A
   \   00017A   E0           MOVX    A,@DPTR
   \   00017B   FC           MOV     R4,A
   \   00017C   A3           INC     DPTR
   \   00017D   E0           MOVX    A,@DPTR
   \   00017E   FD           MOV     R5,A
   \   00017F   E4           CLR     A
   \   000180   ED           MOV     A,R5
   \   000181   FC           MOV     R4,A
   \   000182   8882         MOV     DPL,R0
   \   000184   8983         MOV     DPH,R1
   \   000186   F0           MOVX    @DPTR,A
   \   000187   8882         MOV     DPL,R0
   \   000189   8983         MOV     DPH,R1
   \   00018B   A3           INC     DPTR
   \   00018C   A882         MOV     R0,DPL
   \   00018E   A983         MOV     R1,DPH
    433              }
   \   000190   05..         INC     ?V0 + 0
   \                     ??ZDP_MatchDescReq_8:
   \   000192   E5..         MOV     A,?V0 + 0
   \   000194   C3           CLR     C
   \   000195   9E           SUBB    A,R6
   \   000196   5003         JNC     $+5
   \   000198   02....       LJMP    ??ZDP_MatchDescReq_9 & 0xFFFF
    434            }
    435          
    436            *pBuf++ = NumOutClusters; // Output cluster list
   \                     ??ZDP_MatchDescReq_7:
   \   00019B   E5..         MOV     A,?V0 + 10
   \   00019D   8882         MOV     DPL,R0
   \   00019F   8983         MOV     DPH,R1
   \   0001A1   E5..         MOV     A,?V0 + 10
   \   0001A3   F0           MOVX    @DPTR,A
   \   0001A4   8882         MOV     DPL,R0
   \   0001A6   8983         MOV     DPH,R1
   \   0001A8   A3           INC     DPTR
   \   0001A9   A882         MOV     R0,DPL
   \   0001AB   A983         MOV     R1,DPH
    437            if ( NumOutClusters )
   \   0001AD   E5..         MOV     A,?V0 + 10
   \   0001AF   7003         JNZ     $+5
   \   0001B1   02....       LJMP    ??ZDP_MatchDescReq_10 & 0xFFFF
    438            {
    439              for (i=0; i<NumOutClusters; ++i)  {
   \   0001B4   75..00       MOV     ?V0 + 0,#0x0
   \   0001B7   807E         SJMP    ??ZDP_MatchDescReq_11
    440                *pBuf++ = LO_UINT16( OutClusterList[i] );
   \                     ??ZDP_MatchDescReq_12:
   \   0001B9   E5..         MOV     A,?V0 + 0
   \   0001BB   AC..         MOV     R4,?V0 + 0
   \   0001BD   7D00         MOV     R5,#0x0
   \   0001BF   EC           MOV     A,R4
   \   0001C0   75F002       MOV     B,#0x2
   \   0001C3   A4           MUL     AB
   \   0001C4   CC           XCH     A,R4
   \   0001C5   85F0..       MOV     ?V0 + 1,B
   \   0001C8   75F000       MOV     B,#0x0
   \   0001CB   A4           MUL     AB
   \   0001CC   25..         ADD     A,?V0 + 1
   \   0001CE   F5..         MOV     ?V0 + 1,A
   \   0001D0   75F002       MOV     B,#0x2
   \   0001D3   ED           MOV     A,R5
   \   0001D4   A4           MUL     AB
   \   0001D5   25..         ADD     A,?V0 + 1
   \   0001D7   FD           MOV     R5,A
   \   0001D8   E5..         MOV     A,?V0 + 6
   \   0001DA   2C           ADD     A,R4
   \   0001DB   F582         MOV     DPL,A
   \   0001DD   E5..         MOV     A,?V0 + 7
   \   0001DF   3D           ADDC    A,R5
   \   0001E0   F583         MOV     DPH,A
   \   0001E2   E0           MOVX    A,@DPTR
   \   0001E3   FC           MOV     R4,A
   \   0001E4   A3           INC     DPTR
   \   0001E5   E0           MOVX    A,@DPTR
   \   0001E6   FD           MOV     R5,A
   \   0001E7   EC           MOV     A,R4
   \   0001E8   8882         MOV     DPL,R0
   \   0001EA   8983         MOV     DPH,R1
   \   0001EC   F0           MOVX    @DPTR,A
   \   0001ED   8882         MOV     DPL,R0
   \   0001EF   8983         MOV     DPH,R1
   \   0001F1   A3           INC     DPTR
   \   0001F2   A882         MOV     R0,DPL
   \   0001F4   A983         MOV     R1,DPH
    441                *pBuf++ = HI_UINT16( OutClusterList[i] );
   \   0001F6   E5..         MOV     A,?V0 + 0
   \   0001F8   AC..         MOV     R4,?V0 + 0
   \   0001FA   7D00         MOV     R5,#0x0
   \   0001FC   EC           MOV     A,R4
   \   0001FD   75F002       MOV     B,#0x2
   \   000200   A4           MUL     AB
   \   000201   CC           XCH     A,R4
   \   000202   85F0..       MOV     ?V0 + 1,B
   \   000205   75F000       MOV     B,#0x0
   \   000208   A4           MUL     AB
   \   000209   25..         ADD     A,?V0 + 1
   \   00020B   F5..         MOV     ?V0 + 1,A
   \   00020D   75F002       MOV     B,#0x2
   \   000210   ED           MOV     A,R5
   \   000211   A4           MUL     AB
   \   000212   25..         ADD     A,?V0 + 1
   \   000214   FD           MOV     R5,A
   \   000215   E5..         MOV     A,?V0 + 6
   \   000217   2C           ADD     A,R4
   \   000218   F582         MOV     DPL,A
   \   00021A   E5..         MOV     A,?V0 + 7
   \   00021C   3D           ADDC    A,R5
   \   00021D   F583         MOV     DPH,A
   \   00021F   E0           MOVX    A,@DPTR
   \   000220   FC           MOV     R4,A
   \   000221   A3           INC     DPTR
   \   000222   E0           MOVX    A,@DPTR
   \   000223   FD           MOV     R5,A
   \   000224   E4           CLR     A
   \   000225   ED           MOV     A,R5
   \   000226   FC           MOV     R4,A
   \   000227   8882         MOV     DPL,R0
   \   000229   8983         MOV     DPH,R1
   \   00022B   F0           MOVX    @DPTR,A
   \   00022C   8882         MOV     DPL,R0
   \   00022E   8983         MOV     DPH,R1
   \   000230   A3           INC     DPTR
   \   000231   A882         MOV     R0,DPL
   \   000233   A983         MOV     R1,DPH
    442              }
   \   000235   05..         INC     ?V0 + 0
   \                     ??ZDP_MatchDescReq_11:
   \   000237   E5..         MOV     A,?V0 + 0
   \   000239   C3           CLR     C
   \   00023A   95..         SUBB    A,?V0 + 10
   \   00023C   5003         JNC     $+5
   \   00023E   02....       LJMP    ??ZDP_MatchDescReq_12 & 0xFFFF
    443            }
    444          
    445            return fillAndSend( &ZDP_TransID, dstAddr, Match_Desc_req, len );
   \                     ??ZDP_MatchDescReq_10:
   \   000241                ; Setup parameters for call to function fillAndSend
   \   000241   75..06       MOV     ?V0 + 0,#0x6
   \   000244   75..00       MOV     ?V0 + 1,#0x0
   \   000247   78..         MOV     R0,#?V0 + 0
   \   000249   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00024C   EF           MOV     A,R7
   \   00024D   F9           MOV     R1,A
   \   00024E   EA           MOV     A,R2
   \   00024F   FC           MOV     R4,A
   \   000250   EB           MOV     A,R3
   \   000251   FD           MOV     R5,A
   \   000252   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   000254   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   000256   12....       LCALL   ??fillAndSend?relay
   \   000259   7402         MOV     A,#0x2
   \   00025B   12....       LCALL   ?DEALLOC_XSTACK8
   \                     ??ZDP_MatchDescReq_1:
   \   00025E   7F0B         MOV     R7,#0xb
   \   000260   02....       LJMP    ?BANKED_LEAVE_XDATA
    446          }
    447          
    448          /*********************************************************************
    449           * @fn          ZDP_SimpleDescReq
    450           *
    451           * @brief       This builds and send a NWK_Simple_Desc_req
    452           *              message.  This function sends unicast message to the
    453           *              destination device.
    454           *
    455           * @param       dstAddr - destination address
    456           * @param       nwkAddr - 16 bit address
    457           * @param       epIntf - endpoint/interface
    458           * @param       SecurityEnable - Security Options
    459           *
    460           * @return      afStatus_t
    461           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    462          afStatus_t ZDP_SimpleDescReq( zAddrType_t *dstAddr, uint16 nwkAddr,
   \                     ZDP_SimpleDescReq:
    463                                              byte endPoint, byte SecurityEnable )
    464          
    465          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    466            (void)SecurityEnable;  // Intentionally unreferenced parameter
    467          
    468            ZDP_TmpBuf[0] = LO_UINT16( nwkAddr );
   \   000007   EC           MOV     A,R4
   \   000008   C0E0         PUSH    A
   \   00000A   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F8           MOV     R0,A
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   F583         MOV     DPH,A
   \   000013   8882         MOV     DPL,R0
   \   000015   D0E0         POP     A
   \   000017   F0           MOVX    @DPTR,A
    469            ZDP_TmpBuf[1] = HI_UINT16( nwkAddr );
   \   000018   E4           CLR     A
   \   000019   ED           MOV     A,R5
   \   00001A   FC           MOV     R4,A
   \   00001B   C0E0         PUSH    A
   \   00001D   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000020   E0           MOVX    A,@DPTR
   \   000021   F8           MOV     R0,A
   \   000022   A3           INC     DPTR
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F583         MOV     DPH,A
   \   000026   8882         MOV     DPL,R0
   \   000028   A3           INC     DPTR
   \   000029   D0E0         POP     A
   \   00002B   F0           MOVX    @DPTR,A
    470            ZDP_TmpBuf[2] = endPoint;
   \   00002C   EE           MOV     A,R6
   \   00002D   C0E0         PUSH    A
   \   00002F   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000032   E0           MOVX    A,@DPTR
   \   000033   F8           MOV     R0,A
   \   000034   A3           INC     DPTR
   \   000035   E0           MOVX    A,@DPTR
   \   000036   F583         MOV     DPH,A
   \   000038   8882         MOV     DPL,R0
   \   00003A   A3           INC     DPTR
   \   00003B   A3           INC     DPTR
   \   00003C   D0E0         POP     A
   \   00003E   F0           MOVX    @DPTR,A
    471          
    472            return fillAndSend( &ZDP_TransID, dstAddr, Simple_Desc_req, 3 );
   \   00003F                ; Setup parameters for call to function fillAndSend
   \   00003F   75..04       MOV     ?V0 + 0,#0x4
   \   000042   75..00       MOV     ?V0 + 1,#0x0
   \   000045   78..         MOV     R0,#?V0 + 0
   \   000047   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00004A   7903         MOV     R1,#0x3
   \   00004C   EA           MOV     A,R2
   \   00004D   FC           MOV     R4,A
   \   00004E   EB           MOV     A,R3
   \   00004F   FD           MOV     R5,A
   \   000050   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   000052   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   000054   12....       LCALL   ??fillAndSend?relay
   \   000057   7402         MOV     A,#0x2
   \   000059   12....       LCALL   ?DEALLOC_XSTACK8
   \   00005C   7F02         MOV     R7,#0x2
   \   00005E   02....       LJMP    ?BANKED_LEAVE_XDATA
    473          }
    474          
    475          /*********************************************************************
    476           * @fn          ZDP_UserDescSet
    477           *
    478           * @brief       This builds and send a User_Desc_set message to set
    479           *              the user descriptor.  This function sends unicast
    480           *              message to the destination device.
    481           *
    482           * @param       dstAddr - destination address
    483           * @param       nwkAddr - 16 bit address
    484           * @param       UserDescriptor - user descriptor
    485           * @param       SecurityEnable - Security Options
    486           *
    487           * @return      afStatus_t
    488           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    489          afStatus_t ZDP_UserDescSet( zAddrType_t *dstAddr, uint16 nwkAddr,
   \                     ZDP_UserDescSet:
    490                                    UserDescriptorFormat_t *UserDescriptor,
    491                                    byte SecurityEnable )
    492          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   \   000009   740F         MOV     A,#0xf
   \   00000B   12....       LCALL   ?XSTACK_DISP0_8
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   F8           MOV     R0,A
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F9           MOV     R1,A
    493            uint8 *pBuf = ZDP_TmpBuf;
   \   000013   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000016   E0           MOVX    A,@DPTR
   \   000017   F5..         MOV     ?V0 + 2,A
   \   000019   A3           INC     DPTR
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   F5..         MOV     ?V0 + 3,A
    494            byte len = (UserDescriptor->len < AF_MAX_USER_DESCRIPTOR_LEN) ?
    495                        UserDescriptor->len : AF_MAX_USER_DESCRIPTOR_LEN;
   \   00001D   8882         MOV     DPL,R0
   \   00001F   8983         MOV     DPH,R1
   \   000021   E0           MOVX    A,@DPTR
   \   000022   C3           CLR     C
   \   000023   9410         SUBB    A,#0x10
   \   000025   5007         JNC     ??ZDP_UserDescSet_0
   \   000027   8882         MOV     DPL,R0
   \   000029   8983         MOV     DPH,R1
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   8002         SJMP    ??ZDP_UserDescSet_1
   \                     ??ZDP_UserDescSet_0:
   \   00002E   7410         MOV     A,#0x10
   \                     ??ZDP_UserDescSet_1:
   \   000030   F5..         MOV     ?V0 + 0,A
    496            byte addrLen = 2;
   \   000032   75..02       MOV     ?V0 + 1,#0x2
    497          
    498            (void)SecurityEnable;  // Intentionally unreferenced parameter
    499          
    500            *pBuf++ = LO_UINT16( nwkAddr );
   \   000035   EC           MOV     A,R4
   \   000036   85..82       MOV     DPL,?V0 + 2
   \   000039   85..83       MOV     DPH,?V0 + 3
   \   00003C   F0           MOVX    @DPTR,A
   \   00003D   85..82       MOV     DPL,?V0 + 2
   \   000040   85..83       MOV     DPH,?V0 + 3
   \   000043   A3           INC     DPTR
   \   000044   8582..       MOV     ?V0 + 2,DPL
   \   000047   8583..       MOV     ?V0 + 3,DPH
    501            *pBuf++ = HI_UINT16( nwkAddr );
   \   00004A   E4           CLR     A
   \   00004B   ED           MOV     A,R5
   \   00004C   FC           MOV     R4,A
   \   00004D   85..82       MOV     DPL,?V0 + 2
   \   000050   85..83       MOV     DPH,?V0 + 3
   \   000053   F0           MOVX    @DPTR,A
   \   000054   85..82       MOV     DPL,?V0 + 2
   \   000057   85..83       MOV     DPH,?V0 + 3
   \   00005A   A3           INC     DPTR
   \   00005B   8582..       MOV     ?V0 + 2,DPL
   \   00005E   8583..       MOV     ?V0 + 3,DPH
    502          
    503            *pBuf++ = len;
   \   000061   E5..         MOV     A,?V0 + 0
   \   000063   85..82       MOV     DPL,?V0 + 2
   \   000066   85..83       MOV     DPH,?V0 + 3
   \   000069   E5..         MOV     A,?V0 + 0
   \   00006B   F0           MOVX    @DPTR,A
   \   00006C   85..82       MOV     DPL,?V0 + 2
   \   00006F   85..83       MOV     DPH,?V0 + 3
   \   000072   A3           INC     DPTR
   \   000073   8582..       MOV     ?V0 + 2,DPL
   \   000076   8583..       MOV     ?V0 + 3,DPH
    504            addrLen = 3;
   \   000079   75..03       MOV     ?V0 + 1,#0x3
    505          
    506            pBuf = osal_memcpy( pBuf, UserDescriptor->desc, len );
   \   00007C                ; Setup parameters for call to function osal_memcpy
   \   00007C   8882         MOV     DPL,R0
   \   00007E   8983         MOV     DPH,R1
   \   000080   A3           INC     DPTR
   \   000081   A982         MOV     R1,DPL
   \   000083   AA83         MOV     R2,DPH
   \   000085   7B00         MOV     R3,#0x0
   \   000087   89..         MOV     ?V0 + 4,R1
   \   000089   8A..         MOV     ?V0 + 5,R2
   \   00008B   8B..         MOV     ?V0 + 6,R3
   \   00008D   78..         MOV     R0,#?V0 + 4
   \   00008F   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000092   85....       MOV     ?V0 + 4,?V0 + 0
   \   000095   75..00       MOV     ?V0 + 5,#0x0
   \   000098   AC..         MOV     R4,?V0 + 4
   \   00009A   AD..         MOV     R5,?V0 + 5
   \   00009C   AA..         MOV     R2,?V0 + 2
   \   00009E   AB..         MOV     R3,?V0 + 3
   \   0000A0   12....       LCALL   ??osal_memcpy?relay
   \   0000A3   7403         MOV     A,#0x3
   \   0000A5   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000A8   8A..         MOV     ?V0 + 4,R2
   \   0000AA   8B..         MOV     ?V0 + 5,R3
   \   0000AC   85....       MOV     ?V0 + 2,?V0 + 4
   \   0000AF   85....       MOV     ?V0 + 3,?V0 + 5
    507            osal_memset( pBuf, AF_USER_DESCRIPTOR_FILL, AF_MAX_USER_DESCRIPTOR_LEN-len );
   \   0000B2                ; Setup parameters for call to function osal_memset
   \   0000B2   85....       MOV     ?V0 + 4,?V0 + 0
   \   0000B5   75..00       MOV     ?V0 + 5,#0x0
   \   0000B8   7410         MOV     A,#0x10
   \   0000BA   C3           CLR     C
   \   0000BB   95..         SUBB    A,?V0 + 4
   \   0000BD   FC           MOV     R4,A
   \   0000BE   7400         MOV     A,#0x0
   \   0000C0   95..         SUBB    A,?V0 + 5
   \   0000C2   FD           MOV     R5,A
   \   0000C3   7920         MOV     R1,#0x20
   \   0000C5   AA..         MOV     R2,?V0 + 2
   \   0000C7   AB..         MOV     R3,?V0 + 3
   \   0000C9   12....       LCALL   ??osal_memset?relay
    508          
    509            return fillAndSend( &ZDP_TransID, dstAddr, User_Desc_set, (AF_MAX_USER_DESCRIPTOR_LEN + addrLen) );
   \   0000CC                ; Setup parameters for call to function fillAndSend
   \   0000CC   75..14       MOV     ?V0 + 2,#0x14
   \   0000CF   75..00       MOV     ?V0 + 3,#0x0
   \   0000D2   78..         MOV     R0,#?V0 + 2
   \   0000D4   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000D7   7410         MOV     A,#0x10
   \   0000D9   25..         ADD     A,?V0 + 1
   \   0000DB   F9           MOV     R1,A
   \   0000DC   EE           MOV     A,R6
   \   0000DD   FC           MOV     R4,A
   \   0000DE   EF           MOV     A,R7
   \   0000DF   FD           MOV     R5,A
   \   0000E0   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   0000E2   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   0000E4   12....       LCALL   ??fillAndSend?relay
   \   0000E7   7402         MOV     A,#0x2
   \   0000E9   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000EC   7F07         MOV     R7,#0x7
   \   0000EE   02....       LJMP    ?BANKED_LEAVE_XDATA
    510          }
    511          
    512          /*********************************************************************
    513           * @fn          ZDP_ServerDiscReq
    514           *
    515           * @brief       Build and send a Server_Discovery_req request message.
    516           *
    517           * @param       serverMask - 16-bit bit-mask of server services being sought.
    518           * @param       SecurityEnable - Security Options
    519           *
    520           * @return      afStatus_t
    521           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    522          afStatus_t ZDP_ServerDiscReq( uint16 serverMask, byte SecurityEnable )
   \                     ZDP_ServerDiscReq:
    523          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
    524            uint8 *pBuf = ZDP_TmpBuf;
   \   00000C   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   F8           MOV     R0,A
   \   000011   A3           INC     DPTR
   \   000012   E0           MOVX    A,@DPTR
   \   000013   F9           MOV     R1,A
    525            zAddrType_t dstAddr;
    526          
    527            dstAddr.addrMode = AddrBroadcast;
   \   000014   7408         MOV     A,#0x8
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   740F         MOV     A,#0xf
   \   00001B   F0           MOVX    @DPTR,A
    528            dstAddr.addr.shortAddr = NWK_BROADCAST_SHORTADDR_DEVRXON;
   \   00001C   85..82       MOV     DPL,?XSP + 0
   \   00001F   85..83       MOV     DPH,?XSP + 1
   \   000022   74FD         MOV     A,#-0x3
   \   000024   F0           MOVX    @DPTR,A
   \   000025   A3           INC     DPTR
   \   000026   74FF         MOV     A,#-0x1
   \   000028   F0           MOVX    @DPTR,A
    529          
    530            *pBuf++ = LO_UINT16( serverMask );
   \   000029   EA           MOV     A,R2
   \   00002A   8882         MOV     DPL,R0
   \   00002C   8983         MOV     DPH,R1
   \   00002E   F0           MOVX    @DPTR,A
   \   00002F   8882         MOV     DPL,R0
   \   000031   8983         MOV     DPH,R1
   \   000033   A3           INC     DPTR
   \   000034   A882         MOV     R0,DPL
   \   000036   A983         MOV     R1,DPH
    531            *pBuf = HI_UINT16( serverMask );
   \   000038   E4           CLR     A
   \   000039   EB           MOV     A,R3
   \   00003A   FA           MOV     R2,A
   \   00003B   8882         MOV     DPL,R0
   \   00003D   8983         MOV     DPH,R1
   \   00003F   F0           MOVX    @DPTR,A
    532          
    533            FillAndSendTxOptions( &ZDP_TransID, &dstAddr, Server_Discovery_req, 2,
    534                       ((SecurityEnable) ? AF_EN_SECURITY : AF_TX_OPTIONS_NONE) );
   \   000040   EE           MOV     A,R6
   \   000041   6004         JZ      ??ZDP_ServerDiscReq_0
   \   000043   7440         MOV     A,#0x40
   \   000045   8002         SJMP    ??ZDP_ServerDiscReq_1
   \                     ??ZDP_ServerDiscReq_0:
   \   000047   7400         MOV     A,#0x0
   \                     ??ZDP_ServerDiscReq_1:
   \   000049   90....       MOV     DPTR,#ZDP_TxOptions
   \   00004C   F0           MOVX    @DPTR,A
   \   00004D                ; Setup parameters for call to function fillAndSend
   \   00004D   75..15       MOV     ?V0 + 0,#0x15
   \   000050   75..00       MOV     ?V0 + 1,#0x0
   \   000053   78..         MOV     R0,#?V0 + 0
   \   000055   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000058   7902         MOV     R1,#0x2
   \   00005A   7402         MOV     A,#0x2
   \   00005C   12....       LCALL   ?XSTACK_DISP0_8
   \   00005F   AC82         MOV     R4,DPL
   \   000061   AD83         MOV     R5,DPH
   \   000063   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   000065   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   000067   12....       LCALL   ??fillAndSend?relay
   \   00006A   7402         MOV     A,#0x2
   \   00006C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00006F   E9           MOV     A,R1
   \   000070   F9           MOV     R1,A
   \   000071   90....       MOV     DPTR,#ZDP_TxOptions
   \   000074   7400         MOV     A,#0x0
   \   000076   F0           MOVX    @DPTR,A
   \   000077   7409         MOV     A,#0x9
   \   000079   12....       LCALL   ?DEALLOC_XSTACK8
   \   00007C   7F02         MOV     R7,#0x2
   \   00007E   02....       LJMP    ?BANKED_LEAVE_XDATA
    535          }
    536          
    537          /*********************************************************************
    538           * @fn          ZDP_DeviceAnnce
    539           *
    540           * @brief       This builds and send a Device_Annce message.  This
    541           *              function sends a broadcast message.
    542           *
    543           * @param       nwkAddr - 16 bit address of the device
    544           * @param       IEEEAddr - 64 bit address of the device
    545           * @param       capabilities - device capabilities.  This field is only
    546           *                 sent for v1.1 networks.
    547           * @param       SecurityEnable - Security Options
    548           *
    549           * @return      afStatus_t
    550           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    551          afStatus_t ZDP_DeviceAnnce( uint16 nwkAddr, uint8 *IEEEAddr,
   \                     ZDP_DeviceAnnce:
    552                                        byte capabilities, byte SecurityEnable )
    553          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
    554            zAddrType_t dstAddr;
    555            uint8 len;
    556          
    557            (void)SecurityEnable;  // Intentionally unreferenced parameter
    558          
    559            dstAddr.addrMode = (afAddrMode_t)AddrBroadcast;
   \   00000C   7408         MOV     A,#0x8
   \   00000E   12....       LCALL   ?XSTACK_DISP0_8
   \   000011   740F         MOV     A,#0xf
   \   000013   F0           MOVX    @DPTR,A
    560            dstAddr.addr.shortAddr = NWK_BROADCAST_SHORTADDR_DEVRXON;
   \   000014   85..82       MOV     DPL,?XSP + 0
   \   000017   85..83       MOV     DPH,?XSP + 1
   \   00001A   74FD         MOV     A,#-0x3
   \   00001C   F0           MOVX    @DPTR,A
   \   00001D   A3           INC     DPTR
   \   00001E   74FF         MOV     A,#-0x1
   \   000020   F0           MOVX    @DPTR,A
    561          
    562            ZDP_TmpBuf[0] = LO_UINT16( nwkAddr );
   \   000021   EA           MOV     A,R2
   \   000022   C0E0         PUSH    A
   \   000024   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F8           MOV     R0,A
   \   000029   A3           INC     DPTR
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   F583         MOV     DPH,A
   \   00002D   8882         MOV     DPL,R0
   \   00002F   D0E0         POP     A
   \   000031   F0           MOVX    @DPTR,A
    563            ZDP_TmpBuf[1] = HI_UINT16( nwkAddr );
   \   000032   E4           CLR     A
   \   000033   EB           MOV     A,R3
   \   000034   FA           MOV     R2,A
   \   000035   C0E0         PUSH    A
   \   000037   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   F8           MOV     R0,A
   \   00003C   A3           INC     DPTR
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   F583         MOV     DPH,A
   \   000040   8882         MOV     DPL,R0
   \   000042   A3           INC     DPTR
   \   000043   D0E0         POP     A
   \   000045   F0           MOVX    @DPTR,A
    564            osal_cpyExtAddr( &ZDP_TmpBuf[2], IEEEAddr );
   \   000046                ; Setup parameters for call to function sAddrExtCpy
   \   000046   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000049   E0           MOVX    A,@DPTR
   \   00004A   2402         ADD     A,#0x2
   \   00004C   FA           MOV     R2,A
   \   00004D   A3           INC     DPTR
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   3400         ADDC    A,#0x0
   \   000051   FB           MOV     R3,A
   \   000052   12....       LCALL   ??sAddrExtCpy?relay
    565            len = 2 + Z_EXTADDR_LEN;
   \   000055   790A         MOV     R1,#0xa
    566          
    567            ZDP_TmpBuf[10] = capabilities;
   \   000057   EE           MOV     A,R6
   \   000058   C0E0         PUSH    A
   \   00005A   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   F8           MOV     R0,A
   \   00005F   A3           INC     DPTR
   \   000060   E0           MOVX    A,@DPTR
   \   000061   F583         MOV     DPH,A
   \   000063   8882         MOV     DPL,R0
   \   000065   A3           INC     DPTR
   \   000066   A3           INC     DPTR
   \   000067   A3           INC     DPTR
   \   000068   A3           INC     DPTR
   \   000069   A3           INC     DPTR
   \   00006A   A3           INC     DPTR
   \   00006B   A3           INC     DPTR
   \   00006C   A3           INC     DPTR
   \   00006D   A3           INC     DPTR
   \   00006E   A3           INC     DPTR
   \   00006F   D0E0         POP     A
   \   000071   F0           MOVX    @DPTR,A
    568            len++;
   \   000072   790B         MOV     R1,#0xb
    569          
    570            return fillAndSend( &ZDP_TransID, &dstAddr, Device_annce, len );
   \   000074                ; Setup parameters for call to function fillAndSend
   \   000074   75..13       MOV     ?V0 + 0,#0x13
   \   000077   75..00       MOV     ?V0 + 1,#0x0
   \   00007A   78..         MOV     R0,#?V0 + 0
   \   00007C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00007F   7402         MOV     A,#0x2
   \   000081   12....       LCALL   ?XSTACK_DISP0_8
   \   000084   AC82         MOV     R4,DPL
   \   000086   AD83         MOV     R5,DPH
   \   000088   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   00008A   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   00008C   12....       LCALL   ??fillAndSend?relay
   \   00008F   7402         MOV     A,#0x2
   \   000091   12....       LCALL   ?DEALLOC_XSTACK8
   \   000094   7409         MOV     A,#0x9
   \   000096   12....       LCALL   ?DEALLOC_XSTACK8
   \   000099   7F02         MOV     R7,#0x2
   \   00009B   02....       LJMP    ?BANKED_LEAVE_XDATA
    571          }
    572          
    573          /*********************************************************************
    574           * Address Responses
    575           */
    576          
    577          /*********************************************************************
    578           * @fn      zdpProcessAddrReq
    579           *
    580           * @brief   Process an incoming NWK_addr_req or IEEE_addr_req message and then
    581           *          build and send a corresponding NWK_addr_rsp or IEEE_addr_rsp msg.
    582           *
    583           * @param   inMsg - incoming message
    584           *
    585           * @return  none
    586           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    587          void zdpProcessAddrReq( zdoIncomingMsg_t *inMsg )
   \                     zdpProcessAddrReq:
    588          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 4,R2
   \   000007   8B..         MOV     ?V0 + 5,R3
    589            associated_devices_t *pAssoc;
    590            uint8 reqType;
    591            uint16 aoi = INVALID_NODE_ADDR;
   \   000009   75..FE       MOV     ?V0 + 0,#-0x2
   \   00000C   75..FF       MOV     ?V0 + 1,#-0x1
    592            uint8 *ieee = NULL;
   \   00000F   75..00       MOV     ?V0 + 2,#0x0
   \   000012   75..00       MOV     ?V0 + 3,#0x0
    593          
    594            reqType = inMsg->asdu[(inMsg->clusterID == NWK_addr_req) ? Z_EXTADDR_LEN : sizeof( uint16 ) ];
   \   000015   E5..         MOV     A,?V0 + 4
   \   000017   240C         ADD     A,#0xc
   \   000019   F582         MOV     DPL,A
   \   00001B   E5..         MOV     A,?V0 + 5
   \   00001D   3400         ADDC    A,#0x0
   \   00001F   F583         MOV     DPH,A
   \   000021   E0           MOVX    A,@DPTR
   \   000022   F8           MOV     R0,A
   \   000023   A3           INC     DPTR
   \   000024   E0           MOVX    A,@DPTR
   \   000025   F9           MOV     R1,A
   \   000026   E8           MOV     A,R0
   \   000027   49           ORL     A,R1
   \   000028   7006         JNZ     ??zdpProcessAddrReq_0
   \   00002A   7808         MOV     R0,#0x8
   \   00002C   7900         MOV     R1,#0x0
   \   00002E   8004         SJMP    ??zdpProcessAddrReq_1
   \                     ??zdpProcessAddrReq_0:
   \   000030   7802         MOV     R0,#0x2
   \   000032   7900         MOV     R1,#0x0
   \                     ??zdpProcessAddrReq_1:
   \   000034   E5..         MOV     A,?V0 + 4
   \   000036   2413         ADD     A,#0x13
   \   000038   F582         MOV     DPL,A
   \   00003A   E5..         MOV     A,?V0 + 5
   \   00003C   3400         ADDC    A,#0x0
   \   00003E   F583         MOV     DPH,A
   \   000040   E0           MOVX    A,@DPTR
   \   000041   28           ADD     A,R0
   \   000042   FA           MOV     R2,A
   \   000043   A3           INC     DPTR
   \   000044   E0           MOVX    A,@DPTR
   \   000045   39           ADDC    A,R1
   \   000046   8A82         MOV     DPL,R2
   \   000048   F583         MOV     DPH,A
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   F5..         MOV     ?V0 + 6,A
    595          
    596            if ( inMsg->clusterID == NWK_addr_req )
   \   00004D   E5..         MOV     A,?V0 + 4
   \   00004F   240C         ADD     A,#0xc
   \   000051   F582         MOV     DPL,A
   \   000053   E5..         MOV     A,?V0 + 5
   \   000055   3400         ADDC    A,#0x0
   \   000057   F583         MOV     DPH,A
   \   000059   E0           MOVX    A,@DPTR
   \   00005A   F8           MOV     R0,A
   \   00005B   A3           INC     DPTR
   \   00005C   E0           MOVX    A,@DPTR
   \   00005D   F9           MOV     R1,A
   \   00005E   E8           MOV     A,R0
   \   00005F   49           ORL     A,R1
   \   000060   702D         JNZ     ??zdpProcessAddrReq_2
    597          
    598            {
    599              ieee = inMsg->asdu;
   \   000062   E5..         MOV     A,?V0 + 4
   \   000064   2413         ADD     A,#0x13
   \   000066   F582         MOV     DPL,A
   \   000068   E5..         MOV     A,?V0 + 5
   \   00006A   3400         ADDC    A,#0x0
   \   00006C   F583         MOV     DPH,A
   \   00006E   E0           MOVX    A,@DPTR
   \   00006F   F5..         MOV     ?V0 + 2,A
   \   000071   A3           INC     DPTR
   \   000072   E0           MOVX    A,@DPTR
   \   000073   F5..         MOV     ?V0 + 3,A
    600          
    601              if ( osal_ExtAddrEqual( saveExtAddr, ieee ) )
   \   000075                ; Setup parameters for call to function sAddrExtCmp
   \   000075   AC..         MOV     R4,?V0 + 2
   \   000077   AD..         MOV     R5,?V0 + 3
   \   000079   7A..         MOV     R2,#saveExtAddr & 0xff
   \   00007B   7B..         MOV     R3,#(saveExtAddr >> 8) & 0xff
   \   00007D   12....       LCALL   ??sAddrExtCmp?relay
   \   000080   E9           MOV     A,R1
   \   000081   605C         JZ      ??zdpProcessAddrReq_3
    602              {
    603                aoi = ZDAppNwkAddr.addr.shortAddr;
   \   000083   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000086   E0           MOVX    A,@DPTR
   \   000087   F5..         MOV     ?V0 + 0,A
   \   000089   A3           INC     DPTR
   \   00008A   E0           MOVX    A,@DPTR
   \   00008B   F5..         MOV     ?V0 + 1,A
   \   00008D   8050         SJMP    ??zdpProcessAddrReq_3
    604              }
    605              // Handle response for sleeping end devices
    606              else if ( (ZSTACK_ROUTER_BUILD)
    607                && (((pAssoc = AssocGetWithExt( ieee )) != NULL)
    608                       && (pAssoc->nodeRelation == CHILD_RFD)) )
    609              {
    610                aoi = pAssoc->shortAddr;
    611                if ( reqType != ZDP_ADDR_REQTYPE_SINGLE )
    612                  reqType = 0xFF; // Force Invalid
    613              }
    614            }
    615            else  // if ( inMsg->clusterID == IEEE_addr_req )
    616            {
    617              aoi = BUILD_UINT16( inMsg->asdu[0], inMsg->asdu[1] );
   \                     ??zdpProcessAddrReq_2:
   \   00008F   E5..         MOV     A,?V0 + 4
   \   000091   2413         ADD     A,#0x13
   \   000093   F582         MOV     DPL,A
   \   000095   E5..         MOV     A,?V0 + 5
   \   000097   3400         ADDC    A,#0x0
   \   000099   F583         MOV     DPH,A
   \   00009B   E0           MOVX    A,@DPTR
   \   00009C   F8           MOV     R0,A
   \   00009D   A3           INC     DPTR
   \   00009E   E0           MOVX    A,@DPTR
   \   00009F   F583         MOV     DPH,A
   \   0000A1   8882         MOV     DPL,R0
   \   0000A3   E0           MOVX    A,@DPTR
   \   0000A4   FA           MOV     R2,A
   \   0000A5   7B00         MOV     R3,#0x0
   \   0000A7   E5..         MOV     A,?V0 + 4
   \   0000A9   2413         ADD     A,#0x13
   \   0000AB   F582         MOV     DPL,A
   \   0000AD   E5..         MOV     A,?V0 + 5
   \   0000AF   3400         ADDC    A,#0x0
   \   0000B1   F583         MOV     DPH,A
   \   0000B3   E0           MOVX    A,@DPTR
   \   0000B4   F8           MOV     R0,A
   \   0000B5   A3           INC     DPTR
   \   0000B6   E0           MOVX    A,@DPTR
   \   0000B7   F583         MOV     DPH,A
   \   0000B9   8882         MOV     DPL,R0
   \   0000BB   A3           INC     DPTR
   \   0000BC   E0           MOVX    A,@DPTR
   \   0000BD   F8           MOV     R0,A
   \   0000BE   7900         MOV     R1,#0x0
   \   0000C0   E4           CLR     A
   \   0000C1   C8           XCH     A,R0
   \   0000C2   F9           MOV     R1,A
   \   0000C3   EA           MOV     A,R2
   \   0000C4   28           ADD     A,R0
   \   0000C5   F5..         MOV     ?V0 + 0,A
   \   0000C7   EB           MOV     A,R3
   \   0000C8   39           ADDC    A,R1
   \   0000C9   F5..         MOV     ?V0 + 1,A
    618          
    619              if ( aoi == ZDAppNwkAddr.addr.shortAddr )
   \   0000CB   90....       MOV     DPTR,#ZDAppNwkAddr
   \   0000CE   E0           MOVX    A,@DPTR
   \   0000CF   65..         XRL     A,?V0 + 0
   \   0000D1   7004         JNZ     ??zdpProcessAddrReq_4
   \   0000D3   A3           INC     DPTR
   \   0000D4   E0           MOVX    A,@DPTR
   \   0000D5   65..         XRL     A,?V0 + 1
   \                     ??zdpProcessAddrReq_4:
   \   0000D7   7006         JNZ     ??zdpProcessAddrReq_3
    620              {
    621                ieee = saveExtAddr;
   \   0000D9   75....       MOV     ?V0 + 2,#saveExtAddr & 0xff
   \   0000DC   75....       MOV     ?V0 + 3,#(saveExtAddr >> 8) & 0xff
    622              }
    623              else if ( (ZSTACK_ROUTER_BUILD)
    624                && (((pAssoc = AssocGetWithShort( aoi )) != NULL)
    625                       && (pAssoc->nodeRelation == CHILD_RFD)) )
    626              {
    627                AddrMgrEntry_t addrEntry;
    628                addrEntry.user = ADDRMGR_USER_DEFAULT;
    629                addrEntry.index = pAssoc->addrIdx;
    630                if ( AddrMgrEntryGet( &addrEntry ) )
    631                {
    632                  ieee = addrEntry.extAddr;
    633                }
    634          
    635                if ( reqType != ZDP_ADDR_REQTYPE_SINGLE )
    636                  reqType = 0xFF; // Force Invalid
    637              }
    638            }
    639          
    640            if ( ((aoi != INVALID_NODE_ADDR) && (ieee != NULL)) || (inMsg->wasBroadcast == FALSE) )
   \                     ??zdpProcessAddrReq_3:
   \   0000DF   74FE         MOV     A,#-0x2
   \   0000E1   65..         XRL     A,?V0 + 0
   \   0000E3   7004         JNZ     ??zdpProcessAddrReq_5
   \   0000E5   74FF         MOV     A,#-0x1
   \   0000E7   65..         XRL     A,?V0 + 1
   \                     ??zdpProcessAddrReq_5:
   \   0000E9   6006         JZ      ??zdpProcessAddrReq_6
   \   0000EB   E5..         MOV     A,?V0 + 2
   \   0000ED   45..         ORL     A,?V0 + 3
   \   0000EF   7012         JNZ     ??zdpProcessAddrReq_7
   \                     ??zdpProcessAddrReq_6:
   \   0000F1   E5..         MOV     A,?V0 + 4
   \   0000F3   240B         ADD     A,#0xb
   \   0000F5   F582         MOV     DPL,A
   \   0000F7   E5..         MOV     A,?V0 + 5
   \   0000F9   3400         ADDC    A,#0x0
   \   0000FB   F583         MOV     DPH,A
   \   0000FD   E0           MOVX    A,@DPTR
   \   0000FE   6003         JZ      $+5
   \   000100   02....       LJMP    ??zdpProcessAddrReq_8 & 0xFFFF
    641            {
    642              uint8 stat;
    643              uint8 *pBuf = ZDP_TmpBuf;
   \                     ??zdpProcessAddrReq_7:
   \   000103   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000106   E0           MOVX    A,@DPTR
   \   000107   FE           MOV     R6,A
   \   000108   A3           INC     DPTR
   \   000109   E0           MOVX    A,@DPTR
   \   00010A   FF           MOV     R7,A
    644              // Status + IEEE-Addr + Nwk-Addr.
    645              uint8 len = 1 + Z_EXTADDR_LEN + 2;
   \   00010B   75..0B       MOV     ?V0 + 7,#0xb
    646              
    647              // If aoi and iee are both setup, we found results
    648              if ( (aoi != INVALID_NODE_ADDR) && (ieee != NULL) )
   \   00010E   74FE         MOV     A,#-0x2
   \   000110   65..         XRL     A,?V0 + 0
   \   000112   7004         JNZ     ??zdpProcessAddrReq_9
   \   000114   74FF         MOV     A,#-0x1
   \   000116   65..         XRL     A,?V0 + 1
   \                     ??zdpProcessAddrReq_9:
   \   000118   601A         JZ      ??zdpProcessAddrReq_10
   \   00011A   E5..         MOV     A,?V0 + 2
   \   00011C   45..         ORL     A,?V0 + 3
   \   00011E   6014         JZ      ??zdpProcessAddrReq_10
    649              {
    650                stat = ((reqType == ZDP_ADDR_REQTYPE_SINGLE) || (reqType == ZDP_ADDR_REQTYPE_EXTENDED)) 
    651                              ? ZDP_SUCCESS : ZDP_INVALID_REQTYPE;
   \   000120   E5..         MOV     A,?V0 + 6
   \   000122   6006         JZ      ??zdpProcessAddrReq_11
   \   000124   7401         MOV     A,#0x1
   \   000126   65..         XRL     A,?V0 + 6
   \   000128   7004         JNZ     ??zdpProcessAddrReq_12
   \                     ??zdpProcessAddrReq_11:
   \   00012A   7400         MOV     A,#0x0
   \   00012C   8002         SJMP    ??zdpProcessAddrReq_13
   \                     ??zdpProcessAddrReq_12:
   \   00012E   7480         MOV     A,#-0x80
   \                     ??zdpProcessAddrReq_13:
   \   000130   F5..         MOV     ?V0 + 6,A
   \   000132   802A         SJMP    ??zdpProcessAddrReq_14
    652              }
    653              else 
    654              {
    655                // not found and the req was unicast to this device
    656                stat = ZDP_DEVICE_NOT_FOUND;
   \                     ??zdpProcessAddrReq_10:
   \   000134   75..81       MOV     ?V0 + 6,#-0x7f
    657                
    658                // Fill in the missing field with this device's address
    659                if ( inMsg->clusterID == NWK_addr_req )
   \   000137   E5..         MOV     A,?V0 + 4
   \   000139   240C         ADD     A,#0xc
   \   00013B   F582         MOV     DPL,A
   \   00013D   E5..         MOV     A,?V0 + 5
   \   00013F   3400         ADDC    A,#0x0
   \   000141   F583         MOV     DPH,A
   \   000143   E0           MOVX    A,@DPTR
   \   000144   F8           MOV     R0,A
   \   000145   A3           INC     DPTR
   \   000146   E0           MOVX    A,@DPTR
   \   000147   F9           MOV     R1,A
   \   000148   E8           MOV     A,R0
   \   000149   49           ORL     A,R1
   \   00014A   700C         JNZ     ??zdpProcessAddrReq_15
    660                {
    661                  aoi = ZDAppNwkAddr.addr.shortAddr;
   \   00014C   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00014F   E0           MOVX    A,@DPTR
   \   000150   F5..         MOV     ?V0 + 0,A
   \   000152   A3           INC     DPTR
   \   000153   E0           MOVX    A,@DPTR
   \   000154   F5..         MOV     ?V0 + 1,A
   \   000156   8006         SJMP    ??zdpProcessAddrReq_14
    662                }
    663                else
    664                {
    665                  ieee = saveExtAddr;
   \                     ??zdpProcessAddrReq_15:
   \   000158   75....       MOV     ?V0 + 2,#saveExtAddr & 0xff
   \   00015B   75....       MOV     ?V0 + 3,#(saveExtAddr >> 8) & 0xff
    666                }
    667              }
    668          
    669              *pBuf++ = stat;
   \                     ??zdpProcessAddrReq_14:
   \   00015E   E5..         MOV     A,?V0 + 6
   \   000160   8E82         MOV     DPL,R6
   \   000162   8F83         MOV     DPH,R7
   \   000164   E5..         MOV     A,?V0 + 6
   \   000166   F0           MOVX    @DPTR,A
   \   000167   8E82         MOV     DPL,R6
   \   000169   8F83         MOV     DPH,R7
   \   00016B   A3           INC     DPTR
   \   00016C   AE82         MOV     R6,DPL
   \   00016E   AF83         MOV     R7,DPH
    670          
    671              pBuf = osal_cpyExtAddr( pBuf, ieee );
   \   000170                ; Setup parameters for call to function sAddrExtCpy
   \   000170   AC..         MOV     R4,?V0 + 2
   \   000172   AD..         MOV     R5,?V0 + 3
   \   000174   E582         MOV     A,DPL
   \   000176   AA82         MOV     R2,DPL
   \   000178   E583         MOV     A,DPH
   \   00017A   AB83         MOV     R3,DPH
   \   00017C   12....       LCALL   ??sAddrExtCpy?relay
   \   00017F   8A..         MOV     ?V0 + 2,R2
   \   000181   8B..         MOV     ?V0 + 3,R3
   \   000183   AE..         MOV     R6,?V0 + 2
   \   000185   AF..         MOV     R7,?V0 + 3
    672          
    673              *pBuf++ = LO_UINT16( aoi );
   \   000187   E5..         MOV     A,?V0 + 0
   \   000189   8E82         MOV     DPL,R6
   \   00018B   8F83         MOV     DPH,R7
   \   00018D   E5..         MOV     A,?V0 + 0
   \   00018F   F0           MOVX    @DPTR,A
   \   000190   8E82         MOV     DPL,R6
   \   000192   8F83         MOV     DPH,R7
   \   000194   A3           INC     DPTR
   \   000195   AE82         MOV     R6,DPL
   \   000197   AF83         MOV     R7,DPH
    674              *pBuf++ = HI_UINT16( aoi );
   \   000199   E4           CLR     A
   \   00019A   E5..         MOV     A,?V0 + 1
   \   00019C   F5..         MOV     ?V0 + 0,A
   \   00019E   E5..         MOV     A,?V0 + 0
   \   0001A0   8E82         MOV     DPL,R6
   \   0001A2   8F83         MOV     DPH,R7
   \   0001A4   E5..         MOV     A,?V0 + 0
   \   0001A6   F0           MOVX    @DPTR,A
   \   0001A7   8E82         MOV     DPL,R6
   \   0001A9   8F83         MOV     DPH,R7
   \   0001AB   A3           INC     DPTR
   \   0001AC   AE82         MOV     R6,DPL
   \   0001AE   AF83         MOV     R7,DPH
    675          
    676              if ( ZSTACK_ROUTER_BUILD )
    677              {
    678                if ( (reqType == ZDP_ADDR_REQTYPE_EXTENDED) && (aoi == ZDAppNwkAddr.addr.shortAddr)
    679                     && (stat == ZDP_SUCCESS) )
    680                {
    681                  uint8  cnt = 0;
    682                  uint16 *list = AssocMakeList( &cnt );
    683          
    684                  if ( list != NULL )
    685                  {
    686                    byte idx = inMsg->asdu[(((inMsg->clusterID == NWK_addr_req) ? Z_EXTADDR_LEN : sizeof( uint16 )) + 1)];
    687                    uint16 *pList = list + idx;
    688          
    689                    // NumAssocDev field is only present on success.
    690                    if ( cnt > idx )
    691                    {
    692                      cnt -= idx;
    693                      len += (cnt * sizeof( uint16 ));
    694                    }
    695                    else
    696                    {
    697                      cnt = 0;
    698                    }
    699                    *pBuf++ = cnt;
    700                    len++;
    701          
    702                    // StartIndex field is only present if NumAssocDev field is non-zero.
    703                    *pBuf++ = idx;
    704                    len++;
    705          
    706                    while ( cnt != 0 )
    707                    {
    708                      *pBuf++ = LO_UINT16( *pList );
    709                      *pBuf++ = HI_UINT16( *pList );
    710                      pList++;
    711                      cnt--;
    712                    }
    713          
    714                    osal_mem_free( (uint8 *)list );
    715                  }
    716                  else
    717                  {
    718                    // NumAssocDev field is only present on success.
    719                    *pBuf++ = 0;
    720                    len++;
    721                  }
    722                }
    723              }
    724          
    725              ZDP_TxOptions = AF_MSG_ACK_REQUEST;
   \   0001B0   90....       MOV     DPTR,#ZDP_TxOptions
   \   0001B3   7410         MOV     A,#0x10
   \   0001B5   F0           MOVX    @DPTR,A
    726              fillAndSend( &(inMsg->TransSeq), &(inMsg->srcAddr), (cId_t)(inMsg->clusterID | ZDO_RESPONSE_BIT), len );
   \   0001B6                ; Setup parameters for call to function fillAndSend
   \   0001B6   E5..         MOV     A,?V0 + 4
   \   0001B8   240C         ADD     A,#0xc
   \   0001BA   F582         MOV     DPL,A
   \   0001BC   E5..         MOV     A,?V0 + 5
   \   0001BE   3400         ADDC    A,#0x0
   \   0001C0   F583         MOV     DPH,A
   \   0001C2   E0           MOVX    A,@DPTR
   \   0001C3   4400         ORL     A,#0x0
   \   0001C5   F5..         MOV     ?V0 + 0,A
   \   0001C7   A3           INC     DPTR
   \   0001C8   E0           MOVX    A,@DPTR
   \   0001C9   4480         ORL     A,#0x80
   \   0001CB   F5..         MOV     ?V0 + 1,A
   \   0001CD   78..         MOV     R0,#?V0 + 0
   \   0001CF   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001D2   A9..         MOV     R1,?V0 + 7
   \   0001D4   E5..         MOV     A,?V0 + 4
   \   0001D6   2402         ADD     A,#0x2
   \   0001D8   FC           MOV     R4,A
   \   0001D9   E5..         MOV     A,?V0 + 5
   \   0001DB   3400         ADDC    A,#0x0
   \   0001DD   FD           MOV     R5,A
   \   0001DE   E5..         MOV     A,?V0 + 4
   \   0001E0   240F         ADD     A,#0xf
   \   0001E2   FA           MOV     R2,A
   \   0001E3   E5..         MOV     A,?V0 + 5
   \   0001E5   3400         ADDC    A,#0x0
   \   0001E7   FB           MOV     R3,A
   \   0001E8   12....       LCALL   ??fillAndSend?relay
   \   0001EB   7402         MOV     A,#0x2
   \   0001ED   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001F0   E9           MOV     A,R1
    727              ZDP_TxOptions = AF_TX_OPTIONS_NONE;
   \   0001F1   90....       MOV     DPTR,#ZDP_TxOptions
   \   0001F4   7400         MOV     A,#0x0
   \   0001F6   F0           MOVX    @DPTR,A
    728            }
    729          }
   \                     ??zdpProcessAddrReq_8:
   \   0001F7   7F08         MOV     R7,#0x8
   \   0001F9   02....       LJMP    ?BANKED_LEAVE_XDATA
    730          
    731          /*********************************************************************
    732           * @fn          ZDP_NodeDescMsg
    733           *
    734           * @brief       Builds and sends a Node Descriptor message, unicast to the
    735           *              specified device.
    736           *
    737           * @param       inMsg - incoming message
    738           * @param       nwkAddr - 16 bit network address for device
    739           * @param       pNodeDesc - pointer to the node descriptor
    740           *
    741           * @return      afStatus_t
    742           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    743          afStatus_t ZDP_NodeDescMsg( zdoIncomingMsg_t *inMsg,
   \                     ZDP_NodeDescMsg:
    744                                     uint16 nwkAddr, NodeDescriptorFormat_t *pNodeDesc )
    745          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   740C         MOV     A,#0xc
   \   000007   12....       LCALL   ?XSTACK_DISP0_8
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   FE           MOV     R6,A
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   FF           MOV     R7,A
    746            uint8 *pBuf = ZDP_TmpBuf;
   \   00000F   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000012   E0           MOVX    A,@DPTR
   \   000013   F8           MOV     R0,A
   \   000014   A3           INC     DPTR
   \   000015   E0           MOVX    A,@DPTR
   \   000016   F9           MOV     R1,A
    747            byte len;
    748          
    749            len = 1 + 2 + 13;  // Status + nwkAddr + Node descriptor
   \   000017   75..10       MOV     ?V0 + 0,#0x10
    750          
    751            *pBuf++ = ZDP_SUCCESS;
   \   00001A   8882         MOV     DPL,R0
   \   00001C   8983         MOV     DPH,R1
   \   00001E   7400         MOV     A,#0x0
   \   000020   F0           MOVX    @DPTR,A
   \   000021   8882         MOV     DPL,R0
   \   000023   8983         MOV     DPH,R1
   \   000025   A3           INC     DPTR
   \   000026   A882         MOV     R0,DPL
   \   000028   A983         MOV     R1,DPH
    752          
    753            *pBuf++ = LO_UINT16( nwkAddr );
   \   00002A   EC           MOV     A,R4
   \   00002B   8882         MOV     DPL,R0
   \   00002D   8983         MOV     DPH,R1
   \   00002F   F0           MOVX    @DPTR,A
   \   000030   8882         MOV     DPL,R0
   \   000032   8983         MOV     DPH,R1
   \   000034   A3           INC     DPTR
   \   000035   A882         MOV     R0,DPL
   \   000037   A983         MOV     R1,DPH
    754            *pBuf++ = HI_UINT16( nwkAddr );
   \   000039   E4           CLR     A
   \   00003A   ED           MOV     A,R5
   \   00003B   FC           MOV     R4,A
   \   00003C   8882         MOV     DPL,R0
   \   00003E   8983         MOV     DPH,R1
   \   000040   F0           MOVX    @DPTR,A
   \   000041   8882         MOV     DPL,R0
   \   000043   8983         MOV     DPH,R1
   \   000045   A3           INC     DPTR
   \   000046   A882         MOV     R0,DPL
   \   000048   A983         MOV     R1,DPH
    755          
    756            *pBuf++ = (byte)((pNodeDesc->ComplexDescAvail << 3) |
    757                               (pNodeDesc->UserDescAvail << 4) |
    758                               (pNodeDesc->LogicalType & 0x07));
   \   00004A   8E82         MOV     DPL,R6
   \   00004C   8F83         MOV     DPH,R7
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   5407         ANL     A,#0x7
   \   000051   FD           MOV     R5,A
   \   000052   8E82         MOV     DPL,R6
   \   000054   8F83         MOV     DPH,R7
   \   000056   E0           MOVX    A,@DPTR
   \   000057   5410         ANL     A,#0x10
   \   000059   FC           MOV     R4,A
   \   00005A   8E82         MOV     DPL,R6
   \   00005C   8F83         MOV     DPH,R7
   \   00005E   E0           MOVX    A,@DPTR
   \   00005F   5408         ANL     A,#0x8
   \   000061   4C           ORL     A,R4
   \   000062   4D           ORL     A,R5
   \   000063   8882         MOV     DPL,R0
   \   000065   8983         MOV     DPH,R1
   \   000067   F0           MOVX    @DPTR,A
   \   000068   8882         MOV     DPL,R0
   \   00006A   8983         MOV     DPH,R1
   \   00006C   A3           INC     DPTR
   \   00006D   A882         MOV     R0,DPL
   \   00006F   A983         MOV     R1,DPH
    759          
    760            *pBuf++ = (byte)((pNodeDesc->FrequencyBand << 3) | (pNodeDesc->APSFlags & 0x07));
   \   000071   8E82         MOV     DPL,R6
   \   000073   8F83         MOV     DPH,R7
   \   000075   A3           INC     DPTR
   \   000076   E0           MOVX    A,@DPTR
   \   000077   5407         ANL     A,#0x7
   \   000079   FC           MOV     R4,A
   \   00007A   8E82         MOV     DPL,R6
   \   00007C   8F83         MOV     DPH,R7
   \   00007E   A3           INC     DPTR
   \   00007F   E0           MOVX    A,@DPTR
   \   000080   54F8         ANL     A,#0xf8
   \   000082   4C           ORL     A,R4
   \   000083   8882         MOV     DPL,R0
   \   000085   8983         MOV     DPH,R1
   \   000087   F0           MOVX    @DPTR,A
   \   000088   8882         MOV     DPL,R0
   \   00008A   8983         MOV     DPH,R1
   \   00008C   A3           INC     DPTR
   \   00008D   A882         MOV     R0,DPL
   \   00008F   A983         MOV     R1,DPH
    761            *pBuf++ = pNodeDesc->CapabilityFlags;
   \   000091   8E82         MOV     DPL,R6
   \   000093   8F83         MOV     DPH,R7
   \   000095   A3           INC     DPTR
   \   000096   A3           INC     DPTR
   \   000097   E0           MOVX    A,@DPTR
   \   000098   8882         MOV     DPL,R0
   \   00009A   8983         MOV     DPH,R1
   \   00009C   F0           MOVX    @DPTR,A
   \   00009D   8882         MOV     DPL,R0
   \   00009F   8983         MOV     DPH,R1
   \   0000A1   A3           INC     DPTR
   \   0000A2   A882         MOV     R0,DPL
   \   0000A4   A983         MOV     R1,DPH
    762            *pBuf++ = pNodeDesc->ManufacturerCode[0];
   \   0000A6   8E82         MOV     DPL,R6
   \   0000A8   8F83         MOV     DPH,R7
   \   0000AA   A3           INC     DPTR
   \   0000AB   A3           INC     DPTR
   \   0000AC   A3           INC     DPTR
   \   0000AD   E0           MOVX    A,@DPTR
   \   0000AE   8882         MOV     DPL,R0
   \   0000B0   8983         MOV     DPH,R1
   \   0000B2   F0           MOVX    @DPTR,A
   \   0000B3   8882         MOV     DPL,R0
   \   0000B5   8983         MOV     DPH,R1
   \   0000B7   A3           INC     DPTR
   \   0000B8   A882         MOV     R0,DPL
   \   0000BA   A983         MOV     R1,DPH
    763            *pBuf++ = pNodeDesc->ManufacturerCode[1];
   \   0000BC   8E82         MOV     DPL,R6
   \   0000BE   8F83         MOV     DPH,R7
   \   0000C0   A3           INC     DPTR
   \   0000C1   A3           INC     DPTR
   \   0000C2   A3           INC     DPTR
   \   0000C3   A3           INC     DPTR
   \   0000C4   E0           MOVX    A,@DPTR
   \   0000C5   8882         MOV     DPL,R0
   \   0000C7   8983         MOV     DPH,R1
   \   0000C9   F0           MOVX    @DPTR,A
   \   0000CA   8882         MOV     DPL,R0
   \   0000CC   8983         MOV     DPH,R1
   \   0000CE   A3           INC     DPTR
   \   0000CF   A882         MOV     R0,DPL
   \   0000D1   A983         MOV     R1,DPH
    764            *pBuf++ = pNodeDesc->MaxBufferSize;
   \   0000D3   8E82         MOV     DPL,R6
   \   0000D5   8F83         MOV     DPH,R7
   \   0000D7   A3           INC     DPTR
   \   0000D8   A3           INC     DPTR
   \   0000D9   A3           INC     DPTR
   \   0000DA   A3           INC     DPTR
   \   0000DB   A3           INC     DPTR
   \   0000DC   E0           MOVX    A,@DPTR
   \   0000DD   8882         MOV     DPL,R0
   \   0000DF   8983         MOV     DPH,R1
   \   0000E1   F0           MOVX    @DPTR,A
   \   0000E2   8882         MOV     DPL,R0
   \   0000E4   8983         MOV     DPH,R1
   \   0000E6   A3           INC     DPTR
   \   0000E7   A882         MOV     R0,DPL
   \   0000E9   A983         MOV     R1,DPH
    765            *pBuf++ = pNodeDesc->MaxInTransferSize[0];
   \   0000EB   8E82         MOV     DPL,R6
   \   0000ED   8F83         MOV     DPH,R7
   \   0000EF   A3           INC     DPTR
   \   0000F0   A3           INC     DPTR
   \   0000F1   A3           INC     DPTR
   \   0000F2   A3           INC     DPTR
   \   0000F3   A3           INC     DPTR
   \   0000F4   A3           INC     DPTR
   \   0000F5   E0           MOVX    A,@DPTR
   \   0000F6   8882         MOV     DPL,R0
   \   0000F8   8983         MOV     DPH,R1
   \   0000FA   F0           MOVX    @DPTR,A
   \   0000FB   8882         MOV     DPL,R0
   \   0000FD   8983         MOV     DPH,R1
   \   0000FF   A3           INC     DPTR
   \   000100   A882         MOV     R0,DPL
   \   000102   A983         MOV     R1,DPH
    766            *pBuf++ = pNodeDesc->MaxInTransferSize[1];
   \   000104   8E82         MOV     DPL,R6
   \   000106   8F83         MOV     DPH,R7
   \   000108   A3           INC     DPTR
   \   000109   A3           INC     DPTR
   \   00010A   A3           INC     DPTR
   \   00010B   A3           INC     DPTR
   \   00010C   A3           INC     DPTR
   \   00010D   A3           INC     DPTR
   \   00010E   A3           INC     DPTR
   \   00010F   E0           MOVX    A,@DPTR
   \   000110   8882         MOV     DPL,R0
   \   000112   8983         MOV     DPH,R1
   \   000114   F0           MOVX    @DPTR,A
   \   000115   8882         MOV     DPL,R0
   \   000117   8983         MOV     DPH,R1
   \   000119   A3           INC     DPTR
   \   00011A   A882         MOV     R0,DPL
   \   00011C   A983         MOV     R1,DPH
    767          
    768            *pBuf++ = LO_UINT16( pNodeDesc->ServerMask );
   \   00011E   8E82         MOV     DPL,R6
   \   000120   8F83         MOV     DPH,R7
   \   000122   A3           INC     DPTR
   \   000123   A3           INC     DPTR
   \   000124   A3           INC     DPTR
   \   000125   A3           INC     DPTR
   \   000126   A3           INC     DPTR
   \   000127   A3           INC     DPTR
   \   000128   A3           INC     DPTR
   \   000129   A3           INC     DPTR
   \   00012A   E0           MOVX    A,@DPTR
   \   00012B   FC           MOV     R4,A
   \   00012C   A3           INC     DPTR
   \   00012D   E0           MOVX    A,@DPTR
   \   00012E   FD           MOV     R5,A
   \   00012F   EC           MOV     A,R4
   \   000130   8882         MOV     DPL,R0
   \   000132   8983         MOV     DPH,R1
   \   000134   F0           MOVX    @DPTR,A
   \   000135   8882         MOV     DPL,R0
   \   000137   8983         MOV     DPH,R1
   \   000139   A3           INC     DPTR
   \   00013A   A882         MOV     R0,DPL
   \   00013C   A983         MOV     R1,DPH
    769            *pBuf++ = HI_UINT16( pNodeDesc->ServerMask );
   \   00013E   8E82         MOV     DPL,R6
   \   000140   8F83         MOV     DPH,R7
   \   000142   A3           INC     DPTR
   \   000143   A3           INC     DPTR
   \   000144   A3           INC     DPTR
   \   000145   A3           INC     DPTR
   \   000146   A3           INC     DPTR
   \   000147   A3           INC     DPTR
   \   000148   A3           INC     DPTR
   \   000149   A3           INC     DPTR
   \   00014A   E0           MOVX    A,@DPTR
   \   00014B   FC           MOV     R4,A
   \   00014C   A3           INC     DPTR
   \   00014D   E0           MOVX    A,@DPTR
   \   00014E   FD           MOV     R5,A
   \   00014F   E4           CLR     A
   \   000150   ED           MOV     A,R5
   \   000151   FC           MOV     R4,A
   \   000152   8882         MOV     DPL,R0
   \   000154   8983         MOV     DPH,R1
   \   000156   F0           MOVX    @DPTR,A
   \   000157   8882         MOV     DPL,R0
   \   000159   8983         MOV     DPH,R1
   \   00015B   A3           INC     DPTR
   \   00015C   A882         MOV     R0,DPL
   \   00015E   A983         MOV     R1,DPH
    770            *pBuf++ = pNodeDesc->MaxOutTransferSize[0];
   \   000160   8E82         MOV     DPL,R6
   \   000162   8F83         MOV     DPH,R7
   \   000164   A3           INC     DPTR
   \   000165   A3           INC     DPTR
   \   000166   A3           INC     DPTR
   \   000167   A3           INC     DPTR
   \   000168   A3           INC     DPTR
   \   000169   A3           INC     DPTR
   \   00016A   A3           INC     DPTR
   \   00016B   A3           INC     DPTR
   \   00016C   A3           INC     DPTR
   \   00016D   A3           INC     DPTR
   \   00016E   E0           MOVX    A,@DPTR
   \   00016F   8882         MOV     DPL,R0
   \   000171   8983         MOV     DPH,R1
   \   000173   F0           MOVX    @DPTR,A
   \   000174   8882         MOV     DPL,R0
   \   000176   8983         MOV     DPH,R1
   \   000178   A3           INC     DPTR
   \   000179   A882         MOV     R0,DPL
   \   00017B   A983         MOV     R1,DPH
    771            *pBuf++ = pNodeDesc->MaxOutTransferSize[1];
   \   00017D   EE           MOV     A,R6
   \   00017E   240B         ADD     A,#0xb
   \   000180   F582         MOV     DPL,A
   \   000182   EF           MOV     A,R7
   \   000183   3400         ADDC    A,#0x0
   \   000185   F583         MOV     DPH,A
   \   000187   E0           MOVX    A,@DPTR
   \   000188   8882         MOV     DPL,R0
   \   00018A   8983         MOV     DPH,R1
   \   00018C   F0           MOVX    @DPTR,A
   \   00018D   8882         MOV     DPL,R0
   \   00018F   8983         MOV     DPH,R1
   \   000191   A3           INC     DPTR
   \   000192   A882         MOV     R0,DPL
   \   000194   A983         MOV     R1,DPH
    772            *pBuf = pNodeDesc->DescriptorCapability;
   \   000196   EE           MOV     A,R6
   \   000197   240C         ADD     A,#0xc
   \   000199   F582         MOV     DPL,A
   \   00019B   EF           MOV     A,R7
   \   00019C   3400         ADDC    A,#0x0
   \   00019E   F583         MOV     DPH,A
   \   0001A0   E0           MOVX    A,@DPTR
   \   0001A1   8882         MOV     DPL,R0
   \   0001A3   8983         MOV     DPH,R1
   \   0001A5   F0           MOVX    @DPTR,A
    773          
    774            return fillAndSend( &(inMsg->TransSeq), &(inMsg->srcAddr), Node_Desc_rsp, len );
   \   0001A6                ; Setup parameters for call to function fillAndSend
   \   0001A6   75..02       MOV     ?V0 + 2,#0x2
   \   0001A9   75..80       MOV     ?V0 + 3,#-0x80
   \   0001AC   78..         MOV     R0,#?V0 + 2
   \   0001AE   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001B1   A9..         MOV     R1,?V0 + 0
   \   0001B3   EA           MOV     A,R2
   \   0001B4   2402         ADD     A,#0x2
   \   0001B6   FC           MOV     R4,A
   \   0001B7   EB           MOV     A,R3
   \   0001B8   3400         ADDC    A,#0x0
   \   0001BA   FD           MOV     R5,A
   \   0001BB   EA           MOV     A,R2
   \   0001BC   240F         ADD     A,#0xf
   \   0001BE   FA           MOV     R2,A
   \   0001BF   EB           MOV     A,R3
   \   0001C0   3400         ADDC    A,#0x0
   \   0001C2   FB           MOV     R3,A
   \   0001C3   12....       LCALL   ??fillAndSend?relay
   \   0001C6   7402         MOV     A,#0x2
   \   0001C8   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001CB   7F04         MOV     R7,#0x4
   \   0001CD   02....       LJMP    ?BANKED_LEAVE_XDATA
    775          }
    776          
    777          /*********************************************************************
    778           * @fn          ZDP_PowerDescMsg
    779           *
    780           * @brief       Builds and sends a Power Descriptor message, unicast to the
    781           *              specified device.
    782           *
    783           * @param       inMsg - incoming message (request)
    784           * @param       nwkAddr - 16 bit network address for device
    785           * @param       pPowerDesc - pointer to the node descriptor
    786           *
    787           * @return      afStatus_t
    788           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    789          afStatus_t ZDP_PowerDescMsg( zdoIncomingMsg_t *inMsg,
   \                     ZDP_PowerDescMsg:
    790                               uint16 nwkAddr, NodePowerDescriptorFormat_t *pPowerDesc )
    791          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   740C         MOV     A,#0xc
   \   000007   12....       LCALL   ?XSTACK_DISP0_8
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   F8           MOV     R0,A
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F9           MOV     R1,A
    792            uint8 *pBuf = ZDP_TmpBuf;
   \   00000F   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000012   E0           MOVX    A,@DPTR
   \   000013   FE           MOV     R6,A
   \   000014   A3           INC     DPTR
   \   000015   E0           MOVX    A,@DPTR
   \   000016   FF           MOV     R7,A
    793            byte len = 1 + 2 + 2;  // Status + nwkAddr + Node Power descriptor.
   \   000017   75..05       MOV     ?V0 + 0,#0x5
    794          
    795            *pBuf++ = ZDP_SUCCESS;
   \   00001A   8E82         MOV     DPL,R6
   \   00001C   8F83         MOV     DPH,R7
   \   00001E   7400         MOV     A,#0x0
   \   000020   F0           MOVX    @DPTR,A
   \   000021   8E82         MOV     DPL,R6
   \   000023   8F83         MOV     DPH,R7
   \   000025   A3           INC     DPTR
   \   000026   AE82         MOV     R6,DPL
   \   000028   AF83         MOV     R7,DPH
    796          
    797            *pBuf++ = LO_UINT16( nwkAddr );
   \   00002A   EC           MOV     A,R4
   \   00002B   8E82         MOV     DPL,R6
   \   00002D   8F83         MOV     DPH,R7
   \   00002F   F0           MOVX    @DPTR,A
   \   000030   8E82         MOV     DPL,R6
   \   000032   8F83         MOV     DPH,R7
   \   000034   A3           INC     DPTR
   \   000035   AE82         MOV     R6,DPL
   \   000037   AF83         MOV     R7,DPH
    798            *pBuf++ = HI_UINT16( nwkAddr );
   \   000039   E4           CLR     A
   \   00003A   ED           MOV     A,R5
   \   00003B   FC           MOV     R4,A
   \   00003C   8E82         MOV     DPL,R6
   \   00003E   8F83         MOV     DPH,R7
   \   000040   F0           MOVX    @DPTR,A
   \   000041   8E82         MOV     DPL,R6
   \   000043   8F83         MOV     DPH,R7
   \   000045   A3           INC     DPTR
   \   000046   AE82         MOV     R6,DPL
   \   000048   AF83         MOV     R7,DPH
    799          
    800            *pBuf++ = (byte)((pPowerDesc->AvailablePowerSources << 4)
    801                              | (pPowerDesc->PowerMode & 0x0F));
   \   00004A   8882         MOV     DPL,R0
   \   00004C   8983         MOV     DPH,R1
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   FC           MOV     R4,A
   \   000050   A3           INC     DPTR
   \   000051   E0           MOVX    A,@DPTR
   \   000052   FD           MOV     R5,A
   \   000053   EC           MOV     A,R4
   \   000054   540F         ANL     A,#0xf
   \   000056   F5..         MOV     ?V0 + 1,A
   \   000058   8882         MOV     DPL,R0
   \   00005A   8983         MOV     DPH,R1
   \   00005C   E0           MOVX    A,@DPTR
   \   00005D   FC           MOV     R4,A
   \   00005E   A3           INC     DPTR
   \   00005F   E0           MOVX    A,@DPTR
   \   000060   FD           MOV     R5,A
   \   000061   EC           MOV     A,R4
   \   000062   54F0         ANL     A,#0xf0
   \   000064   45..         ORL     A,?V0 + 1
   \   000066   8E82         MOV     DPL,R6
   \   000068   8F83         MOV     DPH,R7
   \   00006A   F0           MOVX    @DPTR,A
   \   00006B   8E82         MOV     DPL,R6
   \   00006D   8F83         MOV     DPH,R7
   \   00006F   A3           INC     DPTR
   \   000070   AE82         MOV     R6,DPL
   \   000072   AF83         MOV     R7,DPH
    802            *pBuf++ = (byte)((pPowerDesc->CurrentPowerSourceLevel << 4)
    803                              | (pPowerDesc->CurrentPowerSource & 0x0F));
   \   000074   8882         MOV     DPL,R0
   \   000076   8983         MOV     DPH,R1
   \   000078   E0           MOVX    A,@DPTR
   \   000079   FC           MOV     R4,A
   \   00007A   A3           INC     DPTR
   \   00007B   E0           MOVX    A,@DPTR
   \   00007C   FD           MOV     R5,A
   \   00007D   E4           CLR     A
   \   00007E   ED           MOV     A,R5
   \   00007F   FC           MOV     R4,A
   \   000080   540F         ANL     A,#0xf
   \   000082   FC           MOV     R4,A
   \   000083   8882         MOV     DPL,R0
   \   000085   8983         MOV     DPH,R1
   \   000087   E0           MOVX    A,@DPTR
   \   000088   F5..         MOV     ?V0 + 2,A
   \   00008A   A3           INC     DPTR
   \   00008B   E0           MOVX    A,@DPTR
   \   00008C   F5..         MOV     ?V0 + 3,A
   \   00008E   740C         MOV     A,#0xc
   \   000090   78..         MOV     R0,#?V0 + 2
   \   000092   12....       LCALL   ?US_SHR
   \   000095   E5..         MOV     A,?V0 + 2
   \   000097   C4           SWAP    A
   \   000098   54F0         ANL     A,#0xf0
   \   00009A   4C           ORL     A,R4
   \   00009B   8E82         MOV     DPL,R6
   \   00009D   8F83         MOV     DPH,R7
   \   00009F   F0           MOVX    @DPTR,A
   \   0000A0   8E82         MOV     DPL,R6
   \   0000A2   8F83         MOV     DPH,R7
   \   0000A4   A3           INC     DPTR
   \   0000A5   AE82         MOV     R6,DPL
   \   0000A7   AF83         MOV     R7,DPH
    804          
    805            return fillAndSend( &(inMsg->TransSeq), &(inMsg->srcAddr), Power_Desc_rsp, len );
   \   0000A9                ; Setup parameters for call to function fillAndSend
   \   0000A9   75..03       MOV     ?V0 + 2,#0x3
   \   0000AC   75..80       MOV     ?V0 + 3,#-0x80
   \   0000AF   78..         MOV     R0,#?V0 + 2
   \   0000B1   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000B4   A9..         MOV     R1,?V0 + 0
   \   0000B6   EA           MOV     A,R2
   \   0000B7   2402         ADD     A,#0x2
   \   0000B9   FC           MOV     R4,A
   \   0000BA   EB           MOV     A,R3
   \   0000BB   3400         ADDC    A,#0x0
   \   0000BD   FD           MOV     R5,A
   \   0000BE   EA           MOV     A,R2
   \   0000BF   240F         ADD     A,#0xf
   \   0000C1   FA           MOV     R2,A
   \   0000C2   EB           MOV     A,R3
   \   0000C3   3400         ADDC    A,#0x0
   \   0000C5   FB           MOV     R3,A
   \   0000C6   12....       LCALL   ??fillAndSend?relay
   \   0000C9   7402         MOV     A,#0x2
   \   0000CB   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000CE   7F04         MOV     R7,#0x4
   \   0000D0   02....       LJMP    ?BANKED_LEAVE_XDATA
    806          }
    807          
    808          /*********************************************************************
    809           * @fn          ZDP_SimpleDescMsg
    810           *
    811           * @brief       Builds and sends a Simple Descriptor message, unicast to the
    812           *              specified device.
    813           *
    814           * @param       inMsg - incoming message (request)
    815           * @param       Status - message status (ZDP_SUCCESS or other)
    816           * @param       pSimpleDesc - pointer to the node descriptor
    817           *
    818           * @return      afStatus_t
    819           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    820          afStatus_t ZDP_SimpleDescMsg( zdoIncomingMsg_t *inMsg, byte Status,
   \                     ZDP_SimpleDescMsg:
    821                                        SimpleDescriptionFormat_t *pSimpleDesc )
    822          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   8C..         MOV     ?V0 + 0,R4
   \   000009   8D..         MOV     ?V0 + 1,R5
    823            uint8 *pBuf = ZDP_TmpBuf;
   \   00000B   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   F8           MOV     R0,A
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F9           MOV     R1,A
    824            uint8 i, len;
    825          
    826            if ( Status == ZDP_SUCCESS && pSimpleDesc )
   \   000013   EE           MOV     A,R6
   \   000014   7045         JNZ     ??ZDP_SimpleDescMsg_0
   \   000016   E5..         MOV     A,?V0 + 0
   \   000018   45..         ORL     A,?V0 + 1
   \   00001A   603F         JZ      ??ZDP_SimpleDescMsg_0
    827            {
    828              // Status + NWKAddrOfInterest + desc length + empty simple descriptor.
    829              len = 1 + 2 + 1 + 8;
   \   00001C   7C0C         MOV     R4,#0xc
    830              len += (pSimpleDesc->AppNumInClusters + pSimpleDesc->AppNumOutClusters) * sizeof ( uint16 );
   \   00001E   75F002       MOV     B,#0x2
   \   000021   85..82       MOV     DPL,?V0 + 0
   \   000024   85..83       MOV     DPH,?V0 + 1
   \   000027   A3           INC     DPTR
   \   000028   A3           INC     DPTR
   \   000029   A3           INC     DPTR
   \   00002A   A3           INC     DPTR
   \   00002B   A3           INC     DPTR
   \   00002C   A3           INC     DPTR
   \   00002D   E0           MOVX    A,@DPTR
   \   00002E   F5..         MOV     ?V0 + 2,A
   \   000030   75..00       MOV     ?V0 + 3,#0x0
   \   000033   85..82       MOV     DPL,?V0 + 0
   \   000036   85..83       MOV     DPH,?V0 + 1
   \   000039   A3           INC     DPTR
   \   00003A   A3           INC     DPTR
   \   00003B   A3           INC     DPTR
   \   00003C   A3           INC     DPTR
   \   00003D   A3           INC     DPTR
   \   00003E   A3           INC     DPTR
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   E0           MOVX    A,@DPTR
   \   000043   F5..         MOV     ?V0 + 4,A
   \   000045   75..00       MOV     ?V0 + 5,#0x0
   \   000048   E5..         MOV     A,?V0 + 2
   \   00004A   25..         ADD     A,?V0 + 4
   \   00004C   F5..         MOV     ?V0 + 2,A
   \   00004E   E5..         MOV     A,?V0 + 3
   \   000050   35..         ADDC    A,?V0 + 5
   \   000052   F5..         MOV     ?V0 + 3,A
   \   000054   E5..         MOV     A,?V0 + 2
   \   000056   A4           MUL     AB
   \   000057   2C           ADD     A,R4
   \   000058   FC           MOV     R4,A
   \   000059   8002         SJMP    ??ZDP_SimpleDescMsg_1
    831            }
    832            else
    833            {
    834              len = 1 + 2 + 1; // Status + desc length
   \                     ??ZDP_SimpleDescMsg_0:
   \   00005B   7C04         MOV     R4,#0x4
    835            }
    836            if ( len >= ZDP_BUF_SZ-1 )
   \                     ??ZDP_SimpleDescMsg_1:
   \   00005D   EC           MOV     A,R4
   \   00005E   C3           CLR     C
   \   00005F   944F         SUBB    A,#0x4f
   \   000061   4005         JC      ??ZDP_SimpleDescMsg_2
    837            {
    838              return afStatus_MEM_FAIL;
   \   000063   7910         MOV     R1,#0x10
   \   000065   02....       LJMP    ??ZDP_SimpleDescMsg_3 & 0xFFFF
    839            }
    840          
    841            *pBuf++ = Status;
   \                     ??ZDP_SimpleDescMsg_2:
   \   000068   EE           MOV     A,R6
   \   000069   8882         MOV     DPL,R0
   \   00006B   8983         MOV     DPH,R1
   \   00006D   F0           MOVX    @DPTR,A
   \   00006E   8882         MOV     DPL,R0
   \   000070   8983         MOV     DPH,R1
   \   000072   A3           INC     DPTR
   \   000073   A882         MOV     R0,DPL
   \   000075   A983         MOV     R1,DPH
    842          
    843            *pBuf++ = LO_UINT16( ZDAppNwkAddr.addr.shortAddr );
   \   000077   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00007A   E0           MOVX    A,@DPTR
   \   00007B   F5..         MOV     ?V0 + 2,A
   \   00007D   A3           INC     DPTR
   \   00007E   E0           MOVX    A,@DPTR
   \   00007F   F5..         MOV     ?V0 + 3,A
   \   000081   E5..         MOV     A,?V0 + 2
   \   000083   8882         MOV     DPL,R0
   \   000085   8983         MOV     DPH,R1
   \   000087   E5..         MOV     A,?V0 + 2
   \   000089   F0           MOVX    @DPTR,A
   \   00008A   8882         MOV     DPL,R0
   \   00008C   8983         MOV     DPH,R1
   \   00008E   A3           INC     DPTR
   \   00008F   A882         MOV     R0,DPL
   \   000091   A983         MOV     R1,DPH
    844            *pBuf++ = HI_UINT16( ZDAppNwkAddr.addr.shortAddr );
   \   000093   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000096   E0           MOVX    A,@DPTR
   \   000097   F5..         MOV     ?V0 + 2,A
   \   000099   A3           INC     DPTR
   \   00009A   E0           MOVX    A,@DPTR
   \   00009B   F5..         MOV     ?V0 + 3,A
   \   00009D   E4           CLR     A
   \   00009E   E5..         MOV     A,?V0 + 3
   \   0000A0   F5..         MOV     ?V0 + 2,A
   \   0000A2   E5..         MOV     A,?V0 + 2
   \   0000A4   8882         MOV     DPL,R0
   \   0000A6   8983         MOV     DPH,R1
   \   0000A8   E5..         MOV     A,?V0 + 2
   \   0000AA   F0           MOVX    @DPTR,A
   \   0000AB   8882         MOV     DPL,R0
   \   0000AD   8983         MOV     DPH,R1
   \   0000AF   A3           INC     DPTR
   \   0000B0   A882         MOV     R0,DPL
   \   0000B2   A983         MOV     R1,DPH
    845          
    846            if ( len > 4 )
   \   0000B4   EC           MOV     A,R4
   \   0000B5   C3           CLR     C
   \   0000B6   9405         SUBB    A,#0x5
   \   0000B8   5003         JNC     $+5
   \   0000BA   02....       LJMP    ??ZDP_SimpleDescMsg_4 & 0xFFFF
    847            {
    848              *pBuf++ = len - 4;   // Simple descriptor length
   \   0000BD   74FC         MOV     A,#-0x4
   \   0000BF   2C           ADD     A,R4
   \   0000C0   8882         MOV     DPL,R0
   \   0000C2   8983         MOV     DPH,R1
   \   0000C4   F0           MOVX    @DPTR,A
   \   0000C5   8882         MOV     DPL,R0
   \   0000C7   8983         MOV     DPH,R1
   \   0000C9   A3           INC     DPTR
   \   0000CA   A882         MOV     R0,DPL
   \   0000CC   A983         MOV     R1,DPH
    849          
    850              *pBuf++ = pSimpleDesc->EndPoint;
   \   0000CE   85..82       MOV     DPL,?V0 + 0
   \   0000D1   85..83       MOV     DPH,?V0 + 1
   \   0000D4   E0           MOVX    A,@DPTR
   \   0000D5   8882         MOV     DPL,R0
   \   0000D7   8983         MOV     DPH,R1
   \   0000D9   F0           MOVX    @DPTR,A
   \   0000DA   8882         MOV     DPL,R0
   \   0000DC   8983         MOV     DPH,R1
   \   0000DE   A3           INC     DPTR
   \   0000DF   A882         MOV     R0,DPL
   \   0000E1   A983         MOV     R1,DPH
    851              *pBuf++ = LO_UINT16( pSimpleDesc->AppProfId );
   \   0000E3   85..82       MOV     DPL,?V0 + 0
   \   0000E6   85..83       MOV     DPH,?V0 + 1
   \   0000E9   A3           INC     DPTR
   \   0000EA   E0           MOVX    A,@DPTR
   \   0000EB   F5..         MOV     ?V0 + 2,A
   \   0000ED   A3           INC     DPTR
   \   0000EE   E0           MOVX    A,@DPTR
   \   0000EF   F5..         MOV     ?V0 + 3,A
   \   0000F1   E5..         MOV     A,?V0 + 2
   \   0000F3   8882         MOV     DPL,R0
   \   0000F5   8983         MOV     DPH,R1
   \   0000F7   E5..         MOV     A,?V0 + 2
   \   0000F9   F0           MOVX    @DPTR,A
   \   0000FA   8882         MOV     DPL,R0
   \   0000FC   8983         MOV     DPH,R1
   \   0000FE   A3           INC     DPTR
   \   0000FF   A882         MOV     R0,DPL
   \   000101   A983         MOV     R1,DPH
    852              *pBuf++ = HI_UINT16( pSimpleDesc->AppProfId );
   \   000103   85..82       MOV     DPL,?V0 + 0
   \   000106   85..83       MOV     DPH,?V0 + 1
   \   000109   A3           INC     DPTR
   \   00010A   E0           MOVX    A,@DPTR
   \   00010B   F5..         MOV     ?V0 + 2,A
   \   00010D   A3           INC     DPTR
   \   00010E   E0           MOVX    A,@DPTR
   \   00010F   F5..         MOV     ?V0 + 3,A
   \   000111   E4           CLR     A
   \   000112   E5..         MOV     A,?V0 + 3
   \   000114   F5..         MOV     ?V0 + 2,A
   \   000116   E5..         MOV     A,?V0 + 2
   \   000118   8882         MOV     DPL,R0
   \   00011A   8983         MOV     DPH,R1
   \   00011C   E5..         MOV     A,?V0 + 2
   \   00011E   F0           MOVX    @DPTR,A
   \   00011F   8882         MOV     DPL,R0
   \   000121   8983         MOV     DPH,R1
   \   000123   A3           INC     DPTR
   \   000124   A882         MOV     R0,DPL
   \   000126   A983         MOV     R1,DPH
    853              *pBuf++ = LO_UINT16( pSimpleDesc->AppDeviceId );
   \   000128   85..82       MOV     DPL,?V0 + 0
   \   00012B   85..83       MOV     DPH,?V0 + 1
   \   00012E   A3           INC     DPTR
   \   00012F   A3           INC     DPTR
   \   000130   A3           INC     DPTR
   \   000131   E0           MOVX    A,@DPTR
   \   000132   F5..         MOV     ?V0 + 2,A
   \   000134   A3           INC     DPTR
   \   000135   E0           MOVX    A,@DPTR
   \   000136   F5..         MOV     ?V0 + 3,A
   \   000138   E5..         MOV     A,?V0 + 2
   \   00013A   8882         MOV     DPL,R0
   \   00013C   8983         MOV     DPH,R1
   \   00013E   E5..         MOV     A,?V0 + 2
   \   000140   F0           MOVX    @DPTR,A
   \   000141   8882         MOV     DPL,R0
   \   000143   8983         MOV     DPH,R1
   \   000145   A3           INC     DPTR
   \   000146   A882         MOV     R0,DPL
   \   000148   A983         MOV     R1,DPH
    854              *pBuf++ = HI_UINT16( pSimpleDesc->AppDeviceId );
   \   00014A   85..82       MOV     DPL,?V0 + 0
   \   00014D   85..83       MOV     DPH,?V0 + 1
   \   000150   A3           INC     DPTR
   \   000151   A3           INC     DPTR
   \   000152   A3           INC     DPTR
   \   000153   E0           MOVX    A,@DPTR
   \   000154   F5..         MOV     ?V0 + 2,A
   \   000156   A3           INC     DPTR
   \   000157   E0           MOVX    A,@DPTR
   \   000158   F5..         MOV     ?V0 + 3,A
   \   00015A   E4           CLR     A
   \   00015B   E5..         MOV     A,?V0 + 3
   \   00015D   F5..         MOV     ?V0 + 2,A
   \   00015F   E5..         MOV     A,?V0 + 2
   \   000161   8882         MOV     DPL,R0
   \   000163   8983         MOV     DPH,R1
   \   000165   E5..         MOV     A,?V0 + 2
   \   000167   F0           MOVX    @DPTR,A
   \   000168   8882         MOV     DPL,R0
   \   00016A   8983         MOV     DPH,R1
   \   00016C   A3           INC     DPTR
   \   00016D   A882         MOV     R0,DPL
   \   00016F   A983         MOV     R1,DPH
    855          
    856              *pBuf++ = (byte)(pSimpleDesc->AppDevVer << 4);
   \   000171   85..82       MOV     DPL,?V0 + 0
   \   000174   85..83       MOV     DPH,?V0 + 1
   \   000177   A3           INC     DPTR
   \   000178   A3           INC     DPTR
   \   000179   A3           INC     DPTR
   \   00017A   A3           INC     DPTR
   \   00017B   A3           INC     DPTR
   \   00017C   E0           MOVX    A,@DPTR
   \   00017D   C4           SWAP    A
   \   00017E   54F0         ANL     A,#0xf0
   \   000180   8882         MOV     DPL,R0
   \   000182   8983         MOV     DPH,R1
   \   000184   F0           MOVX    @DPTR,A
   \   000185   8882         MOV     DPL,R0
   \   000187   8983         MOV     DPH,R1
   \   000189   A3           INC     DPTR
   \   00018A   A882         MOV     R0,DPL
   \   00018C   A983         MOV     R1,DPH
    857          
    858              *pBuf++ = pSimpleDesc->AppNumInClusters;
   \   00018E   85..82       MOV     DPL,?V0 + 0
   \   000191   85..83       MOV     DPH,?V0 + 1
   \   000194   A3           INC     DPTR
   \   000195   A3           INC     DPTR
   \   000196   A3           INC     DPTR
   \   000197   A3           INC     DPTR
   \   000198   A3           INC     DPTR
   \   000199   A3           INC     DPTR
   \   00019A   E0           MOVX    A,@DPTR
   \   00019B   8882         MOV     DPL,R0
   \   00019D   8983         MOV     DPH,R1
   \   00019F   F0           MOVX    @DPTR,A
   \   0001A0   8882         MOV     DPL,R0
   \   0001A2   8983         MOV     DPH,R1
   \   0001A4   A3           INC     DPTR
   \   0001A5   A882         MOV     R0,DPL
   \   0001A7   A983         MOV     R1,DPH
    859              if ( pSimpleDesc->AppNumInClusters )
   \   0001A9   85..82       MOV     DPL,?V0 + 0
   \   0001AC   85..83       MOV     DPH,?V0 + 1
   \   0001AF   A3           INC     DPTR
   \   0001B0   A3           INC     DPTR
   \   0001B1   A3           INC     DPTR
   \   0001B2   A3           INC     DPTR
   \   0001B3   A3           INC     DPTR
   \   0001B4   A3           INC     DPTR
   \   0001B5   E0           MOVX    A,@DPTR
   \   0001B6   7003         JNZ     $+5
   \   0001B8   02....       LJMP    ??ZDP_SimpleDescMsg_5 & 0xFFFF
    860              {
    861                for (i=0; i<pSimpleDesc->AppNumInClusters; ++i)
   \   0001BB   7D00         MOV     R5,#0x0
   \   0001BD   02....       LJMP    ??ZDP_SimpleDescMsg_6 & 0xFFFF
    862                {
    863                  *pBuf++ = LO_UINT16( pSimpleDesc->pAppInClusterList[i] );
   \                     ??ZDP_SimpleDescMsg_7:
   \   0001C0   ED           MOV     A,R5
   \   0001C1   F5..         MOV     ?V0 + 2,A
   \   0001C3   75..00       MOV     ?V0 + 3,#0x0
   \   0001C6   E5..         MOV     A,?V0 + 2
   \   0001C8   75F002       MOV     B,#0x2
   \   0001CB   A4           MUL     AB
   \   0001CC   C5..         XCH     A,?V0 + 2
   \   0001CE   AFF0         MOV     R7,B
   \   0001D0   75F000       MOV     B,#0x0
   \   0001D3   A4           MUL     AB
   \   0001D4   2F           ADD     A,R7
   \   0001D5   FF           MOV     R7,A
   \   0001D6   75F002       MOV     B,#0x2
   \   0001D9   E5..         MOV     A,?V0 + 3
   \   0001DB   A4           MUL     AB
   \   0001DC   2F           ADD     A,R7
   \   0001DD   F5..         MOV     ?V0 + 3,A
   \   0001DF   85..82       MOV     DPL,?V0 + 0
   \   0001E2   85..83       MOV     DPH,?V0 + 1
   \   0001E5   A3           INC     DPTR
   \   0001E6   A3           INC     DPTR
   \   0001E7   A3           INC     DPTR
   \   0001E8   A3           INC     DPTR
   \   0001E9   A3           INC     DPTR
   \   0001EA   A3           INC     DPTR
   \   0001EB   A3           INC     DPTR
   \   0001EC   E0           MOVX    A,@DPTR
   \   0001ED   25..         ADD     A,?V0 + 2
   \   0001EF   FF           MOV     R7,A
   \   0001F0   A3           INC     DPTR
   \   0001F1   E0           MOVX    A,@DPTR
   \   0001F2   35..         ADDC    A,?V0 + 3
   \   0001F4   8F82         MOV     DPL,R7
   \   0001F6   F583         MOV     DPH,A
   \   0001F8   E0           MOVX    A,@DPTR
   \   0001F9   F5..         MOV     ?V0 + 2,A
   \   0001FB   A3           INC     DPTR
   \   0001FC   E0           MOVX    A,@DPTR
   \   0001FD   F5..         MOV     ?V0 + 3,A
   \   0001FF   E5..         MOV     A,?V0 + 2
   \   000201   8882         MOV     DPL,R0
   \   000203   8983         MOV     DPH,R1
   \   000205   E5..         MOV     A,?V0 + 2
   \   000207   F0           MOVX    @DPTR,A
   \   000208   8882         MOV     DPL,R0
   \   00020A   8983         MOV     DPH,R1
   \   00020C   A3           INC     DPTR
   \   00020D   A882         MOV     R0,DPL
   \   00020F   A983         MOV     R1,DPH
    864                  *pBuf++ = HI_UINT16( pSimpleDesc->pAppInClusterList[i] );
   \   000211   ED           MOV     A,R5
   \   000212   F5..         MOV     ?V0 + 2,A
   \   000214   75..00       MOV     ?V0 + 3,#0x0
   \   000217   E5..         MOV     A,?V0 + 2
   \   000219   75F002       MOV     B,#0x2
   \   00021C   A4           MUL     AB
   \   00021D   C5..         XCH     A,?V0 + 2
   \   00021F   AFF0         MOV     R7,B
   \   000221   75F000       MOV     B,#0x0
   \   000224   A4           MUL     AB
   \   000225   2F           ADD     A,R7
   \   000226   FF           MOV     R7,A
   \   000227   75F002       MOV     B,#0x2
   \   00022A   E5..         MOV     A,?V0 + 3
   \   00022C   A4           MUL     AB
   \   00022D   2F           ADD     A,R7
   \   00022E   F5..         MOV     ?V0 + 3,A
   \   000230   85..82       MOV     DPL,?V0 + 0
   \   000233   85..83       MOV     DPH,?V0 + 1
   \   000236   A3           INC     DPTR
   \   000237   A3           INC     DPTR
   \   000238   A3           INC     DPTR
   \   000239   A3           INC     DPTR
   \   00023A   A3           INC     DPTR
   \   00023B   A3           INC     DPTR
   \   00023C   A3           INC     DPTR
   \   00023D   E0           MOVX    A,@DPTR
   \   00023E   25..         ADD     A,?V0 + 2
   \   000240   FF           MOV     R7,A
   \   000241   A3           INC     DPTR
   \   000242   E0           MOVX    A,@DPTR
   \   000243   35..         ADDC    A,?V0 + 3
   \   000245   8F82         MOV     DPL,R7
   \   000247   F583         MOV     DPH,A
   \   000249   E0           MOVX    A,@DPTR
   \   00024A   F5..         MOV     ?V0 + 2,A
   \   00024C   A3           INC     DPTR
   \   00024D   E0           MOVX    A,@DPTR
   \   00024E   F5..         MOV     ?V0 + 3,A
   \   000250   E4           CLR     A
   \   000251   E5..         MOV     A,?V0 + 3
   \   000253   F5..         MOV     ?V0 + 2,A
   \   000255   E5..         MOV     A,?V0 + 2
   \   000257   8882         MOV     DPL,R0
   \   000259   8983         MOV     DPH,R1
   \   00025B   E5..         MOV     A,?V0 + 2
   \   00025D   F0           MOVX    @DPTR,A
   \   00025E   8882         MOV     DPL,R0
   \   000260   8983         MOV     DPH,R1
   \   000262   A3           INC     DPTR
   \   000263   A882         MOV     R0,DPL
   \   000265   A983         MOV     R1,DPH
    865                }
   \   000267   0D           INC     R5
   \                     ??ZDP_SimpleDescMsg_6:
   \   000268   85..82       MOV     DPL,?V0 + 0
   \   00026B   85..83       MOV     DPH,?V0 + 1
   \   00026E   A3           INC     DPTR
   \   00026F   A3           INC     DPTR
   \   000270   A3           INC     DPTR
   \   000271   A3           INC     DPTR
   \   000272   A3           INC     DPTR
   \   000273   A3           INC     DPTR
   \   000274   E0           MOVX    A,@DPTR
   \   000275   FF           MOV     R7,A
   \   000276   ED           MOV     A,R5
   \   000277   C3           CLR     C
   \   000278   9F           SUBB    A,R7
   \   000279   5003         JNC     $+5
   \   00027B   02....       LJMP    ??ZDP_SimpleDescMsg_7 & 0xFFFF
    866              }
    867          
    868              *pBuf++ = pSimpleDesc->AppNumOutClusters;
   \                     ??ZDP_SimpleDescMsg_5:
   \   00027E   85..82       MOV     DPL,?V0 + 0
   \   000281   85..83       MOV     DPH,?V0 + 1
   \   000284   A3           INC     DPTR
   \   000285   A3           INC     DPTR
   \   000286   A3           INC     DPTR
   \   000287   A3           INC     DPTR
   \   000288   A3           INC     DPTR
   \   000289   A3           INC     DPTR
   \   00028A   A3           INC     DPTR
   \   00028B   A3           INC     DPTR
   \   00028C   A3           INC     DPTR
   \   00028D   E0           MOVX    A,@DPTR
   \   00028E   8882         MOV     DPL,R0
   \   000290   8983         MOV     DPH,R1
   \   000292   F0           MOVX    @DPTR,A
   \   000293   8882         MOV     DPL,R0
   \   000295   8983         MOV     DPH,R1
   \   000297   A3           INC     DPTR
   \   000298   A882         MOV     R0,DPL
   \   00029A   A983         MOV     R1,DPH
    869              if ( pSimpleDesc->AppNumOutClusters )
   \   00029C   85..82       MOV     DPL,?V0 + 0
   \   00029F   85..83       MOV     DPH,?V0 + 1
   \   0002A2   A3           INC     DPTR
   \   0002A3   A3           INC     DPTR
   \   0002A4   A3           INC     DPTR
   \   0002A5   A3           INC     DPTR
   \   0002A6   A3           INC     DPTR
   \   0002A7   A3           INC     DPTR
   \   0002A8   A3           INC     DPTR
   \   0002A9   A3           INC     DPTR
   \   0002AA   A3           INC     DPTR
   \   0002AB   E0           MOVX    A,@DPTR
   \   0002AC   7003         JNZ     $+5
   \   0002AE   02....       LJMP    ??ZDP_SimpleDescMsg_8 & 0xFFFF
    870              {
    871                for (i=0; i<pSimpleDesc->AppNumOutClusters; ++i)
   \   0002B1   7D00         MOV     R5,#0x0
   \                     ??ZDP_SimpleDescMsg_9:
   \   0002B3   85..82       MOV     DPL,?V0 + 0
   \   0002B6   85..83       MOV     DPH,?V0 + 1
   \   0002B9   A3           INC     DPTR
   \   0002BA   A3           INC     DPTR
   \   0002BB   A3           INC     DPTR
   \   0002BC   A3           INC     DPTR
   \   0002BD   A3           INC     DPTR
   \   0002BE   A3           INC     DPTR
   \   0002BF   A3           INC     DPTR
   \   0002C0   A3           INC     DPTR
   \   0002C1   A3           INC     DPTR
   \   0002C2   E0           MOVX    A,@DPTR
   \   0002C3   FF           MOV     R7,A
   \   0002C4   ED           MOV     A,R5
   \   0002C5   C3           CLR     C
   \   0002C6   9F           SUBB    A,R7
   \   0002C7   4003         JC      $+5
   \   0002C9   02....       LJMP    ??ZDP_SimpleDescMsg_8 & 0xFFFF
    872                {
    873                  *pBuf++ = LO_UINT16( pSimpleDesc->pAppOutClusterList[i] );
   \   0002CC   ED           MOV     A,R5
   \   0002CD   F5..         MOV     ?V0 + 2,A
   \   0002CF   75..00       MOV     ?V0 + 3,#0x0
   \   0002D2   E5..         MOV     A,?V0 + 2
   \   0002D4   75F002       MOV     B,#0x2
   \   0002D7   A4           MUL     AB
   \   0002D8   C5..         XCH     A,?V0 + 2
   \   0002DA   AFF0         MOV     R7,B
   \   0002DC   75F000       MOV     B,#0x0
   \   0002DF   A4           MUL     AB
   \   0002E0   2F           ADD     A,R7
   \   0002E1   FF           MOV     R7,A
   \   0002E2   75F002       MOV     B,#0x2
   \   0002E5   E5..         MOV     A,?V0 + 3
   \   0002E7   A4           MUL     AB
   \   0002E8   2F           ADD     A,R7
   \   0002E9   F5..         MOV     ?V0 + 3,A
   \   0002EB   85..82       MOV     DPL,?V0 + 0
   \   0002EE   85..83       MOV     DPH,?V0 + 1
   \   0002F1   A3           INC     DPTR
   \   0002F2   A3           INC     DPTR
   \   0002F3   A3           INC     DPTR
   \   0002F4   A3           INC     DPTR
   \   0002F5   A3           INC     DPTR
   \   0002F6   A3           INC     DPTR
   \   0002F7   A3           INC     DPTR
   \   0002F8   A3           INC     DPTR
   \   0002F9   A3           INC     DPTR
   \   0002FA   A3           INC     DPTR
   \   0002FB   E0           MOVX    A,@DPTR
   \   0002FC   25..         ADD     A,?V0 + 2
   \   0002FE   FF           MOV     R7,A
   \   0002FF   A3           INC     DPTR
   \   000300   E0           MOVX    A,@DPTR
   \   000301   35..         ADDC    A,?V0 + 3
   \   000303   8F82         MOV     DPL,R7
   \   000305   F583         MOV     DPH,A
   \   000307   E0           MOVX    A,@DPTR
   \   000308   F5..         MOV     ?V0 + 2,A
   \   00030A   A3           INC     DPTR
   \   00030B   E0           MOVX    A,@DPTR
   \   00030C   F5..         MOV     ?V0 + 3,A
   \   00030E   E5..         MOV     A,?V0 + 2
   \   000310   8882         MOV     DPL,R0
   \   000312   8983         MOV     DPH,R1
   \   000314   E5..         MOV     A,?V0 + 2
   \   000316   F0           MOVX    @DPTR,A
   \   000317   8882         MOV     DPL,R0
   \   000319   8983         MOV     DPH,R1
   \   00031B   A3           INC     DPTR
   \   00031C   A882         MOV     R0,DPL
   \   00031E   A983         MOV     R1,DPH
    874                  *pBuf++ = HI_UINT16( pSimpleDesc->pAppOutClusterList[i] );
   \   000320   ED           MOV     A,R5
   \   000321   F5..         MOV     ?V0 + 2,A
   \   000323   75..00       MOV     ?V0 + 3,#0x0
   \   000326   E5..         MOV     A,?V0 + 2
   \   000328   75F002       MOV     B,#0x2
   \   00032B   A4           MUL     AB
   \   00032C   C5..         XCH     A,?V0 + 2
   \   00032E   AFF0         MOV     R7,B
   \   000330   75F000       MOV     B,#0x0
   \   000333   A4           MUL     AB
   \   000334   2F           ADD     A,R7
   \   000335   FF           MOV     R7,A
   \   000336   75F002       MOV     B,#0x2
   \   000339   E5..         MOV     A,?V0 + 3
   \   00033B   A4           MUL     AB
   \   00033C   2F           ADD     A,R7
   \   00033D   F5..         MOV     ?V0 + 3,A
   \   00033F   85..82       MOV     DPL,?V0 + 0
   \   000342   85..83       MOV     DPH,?V0 + 1
   \   000345   A3           INC     DPTR
   \   000346   A3           INC     DPTR
   \   000347   A3           INC     DPTR
   \   000348   A3           INC     DPTR
   \   000349   A3           INC     DPTR
   \   00034A   A3           INC     DPTR
   \   00034B   A3           INC     DPTR
   \   00034C   A3           INC     DPTR
   \   00034D   A3           INC     DPTR
   \   00034E   A3           INC     DPTR
   \   00034F   E0           MOVX    A,@DPTR
   \   000350   25..         ADD     A,?V0 + 2
   \   000352   FF           MOV     R7,A
   \   000353   A3           INC     DPTR
   \   000354   E0           MOVX    A,@DPTR
   \   000355   35..         ADDC    A,?V0 + 3
   \   000357   8F82         MOV     DPL,R7
   \   000359   F583         MOV     DPH,A
   \   00035B   E0           MOVX    A,@DPTR
   \   00035C   F5..         MOV     ?V0 + 2,A
   \   00035E   A3           INC     DPTR
   \   00035F   E0           MOVX    A,@DPTR
   \   000360   F5..         MOV     ?V0 + 3,A
   \   000362   E4           CLR     A
   \   000363   E5..         MOV     A,?V0 + 3
   \   000365   F5..         MOV     ?V0 + 2,A
   \   000367   E5..         MOV     A,?V0 + 2
   \   000369   8882         MOV     DPL,R0
   \   00036B   8983         MOV     DPH,R1
   \   00036D   E5..         MOV     A,?V0 + 2
   \   00036F   F0           MOVX    @DPTR,A
   \   000370   8882         MOV     DPL,R0
   \   000372   8983         MOV     DPH,R1
   \   000374   A3           INC     DPTR
   \   000375   A882         MOV     R0,DPL
   \   000377   A983         MOV     R1,DPH
    875                }
   \   000379   0D           INC     R5
   \   00037A   02....       LJMP    ??ZDP_SimpleDescMsg_9 & 0xFFFF
    876              }
    877            }
    878          
    879            else
    880            {
    881              *pBuf = 0; // Description Length = 0;
   \                     ??ZDP_SimpleDescMsg_4:
   \   00037D   8882         MOV     DPL,R0
   \   00037F   8983         MOV     DPH,R1
   \   000381   7400         MOV     A,#0x0
   \   000383   F0           MOVX    @DPTR,A
    882            }
    883          
    884            return fillAndSend( &(inMsg->TransSeq), &(inMsg->srcAddr), Simple_Desc_rsp, len );
   \                     ??ZDP_SimpleDescMsg_8:
   \   000384                ; Setup parameters for call to function fillAndSend
   \   000384   75..04       MOV     ?V0 + 0,#0x4
   \   000387   75..80       MOV     ?V0 + 1,#-0x80
   \   00038A   78..         MOV     R0,#?V0 + 0
   \   00038C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00038F   EC           MOV     A,R4
   \   000390   F9           MOV     R1,A
   \   000391   EA           MOV     A,R2
   \   000392   2402         ADD     A,#0x2
   \   000394   FC           MOV     R4,A
   \   000395   EB           MOV     A,R3
   \   000396   3400         ADDC    A,#0x0
   \   000398   FD           MOV     R5,A
   \   000399   EA           MOV     A,R2
   \   00039A   240F         ADD     A,#0xf
   \   00039C   FA           MOV     R2,A
   \   00039D   EB           MOV     A,R3
   \   00039E   3400         ADDC    A,#0x0
   \   0003A0   FB           MOV     R3,A
   \   0003A1   12....       LCALL   ??fillAndSend?relay
   \   0003A4   7402         MOV     A,#0x2
   \   0003A6   12....       LCALL   ?DEALLOC_XSTACK8
   \                     ??ZDP_SimpleDescMsg_3:
   \   0003A9   7F06         MOV     R7,#0x6
   \   0003AB   02....       LJMP    ?BANKED_LEAVE_XDATA
    885          }
    886          
    887          /*********************************************************************
    888           * @fn          ZDP_EPRsp
    889           *
    890           * @brief       This builds and send an endpoint list. Used in
    891           *              Active_EP_rsp and Match_Desc_Rsp
    892           *              message.  This function sends unicast message to the
    893           *              requesting device.
    894           *
    895           * @param       MsgType - either Active_EP_rsp or Match_Desc_Rsp
    896           * @param       dstAddr - destination address
    897           * @param       Status - message status (ZDP_SUCCESS or other)
    898           * @param       nwkAddr - Device's short address that this response describes
    899           * @param       Count - number of endpoint/interfaces in list
    900           * @param       pEPIntfList - Array of Endpoint/Interfaces
    901           * @param       SecurityEnable - Security Options
    902           *
    903           * @return      afStatus_t
    904           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    905          afStatus_t ZDP_EPRsp( uint16 MsgType, byte TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_EPRsp:
    906                                  byte Status, uint16 nwkAddr, byte Count,
    907                                  uint8 *pEPList,
    908                                  byte SecurityEnable )
    909          {
   \   000000   74EE         MOV     A,#-0x12
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 18
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   EA           MOV     A,R2
   \   000013   FE           MOV     R6,A
   \   000014   EB           MOV     A,R3
   \   000015   FF           MOV     R7,A
   \   000016   8C..         MOV     ?V0 + 2,R4
   \   000018   8D..         MOV     ?V0 + 3,R5
   \   00001A   7413         MOV     A,#0x13
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   FC           MOV     R4,A
   \   000021   7414         MOV     A,#0x14
   \   000023   12....       LCALL   ?XSTACK_DISP0_8
   \   000026   E0           MOVX    A,@DPTR
   \   000027   F8           MOV     R0,A
   \   000028   A3           INC     DPTR
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F9           MOV     R1,A
   \   00002B   7416         MOV     A,#0x16
   \   00002D   12....       LCALL   ?XSTACK_DISP0_8
   \   000030   E0           MOVX    A,@DPTR
   \   000031   F5..         MOV     ?V0 + 8,A
   \   000033   7417         MOV     A,#0x17
   \   000035   12....       LCALL   ?XSTACK_DISP0_8
   \   000038   E0           MOVX    A,@DPTR
   \   000039   F5..         MOV     ?V0 + 4,A
   \   00003B   A3           INC     DPTR
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   F5..         MOV     ?V0 + 5,A
    910            uint8 *pBuf = ZDP_TmpBuf;
   \   00003F   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000042   E0           MOVX    A,@DPTR
   \   000043   FA           MOV     R2,A
   \   000044   A3           INC     DPTR
   \   000045   E0           MOVX    A,@DPTR
   \   000046   FB           MOV     R3,A
    911            byte len = 1 + 2 + 1;  // Status + nwkAddr + endpoint/interface count.
   \   000047   75..04       MOV     ?V0 + 0,#0x4
    912            byte txOptions;
    913          
    914            (void)SecurityEnable;  // Intentionally unreferenced parameter
    915          
    916            if ( MsgType == Match_Desc_rsp )
   \   00004A   7406         MOV     A,#0x6
   \   00004C   6E           XRL     A,R6
   \   00004D   7003         JNZ     ??ZDP_EPRsp_0
   \   00004F   7480         MOV     A,#-0x80
   \   000051   6F           XRL     A,R7
   \                     ??ZDP_EPRsp_0:
   \   000052   7005         JNZ     ??ZDP_EPRsp_1
    917              txOptions = AF_MSG_ACK_REQUEST;
   \   000054   75..10       MOV     ?V0 + 1,#0x10
   \   000057   8003         SJMP    ??ZDP_EPRsp_2
    918            else
    919              txOptions = 0;
   \                     ??ZDP_EPRsp_1:
   \   000059   75..00       MOV     ?V0 + 1,#0x0
    920          
    921              *pBuf++ = Status;
   \                     ??ZDP_EPRsp_2:
   \   00005C   EC           MOV     A,R4
   \   00005D   8A82         MOV     DPL,R2
   \   00005F   8B83         MOV     DPH,R3
   \   000061   F0           MOVX    @DPTR,A
   \   000062   8A82         MOV     DPL,R2
   \   000064   8B83         MOV     DPH,R3
   \   000066   A3           INC     DPTR
   \   000067   AA82         MOV     R2,DPL
   \   000069   AB83         MOV     R3,DPH
    922            *pBuf++ = LO_UINT16( nwkAddr );
   \   00006B   E8           MOV     A,R0
   \   00006C   8A82         MOV     DPL,R2
   \   00006E   8B83         MOV     DPH,R3
   \   000070   F0           MOVX    @DPTR,A
   \   000071   8A82         MOV     DPL,R2
   \   000073   8B83         MOV     DPH,R3
   \   000075   A3           INC     DPTR
   \   000076   AA82         MOV     R2,DPL
   \   000078   AB83         MOV     R3,DPH
    923            *pBuf++ = HI_UINT16( nwkAddr );
   \   00007A   E4           CLR     A
   \   00007B   E9           MOV     A,R1
   \   00007C   F8           MOV     R0,A
   \   00007D   8A82         MOV     DPL,R2
   \   00007F   8B83         MOV     DPH,R3
   \   000081   F0           MOVX    @DPTR,A
   \   000082   8A82         MOV     DPL,R2
   \   000084   8B83         MOV     DPH,R3
   \   000086   A3           INC     DPTR
   \   000087   AA82         MOV     R2,DPL
   \   000089   AB83         MOV     R3,DPH
    924          
    925            *pBuf++ = Count;   // Endpoint/Interface count
   \   00008B   E5..         MOV     A,?V0 + 8
   \   00008D   8A82         MOV     DPL,R2
   \   00008F   8B83         MOV     DPH,R3
   \   000091   E5..         MOV     A,?V0 + 8
   \   000093   F0           MOVX    @DPTR,A
   \   000094   8A82         MOV     DPL,R2
   \   000096   8B83         MOV     DPH,R3
   \   000098   A3           INC     DPTR
   \   000099   AA82         MOV     R2,DPL
   \   00009B   AB83         MOV     R3,DPH
    926          
    927            if ( Count )
   \   00009D   E5..         MOV     A,?V0 + 8
   \   00009F   601D         JZ      ??ZDP_EPRsp_3
    928            {
    929              len += Count;
   \   0000A1   E5..         MOV     A,?V0 + 8
   \   0000A3   25..         ADD     A,?V0 + 0
   \   0000A5   F5..         MOV     ?V0 + 0,A
    930              osal_memcpy( pBuf, pEPList, Count );
   \   0000A7                ; Setup parameters for call to function osal_memcpy
   \   0000A7   75..00       MOV     ?V0 + 6,#0x0
   \   0000AA   78..         MOV     R0,#?V0 + 4
   \   0000AC   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000AF   75..00       MOV     ?V0 + 9,#0x0
   \   0000B2   AC..         MOV     R4,?V0 + 8
   \   0000B4   AD..         MOV     R5,?V0 + 9
   \   0000B6   12....       LCALL   ??osal_memcpy?relay
   \   0000B9   7403         MOV     A,#0x3
   \   0000BB   12....       LCALL   ?DEALLOC_XSTACK8
    931            }
    932          
    933            FillAndSendTxOptions( &TransSeq, dstAddr, MsgType, len, txOptions );
   \                     ??ZDP_EPRsp_3:
   \   0000BE   E5..         MOV     A,?V0 + 1
   \   0000C0   90....       MOV     DPTR,#ZDP_TxOptions
   \   0000C3   F0           MOVX    @DPTR,A
   \   0000C4                ; Setup parameters for call to function fillAndSend
   \   0000C4   8E..         MOV     ?V0 + 4,R6
   \   0000C6   8F..         MOV     ?V0 + 5,R7
   \   0000C8   78..         MOV     R0,#?V0 + 4
   \   0000CA   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000CD   A9..         MOV     R1,?V0 + 0
   \   0000CF   AC..         MOV     R4,?V0 + 2
   \   0000D1   AD..         MOV     R5,?V0 + 3
   \   0000D3   7402         MOV     A,#0x2
   \   0000D5   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D8   AA82         MOV     R2,DPL
   \   0000DA   AB83         MOV     R3,DPH
   \   0000DC   12....       LCALL   ??fillAndSend?relay
   \   0000DF   7402         MOV     A,#0x2
   \   0000E1   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000E4   E9           MOV     A,R1
   \   0000E5   F9           MOV     R1,A
   \   0000E6   90....       MOV     DPTR,#ZDP_TxOptions
   \   0000E9   7400         MOV     A,#0x0
   \   0000EB   F0           MOVX    @DPTR,A
   \   0000EC   7401         MOV     A,#0x1
   \   0000EE   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000F1   7F0A         MOV     R7,#0xa
   \   0000F3   02....       LJMP    ?BANKED_LEAVE_XDATA
    934          }
    935          
    936          /*********************************************************************
    937           * @fn          ZDP_UserDescRsp
    938           *
    939           * @brief       Build and send the User Decriptor Response.
    940           *
    941           *
    942           * @param       dstAddr - destination address
    943           * @param       nwkAddrOfInterest -
    944           * @param       userDesc -
    945           * @param       SecurityEnable - Security Options
    946           *
    947           * @return      ZStatus_t
    948           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    949          ZStatus_t ZDP_UserDescRsp( byte TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_UserDescRsp:
    950                          uint16 nwkAddrOfInterest, UserDescriptorFormat_t *userDesc,
    951                          byte SecurityEnable )
    952          {
   \   000000   74EE         MOV     A,#-0x12
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 18
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   EA           MOV     A,R2
   \   000013   FE           MOV     R6,A
   \   000014   EB           MOV     A,R3
   \   000015   FF           MOV     R7,A
   \   000016   7413         MOV     A,#0x13
   \   000018   12....       LCALL   ?XSTACK_DISP0_8
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   F8           MOV     R0,A
   \   00001D   A3           INC     DPTR
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   F9           MOV     R1,A
   \   000020   88..         MOV     ?V0 + 8,R0
   \   000022   89..         MOV     ?V0 + 9,R1
    953            uint8 *pBuf = ZDP_TmpBuf;
   \   000024   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F5..         MOV     ?V0 + 0,A
   \   00002A   A3           INC     DPTR
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   F5..         MOV     ?V0 + 1,A
    954            byte len = 1 + 2 + 1;  // Status + nwkAddr + descriptor length.
   \   00002E   75..04       MOV     ?V0 + 2,#0x4
    955          
    956            (void)SecurityEnable;  // Intentionally unreferenced parameter
    957          
    958            len += userDesc->len;
   \   000031   85..82       MOV     DPL,?V0 + 8
   \   000034   85..83       MOV     DPH,?V0 + 9
   \   000037   E0           MOVX    A,@DPTR
   \   000038   25..         ADD     A,?V0 + 2
   \   00003A   F5..         MOV     ?V0 + 2,A
    959          
    960            *pBuf++ = ZSUCCESS;
   \   00003C   85..82       MOV     DPL,?V0 + 0
   \   00003F   85..83       MOV     DPH,?V0 + 1
   \   000042   7400         MOV     A,#0x0
   \   000044   F0           MOVX    @DPTR,A
   \   000045   85..82       MOV     DPL,?V0 + 0
   \   000048   85..83       MOV     DPH,?V0 + 1
   \   00004B   A3           INC     DPTR
   \   00004C   8582..       MOV     ?V0 + 0,DPL
   \   00004F   8583..       MOV     ?V0 + 1,DPH
    961          
    962            *pBuf++ = LO_UINT16( nwkAddrOfInterest );
   \   000052   EC           MOV     A,R4
   \   000053   85..82       MOV     DPL,?V0 + 0
   \   000056   85..83       MOV     DPH,?V0 + 1
   \   000059   F0           MOVX    @DPTR,A
   \   00005A   85..82       MOV     DPL,?V0 + 0
   \   00005D   85..83       MOV     DPH,?V0 + 1
   \   000060   A3           INC     DPTR
   \   000061   8582..       MOV     ?V0 + 0,DPL
   \   000064   8583..       MOV     ?V0 + 1,DPH
    963            *pBuf++ = HI_UINT16( nwkAddrOfInterest );
   \   000067   E4           CLR     A
   \   000068   ED           MOV     A,R5
   \   000069   FC           MOV     R4,A
   \   00006A   85..82       MOV     DPL,?V0 + 0
   \   00006D   85..83       MOV     DPH,?V0 + 1
   \   000070   F0           MOVX    @DPTR,A
   \   000071   85..82       MOV     DPL,?V0 + 0
   \   000074   85..83       MOV     DPH,?V0 + 1
   \   000077   A3           INC     DPTR
   \   000078   8582..       MOV     ?V0 + 0,DPL
   \   00007B   8583..       MOV     ?V0 + 1,DPH
    964          
    965            *pBuf++ = userDesc->len;
   \   00007E   85..82       MOV     DPL,?V0 + 8
   \   000081   85..83       MOV     DPH,?V0 + 9
   \   000084   E0           MOVX    A,@DPTR
   \   000085   85..82       MOV     DPL,?V0 + 0
   \   000088   85..83       MOV     DPH,?V0 + 1
   \   00008B   F0           MOVX    @DPTR,A
   \   00008C   85..82       MOV     DPL,?V0 + 0
   \   00008F   85..83       MOV     DPH,?V0 + 1
   \   000092   A3           INC     DPTR
   \   000093   8582..       MOV     ?V0 + 0,DPL
   \   000096   8583..       MOV     ?V0 + 1,DPH
    966            osal_memcpy( pBuf, userDesc->desc, userDesc->len );
   \   000099                ; Setup parameters for call to function osal_memcpy
   \   000099   85..82       MOV     DPL,?V0 + 8
   \   00009C   85..83       MOV     DPH,?V0 + 9
   \   00009F   A3           INC     DPTR
   \   0000A0   A982         MOV     R1,DPL
   \   0000A2   AA83         MOV     R2,DPH
   \   0000A4   7B00         MOV     R3,#0x0
   \   0000A6   89..         MOV     ?V0 + 4,R1
   \   0000A8   8A..         MOV     ?V0 + 5,R2
   \   0000AA   8B..         MOV     ?V0 + 6,R3
   \   0000AC   78..         MOV     R0,#?V0 + 4
   \   0000AE   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000B1   85..82       MOV     DPL,?V0 + 8
   \   0000B4   85..83       MOV     DPH,?V0 + 9
   \   0000B7   E0           MOVX    A,@DPTR
   \   0000B8   FC           MOV     R4,A
   \   0000B9   7D00         MOV     R5,#0x0
   \   0000BB   AA..         MOV     R2,?V0 + 0
   \   0000BD   AB..         MOV     R3,?V0 + 1
   \   0000BF   12....       LCALL   ??osal_memcpy?relay
   \   0000C2   7403         MOV     A,#0x3
   \   0000C4   12....       LCALL   ?DEALLOC_XSTACK8
    967          
    968            return (ZStatus_t)fillAndSend( &TransSeq, dstAddr, User_Desc_rsp, len );
   \   0000C7                ; Setup parameters for call to function fillAndSend
   \   0000C7   75..11       MOV     ?V0 + 0,#0x11
   \   0000CA   75..80       MOV     ?V0 + 1,#-0x80
   \   0000CD   78..         MOV     R0,#?V0 + 0
   \   0000CF   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000D2   A9..         MOV     R1,?V0 + 2
   \   0000D4   EE           MOV     A,R6
   \   0000D5   FC           MOV     R4,A
   \   0000D6   EF           MOV     A,R7
   \   0000D7   FD           MOV     R5,A
   \   0000D8   7402         MOV     A,#0x2
   \   0000DA   12....       LCALL   ?XSTACK_DISP0_8
   \   0000DD   AA82         MOV     R2,DPL
   \   0000DF   AB83         MOV     R3,DPH
   \   0000E1   12....       LCALL   ??fillAndSend?relay
   \   0000E4   7402         MOV     A,#0x2
   \   0000E6   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000E9   7401         MOV     A,#0x1
   \   0000EB   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000EE   7F0A         MOV     R7,#0xa
   \   0000F0   02....       LJMP    ?BANKED_LEAVE_XDATA
    969          }
    970          
    971          /*********************************************************************
    972           * @fn          ZDP_ServerDiscRsp
    973           *
    974           * @brief       Build and send the Server_Discovery_rsp response.
    975           *
    976           * @param       transID - Transaction sequence number of request.
    977           * @param       dstAddr - Network Destination Address.
    978           * @param       status - Status of response to request.
    979           * @param       aoi - Network Address of Interest of request.
    980           * @param       serverMask - Bit map of service(s) being sought.
    981           * @param       SecurityEnable - Security Options
    982           *
    983           * @return      ZStatus_t
    984           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    985          ZStatus_t ZDP_ServerDiscRsp( byte transID, zAddrType_t *dstAddr, byte status,
   \                     ZDP_ServerDiscRsp:
    986                                     uint16 aoi, uint16 serverMask, byte SecurityEnable )
    987          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   8C..         MOV     ?V0 + 0,R4
   \   000014   740F         MOV     A,#0xf
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   FC           MOV     R4,A
   \   00001B   A3           INC     DPTR
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   FD           MOV     R5,A
    988            const byte len = 1  + 2;  // status + aoi + mask.
   \   00001E   7903         MOV     R1,#0x3
    989            uint8 *pBuf = ZDP_TmpBuf;
   \   000020   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000023   E0           MOVX    A,@DPTR
   \   000024   FE           MOV     R6,A
   \   000025   A3           INC     DPTR
   \   000026   E0           MOVX    A,@DPTR
   \   000027   FF           MOV     R7,A
    990            ZStatus_t stat;
    991          
    992            // Intentionally unreferenced parameters
    993            (void)aoi;
    994            (void)SecurityEnable;
    995          
    996            *pBuf++ = status;
   \   000028   E5..         MOV     A,?V0 + 0
   \   00002A   8E82         MOV     DPL,R6
   \   00002C   8F83         MOV     DPH,R7
   \   00002E   E5..         MOV     A,?V0 + 0
   \   000030   F0           MOVX    @DPTR,A
   \   000031   8E82         MOV     DPL,R6
   \   000033   8F83         MOV     DPH,R7
   \   000035   A3           INC     DPTR
   \   000036   AE82         MOV     R6,DPL
   \   000038   AF83         MOV     R7,DPH
    997          
    998            *pBuf++ = LO_UINT16( serverMask );
   \   00003A   EC           MOV     A,R4
   \   00003B   8E82         MOV     DPL,R6
   \   00003D   8F83         MOV     DPH,R7
   \   00003F   F0           MOVX    @DPTR,A
   \   000040   8E82         MOV     DPL,R6
   \   000042   8F83         MOV     DPH,R7
   \   000044   A3           INC     DPTR
   \   000045   AE82         MOV     R6,DPL
   \   000047   AF83         MOV     R7,DPH
    999            *pBuf++ = HI_UINT16( serverMask );
   \   000049   E4           CLR     A
   \   00004A   ED           MOV     A,R5
   \   00004B   FC           MOV     R4,A
   \   00004C   8E82         MOV     DPL,R6
   \   00004E   8F83         MOV     DPH,R7
   \   000050   F0           MOVX    @DPTR,A
   \   000051   8E82         MOV     DPL,R6
   \   000053   8F83         MOV     DPH,R7
   \   000055   A3           INC     DPTR
   \   000056   AE82         MOV     R6,DPL
   \   000058   AF83         MOV     R7,DPH
   1000          
   1001            ZDP_TxOptions = AF_MSG_ACK_REQUEST;
   \   00005A   90....       MOV     DPTR,#ZDP_TxOptions
   \   00005D   7410         MOV     A,#0x10
   \   00005F   F0           MOVX    @DPTR,A
   1002            stat = fillAndSend( &transID, dstAddr, Server_Discovery_rsp, len );
   \   000060                ; Setup parameters for call to function fillAndSend
   \   000060   75..15       MOV     ?V0 + 2,#0x15
   \   000063   75..80       MOV     ?V0 + 3,#-0x80
   \   000066   78..         MOV     R0,#?V0 + 2
   \   000068   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00006B   EA           MOV     A,R2
   \   00006C   FC           MOV     R4,A
   \   00006D   EB           MOV     A,R3
   \   00006E   FD           MOV     R5,A
   \   00006F   7402         MOV     A,#0x2
   \   000071   12....       LCALL   ?XSTACK_DISP0_8
   \   000074   AA82         MOV     R2,DPL
   \   000076   AB83         MOV     R3,DPH
   \   000078   12....       LCALL   ??fillAndSend?relay
   \   00007B   7402         MOV     A,#0x2
   \   00007D   12....       LCALL   ?DEALLOC_XSTACK8
   \   000080   E9           MOV     A,R1
   \   000081   F9           MOV     R1,A
   1003            ZDP_TxOptions = AF_TX_OPTIONS_NONE;
   \   000082   90....       MOV     DPTR,#ZDP_TxOptions
   \   000085   7400         MOV     A,#0x0
   \   000087   F0           MOVX    @DPTR,A
   1004          
   1005            return ( stat );
   \   000088   7401         MOV     A,#0x1
   \   00008A   12....       LCALL   ?DEALLOC_XSTACK8
   \   00008D   7F04         MOV     R7,#0x4
   \   00008F   02....       LJMP    ?BANKED_LEAVE_XDATA
   1006          }
   1007          
   1008          /*********************************************************************
   1009           * @fn          ZDP_GenericRsp
   1010           *
   1011           * @brief       Sends a response message with only the parameter status
   1012           *              byte and the addr of interest for data.
   1013           *              This function sends unicast message to the
   1014           *              requesting device.
   1015           *
   1016           * @param       dstAddr - destination address
   1017           * @param       status  - generic status for response
   1018           * @param       aoi     - address of interest
   1019           * @param       dstAddr - destination address
   1020           * @param       rspId   - response cluster ID
   1021           * @param       SecurityEnable - Security Options
   1022           *
   1023           * @return      afStatus_t
   1024           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1025          afStatus_t ZDP_GenericRsp( byte TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_GenericRsp:
   1026                               byte status, uint16 aoi, uint16 rspID, byte SecurityEnable )
   1027          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   EC           MOV     A,R4
   \   000013   FE           MOV     R6,A
   \   000014   740B         MOV     A,#0xb
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F8           MOV     R0,A
   \   00001B   A3           INC     DPTR
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F9           MOV     R1,A
   \   00001E   740D         MOV     A,#0xd
   \   000020   12....       LCALL   ?XSTACK_DISP0_8
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F5..         MOV     ?V0 + 0,A
   \   000026   A3           INC     DPTR
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F5..         MOV     ?V0 + 1,A
   1028            uint8 len;
   1029          
   1030            (void)SecurityEnable;  // Intentionally unreferenced parameter
   1031          
   1032            ZDP_TmpBuf[0] = status;
   \   00002A   EE           MOV     A,R6
   \   00002B   C0E0         PUSH    A
   \   00002D   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000030   E0           MOVX    A,@DPTR
   \   000031   FC           MOV     R4,A
   \   000032   A3           INC     DPTR
   \   000033   E0           MOVX    A,@DPTR
   \   000034   F583         MOV     DPH,A
   \   000036   8C82         MOV     DPL,R4
   \   000038   D0E0         POP     A
   \   00003A   F0           MOVX    @DPTR,A
   1033            ZDP_TmpBuf[1] = LO_UINT16( aoi );
   \   00003B   E8           MOV     A,R0
   \   00003C   C0E0         PUSH    A
   \   00003E   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000041   E0           MOVX    A,@DPTR
   \   000042   FC           MOV     R4,A
   \   000043   A3           INC     DPTR
   \   000044   E0           MOVX    A,@DPTR
   \   000045   F583         MOV     DPH,A
   \   000047   8C82         MOV     DPL,R4
   \   000049   A3           INC     DPTR
   \   00004A   D0E0         POP     A
   \   00004C   F0           MOVX    @DPTR,A
   1034            ZDP_TmpBuf[2] = HI_UINT16( aoi );
   \   00004D   E4           CLR     A
   \   00004E   E9           MOV     A,R1
   \   00004F   F8           MOV     R0,A
   \   000050   C0E0         PUSH    A
   \   000052   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000055   E0           MOVX    A,@DPTR
   \   000056   F8           MOV     R0,A
   \   000057   A3           INC     DPTR
   \   000058   E0           MOVX    A,@DPTR
   \   000059   F583         MOV     DPH,A
   \   00005B   8882         MOV     DPL,R0
   \   00005D   A3           INC     DPTR
   \   00005E   A3           INC     DPTR
   \   00005F   D0E0         POP     A
   \   000061   F0           MOVX    @DPTR,A
   1035          
   1036            // Length byte
   1037            ZDP_TmpBuf[3] = 0;
   \   000062   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000065   E0           MOVX    A,@DPTR
   \   000066   F8           MOV     R0,A
   \   000067   A3           INC     DPTR
   \   000068   E0           MOVX    A,@DPTR
   \   000069   F583         MOV     DPH,A
   \   00006B   8882         MOV     DPL,R0
   \   00006D   A3           INC     DPTR
   \   00006E   A3           INC     DPTR
   \   00006F   A3           INC     DPTR
   \   000070   7400         MOV     A,#0x0
   \   000072   F0           MOVX    @DPTR,A
   1038            len = 4;
   \   000073   7904         MOV     R1,#0x4
   1039          
   1040            return fillAndSend( &TransSeq, dstAddr, rspID, len );
   \   000075                ; Setup parameters for call to function fillAndSend
   \   000075   78..         MOV     R0,#?V0 + 0
   \   000077   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00007A   EA           MOV     A,R2
   \   00007B   FC           MOV     R4,A
   \   00007C   EB           MOV     A,R3
   \   00007D   FD           MOV     R5,A
   \   00007E   7402         MOV     A,#0x2
   \   000080   12....       LCALL   ?XSTACK_DISP0_8
   \   000083   AA82         MOV     R2,DPL
   \   000085   AB83         MOV     R3,DPH
   \   000087   12....       LCALL   ??fillAndSend?relay
   \   00008A   7402         MOV     A,#0x2
   \   00008C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00008F   7401         MOV     A,#0x1
   \   000091   12....       LCALL   ?DEALLOC_XSTACK8
   \   000094   7F02         MOV     R7,#0x2
   \   000096   02....       LJMP    ?BANKED_LEAVE_XDATA
   1041          }
   1042          
   1043          /*********************************************************************
   1044           * Binding
   1045           */
   1046          /*********************************************************************
   1047           * @fn          ZDP_EndDeviceBindReq
   1048           *
   1049           * @brief       This builds and sends a End_Device_Bind_req message.
   1050           *              This function sends a unicast message.
   1051           *
   1052           * @param       dstAddr - destination address
   1053           * @param       LocalCoordinator - short address of local coordinator
   1054           * @param       epIntf - Endpoint/Interface of Simple Desc
   1055           * @param       ProfileID - Profile ID
   1056           *
   1057           *   The Input cluster list is the opposite of what you would think.
   1058           *   This is the output cluster list of this device
   1059           * @param       NumInClusters - number of input clusters
   1060           * @param       InClusterList - input cluster ID list
   1061           *
   1062           *   The Output cluster list is the opposite of what you would think.
   1063           *   This is the input cluster list of this device
   1064           * @param       NumOutClusters - number of output clusters
   1065           * @param       OutClusterList - output cluster ID list
   1066           *
   1067           * @param       SecurityEnable - Security Options
   1068           *
   1069           * @return      afStatus_t
   1070           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1071          afStatus_t ZDP_EndDeviceBindReq( zAddrType_t *dstAddr,
   \                     ZDP_EndDeviceBindReq:
   1072                                           uint16 LocalCoordinator,
   1073                                           byte endPoint,
   1074                                           uint16 ProfileID,
   1075                                           byte NumInClusters, cId_t *InClusterList,
   1076                                           byte NumOutClusters, cId_t *OutClusterList,
   1077                                           byte SecurityEnable )
   1078          {
   \   000000   74E8         MOV     A,#-0x18
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 24
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   EA           MOV     A,R2
   \   000011   F0           MOVX    @DPTR,A
   \   000012   A3           INC     DPTR
   \   000013   EB           MOV     A,R3
   \   000014   F0           MOVX    @DPTR,A
   \   000015   8C..         MOV     ?V0 + 4,R4
   \   000017   8D..         MOV     ?V0 + 5,R5
   \   000019   89..         MOV     ?V0 + 7,R1
   \   00001B   741A         MOV     A,#0x1a
   \   00001D   12....       LCALL   ?XSTACK_DISP0_8
   \   000020   E0           MOVX    A,@DPTR
   \   000021   F5..         MOV     ?V0 + 0,A
   \   000023   A3           INC     DPTR
   \   000024   E0           MOVX    A,@DPTR
   \   000025   F5..         MOV     ?V0 + 1,A
   \   000027   741C         MOV     A,#0x1c
   \   000029   12....       LCALL   ?XSTACK_DISP0_8
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F5..         MOV     ?V0 + 2,A
   \   00002F   741D         MOV     A,#0x1d
   \   000031   12....       LCALL   ?XSTACK_DISP0_8
   \   000034   E0           MOVX    A,@DPTR
   \   000035   F5..         MOV     ?V0 + 14,A
   \   000037   A3           INC     DPTR
   \   000038   E0           MOVX    A,@DPTR
   \   000039   F5..         MOV     ?V0 + 15,A
   \   00003B   741F         MOV     A,#0x1f
   \   00003D   12....       LCALL   ?XSTACK_DISP0_8
   \   000040   E0           MOVX    A,@DPTR
   \   000041   F5..         MOV     ?V0 + 6,A
   \   000043   7420         MOV     A,#0x20
   \   000045   12....       LCALL   ?XSTACK_DISP0_8
   \   000048   E0           MOVX    A,@DPTR
   \   000049   F5..         MOV     ?V0 + 12,A
   \   00004B   A3           INC     DPTR
   \   00004C   E0           MOVX    A,@DPTR
   \   00004D   F5..         MOV     ?V0 + 13,A
   1079            uint8 *pBuf = ZDP_TmpBuf;
   \   00004F   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000052   E0           MOVX    A,@DPTR
   \   000053   FE           MOV     R6,A
   \   000054   A3           INC     DPTR
   \   000055   E0           MOVX    A,@DPTR
   \   000056   FF           MOV     R7,A
   1080            uint8 i, len;
   1081            uint8 *ieeeAddr;
   1082          
   1083            (void)SecurityEnable;  // Intentionally unreferenced parameter
   1084          
   1085            // LocalCoordinator + SrcExtAddr + ep + ProfileID +  NumInClusters + NumOutClusters.
   1086            len = 2 + Z_EXTADDR_LEN + 1 + 2 + 1 + 1;
   \   000057   75..0F       MOV     ?V0 + 3,#0xf
   1087            len += (NumInClusters + NumOutClusters) * sizeof ( uint16 );
   \   00005A   75F002       MOV     B,#0x2
   \   00005D   85....       MOV     ?V0 + 10,?V0 + 2
   \   000060   75..00       MOV     ?V0 + 11,#0x0
   \   000063   85....       MOV     ?V0 + 8,?V0 + 6
   \   000066   75..00       MOV     ?V0 + 9,#0x0
   \   000069   E5..         MOV     A,?V0 + 10
   \   00006B   25..         ADD     A,?V0 + 8
   \   00006D   F8           MOV     R0,A
   \   00006E   E5..         MOV     A,?V0 + 11
   \   000070   35..         ADDC    A,?V0 + 9
   \   000072   F9           MOV     R1,A
   \   000073   E8           MOV     A,R0
   \   000074   A4           MUL     AB
   \   000075   25..         ADD     A,?V0 + 3
   \   000077   F5..         MOV     ?V0 + 3,A
   1088          
   1089            if ( len >= ZDP_BUF_SZ-1 )
   \   000079   E5..         MOV     A,?V0 + 3
   \   00007B   C3           CLR     C
   \   00007C   944F         SUBB    A,#0x4f
   \   00007E   4005         JC      ??ZDP_EndDeviceBindReq_0
   1090            {
   1091              return afStatus_MEM_FAIL;
   \   000080   7910         MOV     R1,#0x10
   \   000082   02....       LJMP    ??ZDP_EndDeviceBindReq_1 & 0xFFFF
   1092            }
   1093          
   1094            if ( LocalCoordinator != NLME_GetShortAddr() )
   \                     ??ZDP_EndDeviceBindReq_0:
   \   000085                ; Setup parameters for call to function NLME_GetShortAddr
   \   000085   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000088   8A..         MOV     ?V0 + 8,R2
   \   00008A   8B..         MOV     ?V0 + 9,R3
   \   00008C   E5..         MOV     A,?V0 + 8
   \   00008E   65..         XRL     A,?V0 + 4
   \   000090   7004         JNZ     ??ZDP_EndDeviceBindReq_2
   \   000092   E5..         MOV     A,?V0 + 9
   \   000094   65..         XRL     A,?V0 + 5
   \                     ??ZDP_EndDeviceBindReq_2:
   \   000096   6005         JZ      ??ZDP_EndDeviceBindReq_3
   1095            {
   1096              return afStatus_INVALID_PARAMETER;
   \   000098   7902         MOV     R1,#0x2
   \   00009A   02....       LJMP    ??ZDP_EndDeviceBindReq_1 & 0xFFFF
   1097            }
   1098          
   1099            *pBuf++ = LO_UINT16( LocalCoordinator );
   \                     ??ZDP_EndDeviceBindReq_3:
   \   00009D   E5..         MOV     A,?V0 + 4
   \   00009F   8E82         MOV     DPL,R6
   \   0000A1   8F83         MOV     DPH,R7
   \   0000A3   E5..         MOV     A,?V0 + 4
   \   0000A5   F0           MOVX    @DPTR,A
   \   0000A6   8E82         MOV     DPL,R6
   \   0000A8   8F83         MOV     DPH,R7
   \   0000AA   A3           INC     DPTR
   \   0000AB   AE82         MOV     R6,DPL
   \   0000AD   AF83         MOV     R7,DPH
   1100            *pBuf++ = HI_UINT16( LocalCoordinator );
   \   0000AF   E4           CLR     A
   \   0000B0   E5..         MOV     A,?V0 + 5
   \   0000B2   F5..         MOV     ?V0 + 4,A
   \   0000B4   E5..         MOV     A,?V0 + 4
   \   0000B6   8E82         MOV     DPL,R6
   \   0000B8   8F83         MOV     DPH,R7
   \   0000BA   E5..         MOV     A,?V0 + 4
   \   0000BC   F0           MOVX    @DPTR,A
   \   0000BD   8E82         MOV     DPL,R6
   \   0000BF   8F83         MOV     DPH,R7
   \   0000C1   A3           INC     DPTR
   \   0000C2   AE82         MOV     R6,DPL
   \   0000C4   AF83         MOV     R7,DPH
   1101          
   1102            ieeeAddr = NLME_GetExtAddr();
   \   0000C6                ; Setup parameters for call to function NLME_GetExtAddr
   \   0000C6   12....       LCALL   ??NLME_GetExtAddr?relay
   \   0000C9   8A..         MOV     ?V0 + 4,R2
   \   0000CB   8B..         MOV     ?V0 + 5,R3
   \   0000CD   AC..         MOV     R4,?V0 + 4
   \   0000CF   AD..         MOV     R5,?V0 + 5
   1103            pBuf = osal_cpyExtAddr( pBuf, ieeeAddr );
   \   0000D1                ; Setup parameters for call to function sAddrExtCpy
   \   0000D1   EE           MOV     A,R6
   \   0000D2   FA           MOV     R2,A
   \   0000D3   EF           MOV     A,R7
   \   0000D4   FB           MOV     R3,A
   \   0000D5   12....       LCALL   ??sAddrExtCpy?relay
   \   0000D8   8A..         MOV     ?V0 + 4,R2
   \   0000DA   8B..         MOV     ?V0 + 5,R3
   \   0000DC   AE..         MOV     R6,?V0 + 4
   \   0000DE   AF..         MOV     R7,?V0 + 5
   1104          
   1105            *pBuf++ = endPoint;
   \   0000E0   E5..         MOV     A,?V0 + 7
   \   0000E2   8E82         MOV     DPL,R6
   \   0000E4   8F83         MOV     DPH,R7
   \   0000E6   E5..         MOV     A,?V0 + 7
   \   0000E8   F0           MOVX    @DPTR,A
   \   0000E9   8E82         MOV     DPL,R6
   \   0000EB   8F83         MOV     DPH,R7
   \   0000ED   A3           INC     DPTR
   \   0000EE   AE82         MOV     R6,DPL
   \   0000F0   AF83         MOV     R7,DPH
   1106          
   1107            *pBuf++ = LO_UINT16( ProfileID );   // Profile ID
   \   0000F2   E5..         MOV     A,?V0 + 0
   \   0000F4   8E82         MOV     DPL,R6
   \   0000F6   8F83         MOV     DPH,R7
   \   0000F8   E5..         MOV     A,?V0 + 0
   \   0000FA   F0           MOVX    @DPTR,A
   \   0000FB   8E82         MOV     DPL,R6
   \   0000FD   8F83         MOV     DPH,R7
   \   0000FF   A3           INC     DPTR
   \   000100   AE82         MOV     R6,DPL
   \   000102   AF83         MOV     R7,DPH
   1108            *pBuf++ = HI_UINT16( ProfileID );
   \   000104   E4           CLR     A
   \   000105   E5..         MOV     A,?V0 + 1
   \   000107   F5..         MOV     ?V0 + 0,A
   \   000109   E5..         MOV     A,?V0 + 0
   \   00010B   8E82         MOV     DPL,R6
   \   00010D   8F83         MOV     DPH,R7
   \   00010F   E5..         MOV     A,?V0 + 0
   \   000111   F0           MOVX    @DPTR,A
   \   000112   8E82         MOV     DPL,R6
   \   000114   8F83         MOV     DPH,R7
   \   000116   A3           INC     DPTR
   \   000117   AE82         MOV     R6,DPL
   \   000119   AF83         MOV     R7,DPH
   1109          
   1110            *pBuf++ = NumInClusters; // Input cluster list
   \   00011B   E5..         MOV     A,?V0 + 2
   \   00011D   8E82         MOV     DPL,R6
   \   00011F   8F83         MOV     DPH,R7
   \   000121   E5..         MOV     A,?V0 + 2
   \   000123   F0           MOVX    @DPTR,A
   \   000124   8E82         MOV     DPL,R6
   \   000126   8F83         MOV     DPH,R7
   \   000128   A3           INC     DPTR
   \   000129   AE82         MOV     R6,DPL
   \   00012B   AF83         MOV     R7,DPH
   1111            for ( i = 0; i < NumInClusters; ++i )
   \   00012D   7A00         MOV     R2,#0x0
   \   00012F   8071         SJMP    ??ZDP_EndDeviceBindReq_4
   1112            {
   1113              *pBuf++ = LO_UINT16(InClusterList[i]);
   \                     ??ZDP_EndDeviceBindReq_5:
   \   000131   EA           MOV     A,R2
   \   000132   F8           MOV     R0,A
   \   000133   7900         MOV     R1,#0x0
   \   000135   E8           MOV     A,R0
   \   000136   75F002       MOV     B,#0x2
   \   000139   A4           MUL     AB
   \   00013A   C8           XCH     A,R0
   \   00013B   ABF0         MOV     R3,B
   \   00013D   75F000       MOV     B,#0x0
   \   000140   A4           MUL     AB
   \   000141   2B           ADD     A,R3
   \   000142   FB           MOV     R3,A
   \   000143   75F002       MOV     B,#0x2
   \   000146   E9           MOV     A,R1
   \   000147   A4           MUL     AB
   \   000148   2B           ADD     A,R3
   \   000149   F9           MOV     R1,A
   \   00014A   E5..         MOV     A,?V0 + 14
   \   00014C   28           ADD     A,R0
   \   00014D   F582         MOV     DPL,A
   \   00014F   E5..         MOV     A,?V0 + 15
   \   000151   39           ADDC    A,R1
   \   000152   F583         MOV     DPH,A
   \   000154   E0           MOVX    A,@DPTR
   \   000155   F8           MOV     R0,A
   \   000156   A3           INC     DPTR
   \   000157   E0           MOVX    A,@DPTR
   \   000158   F9           MOV     R1,A
   \   000159   E8           MOV     A,R0
   \   00015A   8E82         MOV     DPL,R6
   \   00015C   8F83         MOV     DPH,R7
   \   00015E   F0           MOVX    @DPTR,A
   \   00015F   8E82         MOV     DPL,R6
   \   000161   8F83         MOV     DPH,R7
   \   000163   A3           INC     DPTR
   \   000164   AE82         MOV     R6,DPL
   \   000166   AF83         MOV     R7,DPH
   1114              *pBuf++ = HI_UINT16(InClusterList[i]);
   \   000168   EA           MOV     A,R2
   \   000169   F8           MOV     R0,A
   \   00016A   7900         MOV     R1,#0x0
   \   00016C   E8           MOV     A,R0
   \   00016D   75F002       MOV     B,#0x2
   \   000170   A4           MUL     AB
   \   000171   C8           XCH     A,R0
   \   000172   ABF0         MOV     R3,B
   \   000174   75F000       MOV     B,#0x0
   \   000177   A4           MUL     AB
   \   000178   2B           ADD     A,R3
   \   000179   FB           MOV     R3,A
   \   00017A   75F002       MOV     B,#0x2
   \   00017D   E9           MOV     A,R1
   \   00017E   A4           MUL     AB
   \   00017F   2B           ADD     A,R3
   \   000180   F9           MOV     R1,A
   \   000181   E5..         MOV     A,?V0 + 14
   \   000183   28           ADD     A,R0
   \   000184   F582         MOV     DPL,A
   \   000186   E5..         MOV     A,?V0 + 15
   \   000188   39           ADDC    A,R1
   \   000189   F583         MOV     DPH,A
   \   00018B   E0           MOVX    A,@DPTR
   \   00018C   F8           MOV     R0,A
   \   00018D   A3           INC     DPTR
   \   00018E   E0           MOVX    A,@DPTR
   \   00018F   F9           MOV     R1,A
   \   000190   E4           CLR     A
   \   000191   E9           MOV     A,R1
   \   000192   F8           MOV     R0,A
   \   000193   8E82         MOV     DPL,R6
   \   000195   8F83         MOV     DPH,R7
   \   000197   F0           MOVX    @DPTR,A
   \   000198   8E82         MOV     DPL,R6
   \   00019A   8F83         MOV     DPH,R7
   \   00019C   A3           INC     DPTR
   \   00019D   AE82         MOV     R6,DPL
   \   00019F   AF83         MOV     R7,DPH
   1115            }
   \   0001A1   0A           INC     R2
   \                     ??ZDP_EndDeviceBindReq_4:
   \   0001A2   EA           MOV     A,R2
   \   0001A3   C3           CLR     C
   \   0001A4   95..         SUBB    A,?V0 + 2
   \   0001A6   4089         JC      ??ZDP_EndDeviceBindReq_5
   1116          
   1117            *pBuf++ = NumOutClusters; // Output cluster list
   \   0001A8   E5..         MOV     A,?V0 + 6
   \   0001AA   8E82         MOV     DPL,R6
   \   0001AC   8F83         MOV     DPH,R7
   \   0001AE   E5..         MOV     A,?V0 + 6
   \   0001B0   F0           MOVX    @DPTR,A
   \   0001B1   8E82         MOV     DPL,R6
   \   0001B3   8F83         MOV     DPH,R7
   \   0001B5   A3           INC     DPTR
   \   0001B6   AE82         MOV     R6,DPL
   \   0001B8   AF83         MOV     R7,DPH
   1118            for ( i = 0; i < NumOutClusters; ++i )
   \   0001BA   7A00         MOV     R2,#0x0
   \   0001BC   8071         SJMP    ??ZDP_EndDeviceBindReq_6
   1119            {
   1120              *pBuf++ = LO_UINT16(OutClusterList[i]);
   \                     ??ZDP_EndDeviceBindReq_7:
   \   0001BE   EA           MOV     A,R2
   \   0001BF   F8           MOV     R0,A
   \   0001C0   7900         MOV     R1,#0x0
   \   0001C2   E8           MOV     A,R0
   \   0001C3   75F002       MOV     B,#0x2
   \   0001C6   A4           MUL     AB
   \   0001C7   C8           XCH     A,R0
   \   0001C8   ABF0         MOV     R3,B
   \   0001CA   75F000       MOV     B,#0x0
   \   0001CD   A4           MUL     AB
   \   0001CE   2B           ADD     A,R3
   \   0001CF   FB           MOV     R3,A
   \   0001D0   75F002       MOV     B,#0x2
   \   0001D3   E9           MOV     A,R1
   \   0001D4   A4           MUL     AB
   \   0001D5   2B           ADD     A,R3
   \   0001D6   F9           MOV     R1,A
   \   0001D7   E5..         MOV     A,?V0 + 12
   \   0001D9   28           ADD     A,R0
   \   0001DA   F582         MOV     DPL,A
   \   0001DC   E5..         MOV     A,?V0 + 13
   \   0001DE   39           ADDC    A,R1
   \   0001DF   F583         MOV     DPH,A
   \   0001E1   E0           MOVX    A,@DPTR
   \   0001E2   F8           MOV     R0,A
   \   0001E3   A3           INC     DPTR
   \   0001E4   E0           MOVX    A,@DPTR
   \   0001E5   F9           MOV     R1,A
   \   0001E6   E8           MOV     A,R0
   \   0001E7   8E82         MOV     DPL,R6
   \   0001E9   8F83         MOV     DPH,R7
   \   0001EB   F0           MOVX    @DPTR,A
   \   0001EC   8E82         MOV     DPL,R6
   \   0001EE   8F83         MOV     DPH,R7
   \   0001F0   A3           INC     DPTR
   \   0001F1   AE82         MOV     R6,DPL
   \   0001F3   AF83         MOV     R7,DPH
   1121              *pBuf++ = HI_UINT16(OutClusterList[i]);
   \   0001F5   EA           MOV     A,R2
   \   0001F6   F8           MOV     R0,A
   \   0001F7   7900         MOV     R1,#0x0
   \   0001F9   E8           MOV     A,R0
   \   0001FA   75F002       MOV     B,#0x2
   \   0001FD   A4           MUL     AB
   \   0001FE   C8           XCH     A,R0
   \   0001FF   ABF0         MOV     R3,B
   \   000201   75F000       MOV     B,#0x0
   \   000204   A4           MUL     AB
   \   000205   2B           ADD     A,R3
   \   000206   FB           MOV     R3,A
   \   000207   75F002       MOV     B,#0x2
   \   00020A   E9           MOV     A,R1
   \   00020B   A4           MUL     AB
   \   00020C   2B           ADD     A,R3
   \   00020D   F9           MOV     R1,A
   \   00020E   E5..         MOV     A,?V0 + 12
   \   000210   28           ADD     A,R0
   \   000211   F582         MOV     DPL,A
   \   000213   E5..         MOV     A,?V0 + 13
   \   000215   39           ADDC    A,R1
   \   000216   F583         MOV     DPH,A
   \   000218   E0           MOVX    A,@DPTR
   \   000219   F8           MOV     R0,A
   \   00021A   A3           INC     DPTR
   \   00021B   E0           MOVX    A,@DPTR
   \   00021C   F9           MOV     R1,A
   \   00021D   E4           CLR     A
   \   00021E   E9           MOV     A,R1
   \   00021F   F8           MOV     R0,A
   \   000220   8E82         MOV     DPL,R6
   \   000222   8F83         MOV     DPH,R7
   \   000224   F0           MOVX    @DPTR,A
   \   000225   8E82         MOV     DPL,R6
   \   000227   8F83         MOV     DPH,R7
   \   000229   A3           INC     DPTR
   \   00022A   AE82         MOV     R6,DPL
   \   00022C   AF83         MOV     R7,DPH
   1122            }
   \   00022E   0A           INC     R2
   \                     ??ZDP_EndDeviceBindReq_6:
   \   00022F   EA           MOV     A,R2
   \   000230   C3           CLR     C
   \   000231   95..         SUBB    A,?V0 + 6
   \   000233   4089         JC      ??ZDP_EndDeviceBindReq_7
   1123          
   1124            return fillAndSend( &ZDP_TransID, dstAddr, End_Device_Bind_req, len );
   \   000235                ; Setup parameters for call to function fillAndSend
   \   000235   75..20       MOV     ?V0 + 0,#0x20
   \   000238   75..00       MOV     ?V0 + 1,#0x0
   \   00023B   78..         MOV     R0,#?V0 + 0
   \   00023D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000240   A9..         MOV     R1,?V0 + 3
   \   000242   7402         MOV     A,#0x2
   \   000244   12....       LCALL   ?XSTACK_DISP0_8
   \   000247   E0           MOVX    A,@DPTR
   \   000248   FC           MOV     R4,A
   \   000249   A3           INC     DPTR
   \   00024A   E0           MOVX    A,@DPTR
   \   00024B   FD           MOV     R5,A
   \   00024C   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   00024E   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   000250   12....       LCALL   ??fillAndSend?relay
   \   000253   7402         MOV     A,#0x2
   \   000255   12....       LCALL   ?DEALLOC_XSTACK8
   \                     ??ZDP_EndDeviceBindReq_1:
   \   000258   7402         MOV     A,#0x2
   \   00025A   12....       LCALL   ?DEALLOC_XSTACK8
   \   00025D   7F10         MOV     R7,#0x10
   \   00025F   02....       LJMP    ?BANKED_LEAVE_XDATA
   1125          }
   1126          
   1127          /*********************************************************************
   1128           * @fn          ZDP_BindUnbindReq
   1129           *
   1130           * @brief       This builds and send a Bind_req or Unbind_req message
   1131           *              Depending on the ClusterID. This function
   1132           *              sends a unicast message to the local coordinator.
   1133           *
   1134           * @param       BindOrUnbind - either Bind_req or Unbind_req
   1135           * @param       dstAddr - destination address of the message
   1136           * @param       SourceAddr - source 64 bit address of the binding
   1137           * @param       SrcEPIntf - Source endpoint/interface
   1138           * @param       ClusterID - Binding cluster ID
   1139           * @param       DestinationAddr - destination 64 bit addr of binding
   1140           * @param       DstEPIntf - destination endpoint/interface
   1141           * @param       SecurityEnable - Security Options
   1142           *
   1143           * @return      afStatus_t
   1144           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1145          afStatus_t ZDP_BindUnbindReq( uint16 BindOrUnbind, zAddrType_t *dstAddr,
   \                     ZDP_BindUnbindReq:
   1146                                        uint8 *SourceAddr, byte SrcEndPoint,
   1147                                        cId_t ClusterID,
   1148                                        zAddrType_t *destinationAddr, byte DstEndPoint,
   1149                                        byte SecurityEnable )
   1150          {
   \   000000   74EC         MOV     A,#-0x14
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 20
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 2,R2
   \   000007   8B..         MOV     ?V0 + 3,R3
   \   000009   8C..         MOV     ?V0 + 8,R4
   \   00000B   8D..         MOV     ?V0 + 9,R5
   \   00000D   89..         MOV     ?V0 + 6,R1
   \   00000F   7414         MOV     A,#0x14
   \   000011   12....       LCALL   ?XSTACK_DISP0_8
   \   000014   E0           MOVX    A,@DPTR
   \   000015   FC           MOV     R4,A
   \   000016   A3           INC     DPTR
   \   000017   E0           MOVX    A,@DPTR
   \   000018   FD           MOV     R5,A
   \   000019   7416         MOV     A,#0x16
   \   00001B   12....       LCALL   ?XSTACK_DISP0_8
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   FE           MOV     R6,A
   \   000020   A3           INC     DPTR
   \   000021   E0           MOVX    A,@DPTR
   \   000022   FF           MOV     R7,A
   \   000023   7418         MOV     A,#0x18
   \   000025   12....       LCALL   ?XSTACK_DISP0_8
   \   000028   E0           MOVX    A,@DPTR
   \   000029   F5..         MOV     ?V0 + 0,A
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F5..         MOV     ?V0 + 1,A
   \   00002F   741A         MOV     A,#0x1a
   \   000031   12....       LCALL   ?XSTACK_DISP0_8
   \   000034   E0           MOVX    A,@DPTR
   \   000035   F5..         MOV     ?V0 + 5,A
   1151            uint8 *pBuf = ZDP_TmpBuf;
   \   000037   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   FA           MOV     R2,A
   \   00003C   A3           INC     DPTR
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   FB           MOV     R3,A
   1152            byte len;
   1153          
   1154            (void)SecurityEnable;  // Intentionally unreferenced parameter
   1155          
   1156            // SourceAddr + SrcEPIntf + ClusterID +  addrMode.
   1157            len = Z_EXTADDR_LEN + 1 + sizeof( cId_t ) + sizeof( uint8 );
   \   00003F   75..0C       MOV     ?V0 + 4,#0xc
   1158            if ( destinationAddr->addrMode == Addr64Bit )
   \   000042   85..82       MOV     DPL,?V0 + 0
   \   000045   85..83       MOV     DPH,?V0 + 1
   \   000048   A3           INC     DPTR
   \   000049   A3           INC     DPTR
   \   00004A   A3           INC     DPTR
   \   00004B   A3           INC     DPTR
   \   00004C   A3           INC     DPTR
   \   00004D   A3           INC     DPTR
   \   00004E   A3           INC     DPTR
   \   00004F   A3           INC     DPTR
   \   000050   E0           MOVX    A,@DPTR
   \   000051   6403         XRL     A,#0x3
   \   000053   7008         JNZ     ??ZDP_BindUnbindReq_0
   1159              len += Z_EXTADDR_LEN + 1;     // +1 for DstEPIntf
   \   000055   7409         MOV     A,#0x9
   \   000057   25..         ADD     A,?V0 + 4
   \   000059   F5..         MOV     ?V0 + 4,A
   \   00005B   8017         SJMP    ??ZDP_BindUnbindReq_1
   1160            else if ( destinationAddr->addrMode == AddrGroup )
   \                     ??ZDP_BindUnbindReq_0:
   \   00005D   85..82       MOV     DPL,?V0 + 0
   \   000060   85..83       MOV     DPH,?V0 + 1
   \   000063   A3           INC     DPTR
   \   000064   A3           INC     DPTR
   \   000065   A3           INC     DPTR
   \   000066   A3           INC     DPTR
   \   000067   A3           INC     DPTR
   \   000068   A3           INC     DPTR
   \   000069   A3           INC     DPTR
   \   00006A   A3           INC     DPTR
   \   00006B   E0           MOVX    A,@DPTR
   \   00006C   6401         XRL     A,#0x1
   \   00006E   7004         JNZ     ??ZDP_BindUnbindReq_1
   1161              len += sizeof ( uint16 );
   \   000070   05..         INC     ?V0 + 4
   \   000072   05..         INC     ?V0 + 4
   1162          
   1163            pBuf = osal_cpyExtAddr( pBuf, SourceAddr );
   \                     ??ZDP_BindUnbindReq_1:
   \   000074                ; Setup parameters for call to function sAddrExtCpy
   \   000074   12....       LCALL   ??sAddrExtCpy?relay
   \   000077   8A..         MOV     ?V0 + 10,R2
   \   000079   8B..         MOV     ?V0 + 11,R3
   \   00007B   AA..         MOV     R2,?V0 + 10
   \   00007D   AB..         MOV     R3,?V0 + 11
   1164            *pBuf++ = SrcEndPoint;
   \   00007F   E5..         MOV     A,?V0 + 6
   \   000081   8A82         MOV     DPL,R2
   \   000083   8B83         MOV     DPH,R3
   \   000085   E5..         MOV     A,?V0 + 6
   \   000087   F0           MOVX    @DPTR,A
   \   000088   8A82         MOV     DPL,R2
   \   00008A   8B83         MOV     DPH,R3
   \   00008C   A3           INC     DPTR
   \   00008D   AA82         MOV     R2,DPL
   \   00008F   AB83         MOV     R3,DPH
   1165          
   1166            *pBuf++ = LO_UINT16( ClusterID );
   \   000091   EE           MOV     A,R6
   \   000092   8A82         MOV     DPL,R2
   \   000094   8B83         MOV     DPH,R3
   \   000096   F0           MOVX    @DPTR,A
   \   000097   8A82         MOV     DPL,R2
   \   000099   8B83         MOV     DPH,R3
   \   00009B   A3           INC     DPTR
   \   00009C   AA82         MOV     R2,DPL
   \   00009E   AB83         MOV     R3,DPH
   1167          
   1168            *pBuf++ = HI_UINT16( ClusterID );
   \   0000A0   E4           CLR     A
   \   0000A1   EF           MOV     A,R7
   \   0000A2   FE           MOV     R6,A
   \   0000A3   8A82         MOV     DPL,R2
   \   0000A5   8B83         MOV     DPH,R3
   \   0000A7   F0           MOVX    @DPTR,A
   \   0000A8   8A82         MOV     DPL,R2
   \   0000AA   8B83         MOV     DPH,R3
   \   0000AC   A3           INC     DPTR
   \   0000AD   AA82         MOV     R2,DPL
   \   0000AF   AB83         MOV     R3,DPH
   1169            *pBuf++ = destinationAddr->addrMode;
   \   0000B1   85..82       MOV     DPL,?V0 + 0
   \   0000B4   85..83       MOV     DPH,?V0 + 1
   \   0000B7   A3           INC     DPTR
   \   0000B8   A3           INC     DPTR
   \   0000B9   A3           INC     DPTR
   \   0000BA   A3           INC     DPTR
   \   0000BB   A3           INC     DPTR
   \   0000BC   A3           INC     DPTR
   \   0000BD   A3           INC     DPTR
   \   0000BE   A3           INC     DPTR
   \   0000BF   E0           MOVX    A,@DPTR
   \   0000C0   8A82         MOV     DPL,R2
   \   0000C2   8B83         MOV     DPH,R3
   \   0000C4   F0           MOVX    @DPTR,A
   \   0000C5   8A82         MOV     DPL,R2
   \   0000C7   8B83         MOV     DPH,R3
   \   0000C9   A3           INC     DPTR
   \   0000CA   AA82         MOV     R2,DPL
   \   0000CC   AB83         MOV     R3,DPH
   1170            if ( destinationAddr->addrMode == Addr64Bit )
   \   0000CE   85..82       MOV     DPL,?V0 + 0
   \   0000D1   85..83       MOV     DPH,?V0 + 1
   \   0000D4   A3           INC     DPTR
   \   0000D5   A3           INC     DPTR
   \   0000D6   A3           INC     DPTR
   \   0000D7   A3           INC     DPTR
   \   0000D8   A3           INC     DPTR
   \   0000D9   A3           INC     DPTR
   \   0000DA   A3           INC     DPTR
   \   0000DB   A3           INC     DPTR
   \   0000DC   E0           MOVX    A,@DPTR
   \   0000DD   6403         XRL     A,#0x3
   \   0000DF   701A         JNZ     ??ZDP_BindUnbindReq_2
   1171            {
   1172              pBuf = osal_cpyExtAddr( pBuf, destinationAddr->addr.extAddr );
   \   0000E1                ; Setup parameters for call to function sAddrExtCpy
   \   0000E1   AC..         MOV     R4,?V0 + 0
   \   0000E3   AD..         MOV     R5,?V0 + 1
   \   0000E5   12....       LCALL   ??sAddrExtCpy?relay
   \   0000E8   8A..         MOV     ?V0 + 0,R2
   \   0000EA   8B..         MOV     ?V0 + 1,R3
   \   0000EC   AA..         MOV     R2,?V0 + 0
   \   0000EE   AB..         MOV     R3,?V0 + 1
   1173              *pBuf = DstEndPoint;
   \   0000F0   E5..         MOV     A,?V0 + 5
   \   0000F2   8A82         MOV     DPL,R2
   \   0000F4   8B83         MOV     DPH,R3
   \   0000F6   E5..         MOV     A,?V0 + 5
   \   0000F8   F0           MOVX    @DPTR,A
   \   0000F9   8049         SJMP    ??ZDP_BindUnbindReq_3
   1174            }
   1175            else if ( destinationAddr->addrMode == AddrGroup )
   \                     ??ZDP_BindUnbindReq_2:
   \   0000FB   85..82       MOV     DPL,?V0 + 0
   \   0000FE   85..83       MOV     DPH,?V0 + 1
   \   000101   A3           INC     DPTR
   \   000102   A3           INC     DPTR
   \   000103   A3           INC     DPTR
   \   000104   A3           INC     DPTR
   \   000105   A3           INC     DPTR
   \   000106   A3           INC     DPTR
   \   000107   A3           INC     DPTR
   \   000108   A3           INC     DPTR
   \   000109   E0           MOVX    A,@DPTR
   \   00010A   6401         XRL     A,#0x1
   \   00010C   7036         JNZ     ??ZDP_BindUnbindReq_3
   1176            {
   1177              *pBuf++ = LO_UINT16( destinationAddr->addr.shortAddr );
   \   00010E   85..82       MOV     DPL,?V0 + 0
   \   000111   85..83       MOV     DPH,?V0 + 1
   \   000114   E0           MOVX    A,@DPTR
   \   000115   F8           MOV     R0,A
   \   000116   A3           INC     DPTR
   \   000117   E0           MOVX    A,@DPTR
   \   000118   F9           MOV     R1,A
   \   000119   E8           MOV     A,R0
   \   00011A   8A82         MOV     DPL,R2
   \   00011C   8B83         MOV     DPH,R3
   \   00011E   F0           MOVX    @DPTR,A
   \   00011F   8A82         MOV     DPL,R2
   \   000121   8B83         MOV     DPH,R3
   \   000123   A3           INC     DPTR
   \   000124   AA82         MOV     R2,DPL
   \   000126   AB83         MOV     R3,DPH
   1178              *pBuf++ = HI_UINT16( destinationAddr->addr.shortAddr );
   \   000128   85..82       MOV     DPL,?V0 + 0
   \   00012B   85..83       MOV     DPH,?V0 + 1
   \   00012E   E0           MOVX    A,@DPTR
   \   00012F   F8           MOV     R0,A
   \   000130   A3           INC     DPTR
   \   000131   E0           MOVX    A,@DPTR
   \   000132   F9           MOV     R1,A
   \   000133   E4           CLR     A
   \   000134   E9           MOV     A,R1
   \   000135   F8           MOV     R0,A
   \   000136   8A82         MOV     DPL,R2
   \   000138   8B83         MOV     DPH,R3
   \   00013A   F0           MOVX    @DPTR,A
   \   00013B   8A82         MOV     DPL,R2
   \   00013D   8B83         MOV     DPH,R3
   \   00013F   A3           INC     DPTR
   \   000140   AA82         MOV     R2,DPL
   \   000142   AB83         MOV     R3,DPH
   1179            }
   1180          
   1181            FillAndSendTxOptions( &ZDP_TransID, dstAddr, BindOrUnbind, len, AF_MSG_ACK_REQUEST );
   \                     ??ZDP_BindUnbindReq_3:
   \   000144   90....       MOV     DPTR,#ZDP_TxOptions
   \   000147   7410         MOV     A,#0x10
   \   000149   F0           MOVX    @DPTR,A
   \   00014A                ; Setup parameters for call to function fillAndSend
   \   00014A   78..         MOV     R0,#?V0 + 2
   \   00014C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00014F   A9..         MOV     R1,?V0 + 4
   \   000151   AC..         MOV     R4,?V0 + 8
   \   000153   AD..         MOV     R5,?V0 + 9
   \   000155   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   000157   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   000159   12....       LCALL   ??fillAndSend?relay
   \   00015C   7402         MOV     A,#0x2
   \   00015E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000161   E9           MOV     A,R1
   \   000162   F9           MOV     R1,A
   \   000163   90....       MOV     DPTR,#ZDP_TxOptions
   \   000166   7400         MOV     A,#0x0
   \   000168   F0           MOVX    @DPTR,A
   \   000169   7F0C         MOV     R7,#0xc
   \   00016B   02....       LJMP    ?BANKED_LEAVE_XDATA
   1182          }
   1183          
   1184          /*********************************************************************
   1185           * Network Management
   1186           */
   1187          
   1188          /*********************************************************************
   1189           * @fn          ZDP_MgmtNwkDiscReq
   1190           *
   1191           * @brief       This builds and send a Mgmt_NWK_Disc_req message. This
   1192           *              function sends a unicast message.
   1193           *
   1194           * @param       dstAddr - destination address of the message
   1195           * @param       ScanChannels - 32 bit address bit map
   1196           * @param       StartIndex - Starting index within the reporting network
   1197           *                           list
   1198           * @param       SecurityEnable - Security Options
   1199           *
   1200           * @return      afStatus_t
   1201           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1202          afStatus_t ZDP_MgmtNwkDiscReq( zAddrType_t *dstAddr,
   \                     ZDP_MgmtNwkDiscReq:
   1203                                         uint32 ScanChannels,
   1204                                         byte ScanDuration,
   1205                                         byte StartIndex,
   1206                                         byte SecurityEnable )
   1207          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   \   000009   89..         MOV     ?V0 + 4,R1
   \   00000B   8C..         MOV     ?V0 + 5,R4
   \   00000D   740F         MOV     A,#0xf
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   78..         MOV     R0,#?V0 + 0
   \   000014   12....       LCALL   ?L_MOV_X
   1208            uint8 *pBuf = ZDP_TmpBuf;
   \   000017   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   FA           MOV     R2,A
   \   00001C   A3           INC     DPTR
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   FB           MOV     R3,A
   1209            byte len = sizeof( uint32 )+1+1;  // ScanChannels + ScanDuration + StartIndex.
   \   00001F   75..06       MOV     ?V0 + 6,#0x6
   1210          
   1211            (void)SecurityEnable;  // Intentionally unreferenced parameter
   1212          
   1213            pBuf = osal_buffer_uint32( pBuf, ScanChannels );
   \   000022                ; Setup parameters for call to function osal_buffer_uint32
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_FOUR
   \   000027   12....       LCALL   ??osal_buffer_uint32?relay
   \   00002A   7404         MOV     A,#0x4
   \   00002C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00002F   8A..         MOV     ?V0 + 0,R2
   \   000031   8B..         MOV     ?V0 + 1,R3
   \   000033   AA..         MOV     R2,?V0 + 0
   \   000035   AB..         MOV     R3,?V0 + 1
   1214          
   1215            *pBuf++ = ScanDuration;
   \   000037   E5..         MOV     A,?V0 + 4
   \   000039   8A82         MOV     DPL,R2
   \   00003B   8B83         MOV     DPH,R3
   \   00003D   E5..         MOV     A,?V0 + 4
   \   00003F   F0           MOVX    @DPTR,A
   \   000040   8A82         MOV     DPL,R2
   \   000042   8B83         MOV     DPH,R3
   \   000044   A3           INC     DPTR
   \   000045   AA82         MOV     R2,DPL
   \   000047   AB83         MOV     R3,DPH
   1216            *pBuf = StartIndex;
   \   000049   E5..         MOV     A,?V0 + 5
   \   00004B   8A82         MOV     DPL,R2
   \   00004D   8B83         MOV     DPH,R3
   \   00004F   E5..         MOV     A,?V0 + 5
   \   000051   F0           MOVX    @DPTR,A
   1217          
   1218            return fillAndSend( &ZDP_TransID, dstAddr, Mgmt_NWK_Disc_req, len );
   \   000052                ; Setup parameters for call to function fillAndSend
   \   000052   75..30       MOV     ?V0 + 0,#0x30
   \   000055   75..00       MOV     ?V0 + 1,#0x0
   \   000058   78..         MOV     R0,#?V0 + 0
   \   00005A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00005D   A9..         MOV     R1,?V0 + 6
   \   00005F   EE           MOV     A,R6
   \   000060   FC           MOV     R4,A
   \   000061   EF           MOV     A,R7
   \   000062   FD           MOV     R5,A
   \   000063   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   000065   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   000067   12....       LCALL   ??fillAndSend?relay
   \   00006A   7402         MOV     A,#0x2
   \   00006C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00006F   7F07         MOV     R7,#0x7
   \   000071   02....       LJMP    ?BANKED_LEAVE_XDATA
   1219          }
   1220          
   1221          /*********************************************************************
   1222           * @fn          ZDP_MgmtDirectJoinReq
   1223           *
   1224           * @brief       This builds and send a Mgmt_Direct_Join_req message. This
   1225           *              function sends a unicast message.
   1226           *
   1227           * @param       dstAddr - destination address of the message
   1228           * @param       deviceAddr - 64 bit IEEE Address
   1229           * @param       SecurityEnable - Security Options
   1230           *
   1231           * @return      afStatus_t
   1232           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1233          afStatus_t ZDP_MgmtDirectJoinReq( zAddrType_t *dstAddr,
   \                     ZDP_MgmtDirectJoinReq:
   1234                                         uint8 *deviceAddr,
   1235                                         byte capInfo,
   1236                                         byte SecurityEnable )
   1237          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   \   000009   89..         MOV     ?V0 + 0,R1
   1238            (void)SecurityEnable;  // Intentionally unreferenced parameter
   1239          
   1240            osal_cpyExtAddr( ZDP_TmpBuf, deviceAddr );
   \   00000B                ; Setup parameters for call to function sAddrExtCpy
   \   00000B   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   FA           MOV     R2,A
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   FB           MOV     R3,A
   \   000013   12....       LCALL   ??sAddrExtCpy?relay
   1241            ZDP_TmpBuf[Z_EXTADDR_LEN] = capInfo;
   \   000016   E5..         MOV     A,?V0 + 0
   \   000018   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   F8           MOV     R0,A
   \   00001D   A3           INC     DPTR
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   F583         MOV     DPH,A
   \   000021   8882         MOV     DPL,R0
   \   000023   A3           INC     DPTR
   \   000024   A3           INC     DPTR
   \   000025   A3           INC     DPTR
   \   000026   A3           INC     DPTR
   \   000027   A3           INC     DPTR
   \   000028   A3           INC     DPTR
   \   000029   A3           INC     DPTR
   \   00002A   A3           INC     DPTR
   \   00002B   E5..         MOV     A,?V0 + 0
   \   00002D   F0           MOVX    @DPTR,A
   1242          
   1243            return fillAndSend( &ZDP_TransID, dstAddr, Mgmt_Direct_Join_req, (Z_EXTADDR_LEN + 1) );
   \   00002E                ; Setup parameters for call to function fillAndSend
   \   00002E   75..35       MOV     ?V0 + 2,#0x35
   \   000031   75..00       MOV     ?V0 + 3,#0x0
   \   000034   78..         MOV     R0,#?V0 + 2
   \   000036   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000039   7909         MOV     R1,#0x9
   \   00003B   EE           MOV     A,R6
   \   00003C   FC           MOV     R4,A
   \   00003D   EF           MOV     A,R7
   \   00003E   FD           MOV     R5,A
   \   00003F   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   000041   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   000043   12....       LCALL   ??fillAndSend?relay
   \   000046   7402         MOV     A,#0x2
   \   000048   12....       LCALL   ?DEALLOC_XSTACK8
   \   00004B   7F04         MOV     R7,#0x4
   \   00004D   02....       LJMP    ?BANKED_LEAVE_XDATA
   1244          }
   1245          
   1246          /*********************************************************************
   1247           * @fn          ZDP_MgmtPermitJoinReq
   1248           *
   1249           * @brief       This builds and send a Mgmt_Permit_Join_req message.
   1250           *
   1251           * @param       dstAddr - destination address of the message
   1252           * @param       duration - Permit duration
   1253           * @param       TcSignificance - Trust Center Significance
   1254           *
   1255           * @return      afStatus_t
   1256           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1257          afStatus_t ZDP_MgmtPermitJoinReq( zAddrType_t *dstAddr, byte duration,
   \                     ZDP_MgmtPermitJoinReq:
   1258                                            byte TcSignificance, byte SecurityEnable )
   1259          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   EC           MOV     A,R4
   \   000008   FF           MOV     R7,A
   1260            (void)SecurityEnable;  // Intentionally unreferenced parameter
   1261          
   1262            // Build buffer
   1263            ZDP_TmpBuf[ZDP_MGMT_PERMIT_JOIN_REQ_DURATION] = duration;
   \   000009   EE           MOV     A,R6
   \   00000A   C0E0         PUSH    A
   \   00000C   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   F8           MOV     R0,A
   \   000011   A3           INC     DPTR
   \   000012   E0           MOVX    A,@DPTR
   \   000013   F583         MOV     DPH,A
   \   000015   8882         MOV     DPL,R0
   \   000017   D0E0         POP     A
   \   000019   F0           MOVX    @DPTR,A
   1264            ZDP_TmpBuf[ZDP_MGMT_PERMIT_JOIN_REQ_TC_SIG]   = TcSignificance;
   \   00001A   EF           MOV     A,R7
   \   00001B   C0E0         PUSH    A
   \   00001D   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000020   E0           MOVX    A,@DPTR
   \   000021   F8           MOV     R0,A
   \   000022   A3           INC     DPTR
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F583         MOV     DPH,A
   \   000026   8882         MOV     DPL,R0
   \   000028   A3           INC     DPTR
   \   000029   D0E0         POP     A
   \   00002B   F0           MOVX    @DPTR,A
   1265          
   1266            // Send the message
   1267            return fillAndSend( &ZDP_TransID, dstAddr, Mgmt_Permit_Join_req,
   1268                                ZDP_MGMT_PERMIT_JOIN_REQ_SIZE );
   \   00002C                ; Setup parameters for call to function fillAndSend
   \   00002C   75..36       MOV     ?V0 + 0,#0x36
   \   00002F   75..00       MOV     ?V0 + 1,#0x0
   \   000032   78..         MOV     R0,#?V0 + 0
   \   000034   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000037   7902         MOV     R1,#0x2
   \   000039   EA           MOV     A,R2
   \   00003A   FC           MOV     R4,A
   \   00003B   EB           MOV     A,R3
   \   00003C   FD           MOV     R5,A
   \   00003D   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   00003F   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   000041   12....       LCALL   ??fillAndSend?relay
   \   000044   7402         MOV     A,#0x2
   \   000046   12....       LCALL   ?DEALLOC_XSTACK8
   \   000049   7F02         MOV     R7,#0x2
   \   00004B   02....       LJMP    ?BANKED_LEAVE_XDATA
   1269          }
   1270          
   1271          /*********************************************************************
   1272           * @fn          ZDP_MgmtLeaveReq
   1273           *
   1274           * @brief       This builds and send a Mgmt_Leave_req message.
   1275           *
   1276           * @param       dstAddr - destination address of the message
   1277           *              IEEEAddr - IEEE adddress of device that is removed
   1278           *              RemoveChildren - set to 1 to remove the children of the
   1279           *                                device as well. 0 otherwise.
   1280           *              Rejoin - set to 1 if the removed device should rejoin
   1281                                   afterwards. 0 otherwise.
   1282           *
   1283           * @return      afStatus_t
   1284           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1285          afStatus_t ZDP_MgmtLeaveReq( zAddrType_t *dstAddr, uint8 *IEEEAddr, uint8 RemoveChildren,
   \                     ZDP_MgmtLeaveReq:
   1286                           uint8 Rejoin, uint8 SecurityEnable )
   1287          
   1288          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   \   000009   89..         MOV     ?V0 + 0,R1
   \   00000B   740C         MOV     A,#0xc
   \   00000D   12....       LCALL   ?XSTACK_DISP0_8
   \   000010   E0           MOVX    A,@DPTR
   \   000011   F5..         MOV     ?V0 + 1,A
   1289            (void)SecurityEnable;  // Intentionally unreferenced parameter
   1290          
   1291            osal_cpyExtAddr( ZDP_TmpBuf, IEEEAddr );
   \   000013                ; Setup parameters for call to function sAddrExtCpy
   \   000013   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000016   E0           MOVX    A,@DPTR
   \   000017   FA           MOV     R2,A
   \   000018   A3           INC     DPTR
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   FB           MOV     R3,A
   \   00001B   12....       LCALL   ??sAddrExtCpy?relay
   1292            ZDP_TmpBuf[Z_EXTADDR_LEN] = 0;
   \   00001E   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000021   E0           MOVX    A,@DPTR
   \   000022   F8           MOV     R0,A
   \   000023   A3           INC     DPTR
   \   000024   E0           MOVX    A,@DPTR
   \   000025   F583         MOV     DPH,A
   \   000027   8882         MOV     DPL,R0
   \   000029   A3           INC     DPTR
   \   00002A   A3           INC     DPTR
   \   00002B   A3           INC     DPTR
   \   00002C   A3           INC     DPTR
   \   00002D   A3           INC     DPTR
   \   00002E   A3           INC     DPTR
   \   00002F   A3           INC     DPTR
   \   000030   A3           INC     DPTR
   \   000031   7400         MOV     A,#0x0
   \   000033   F0           MOVX    @DPTR,A
   1293          
   1294            if ( RemoveChildren == TRUE )
   \   000034   7401         MOV     A,#0x1
   \   000036   65..         XRL     A,?V0 + 0
   \   000038   7017         JNZ     ??ZDP_MgmtLeaveReq_0
   1295            {
   1296              ZDP_TmpBuf[Z_EXTADDR_LEN] |= ZDP_MGMT_LEAVE_REQ_RC;
   \   00003A   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   F8           MOV     R0,A
   \   00003F   A3           INC     DPTR
   \   000040   E0           MOVX    A,@DPTR
   \   000041   F583         MOV     DPH,A
   \   000043   8882         MOV     DPL,R0
   \   000045   A3           INC     DPTR
   \   000046   A3           INC     DPTR
   \   000047   A3           INC     DPTR
   \   000048   A3           INC     DPTR
   \   000049   A3           INC     DPTR
   \   00004A   A3           INC     DPTR
   \   00004B   A3           INC     DPTR
   \   00004C   A3           INC     DPTR
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   D2E6         SETB    0xE0 /* A   */.6
   \   000050   F0           MOVX    @DPTR,A
   1297            }
   1298            if ( Rejoin == TRUE )
   \                     ??ZDP_MgmtLeaveReq_0:
   \   000051   7401         MOV     A,#0x1
   \   000053   65..         XRL     A,?V0 + 1
   \   000055   7017         JNZ     ??ZDP_MgmtLeaveReq_1
   1299            {
   1300              ZDP_TmpBuf[Z_EXTADDR_LEN] |= ZDP_MGMT_LEAVE_REQ_REJOIN;
   \   000057   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   F8           MOV     R0,A
   \   00005C   A3           INC     DPTR
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   F583         MOV     DPH,A
   \   000060   8882         MOV     DPL,R0
   \   000062   A3           INC     DPTR
   \   000063   A3           INC     DPTR
   \   000064   A3           INC     DPTR
   \   000065   A3           INC     DPTR
   \   000066   A3           INC     DPTR
   \   000067   A3           INC     DPTR
   \   000068   A3           INC     DPTR
   \   000069   A3           INC     DPTR
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   D2E7         SETB    0xE0 /* A   */.7
   \   00006D   F0           MOVX    @DPTR,A
   1301            }
   1302          
   1303            return fillAndSend( &ZDP_TransID, dstAddr, Mgmt_Leave_req, (Z_EXTADDR_LEN + 1) );
   \                     ??ZDP_MgmtLeaveReq_1:
   \   00006E                ; Setup parameters for call to function fillAndSend
   \   00006E   75..34       MOV     ?V0 + 2,#0x34
   \   000071   75..00       MOV     ?V0 + 3,#0x0
   \   000074   78..         MOV     R0,#?V0 + 2
   \   000076   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000079   7909         MOV     R1,#0x9
   \   00007B   EE           MOV     A,R6
   \   00007C   FC           MOV     R4,A
   \   00007D   EF           MOV     A,R7
   \   00007E   FD           MOV     R5,A
   \   00007F   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   000081   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   000083   12....       LCALL   ??fillAndSend?relay
   \   000086   7402         MOV     A,#0x2
   \   000088   12....       LCALL   ?DEALLOC_XSTACK8
   \   00008B   7F04         MOV     R7,#0x4
   \   00008D   02....       LJMP    ?BANKED_LEAVE_XDATA
   1304          }
   1305          
   1306          /*********************************************************************
   1307           * @fn          ZDP_MgmtNwkUpdateReq
   1308           *
   1309           * @brief       This builds and send a Mgmt_NWK_Update_req message. This
   1310           *              function sends a unicast or broadcast message.
   1311           *
   1312           * @param       dstAddr - destination address of the message
   1313           * @param       ChannelMask - 32 bit address bit map
   1314           * @param       ScanDuration - length of time to spend scanning each channel
   1315           * @param       ScanCount - number of energy scans to be conducted
   1316           * @param       NwkUpdateId - NWk Update Id value
   1317           * @param       NwkManagerAddr - NWK address for device with Network Manager
   1318           *                               bit set in its Node Descriptor
   1319           *
   1320           * @return      afStatus_t
   1321           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1322          afStatus_t ZDP_MgmtNwkUpdateReq( zAddrType_t *dstAddr,
   \                     ZDP_MgmtNwkUpdateReq:
   1323                                           uint32 ChannelMask,
   1324                                           uint8 ScanDuration,
   1325                                           uint8 ScanCount,
   1326                                           uint8 NwkUpdateId,
   1327                                           uint16 NwkManagerAddr )
   1328          {
   \   000000   74EE         MOV     A,#-0x12
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 18
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 8,R2
   \   000007   8B..         MOV     ?V0 + 9,R3
   \   000009   89..         MOV     ?V0 + 4,R1
   \   00000B   8C..         MOV     ?V0 + 6,R4
   \   00000D   8D..         MOV     ?V0 + 5,R5
   \   00000F   7412         MOV     A,#0x12
   \   000011   12....       LCALL   ?XSTACK_DISP0_8
   \   000014   78..         MOV     R0,#?V0 + 0
   \   000016   12....       LCALL   ?L_MOV_X
   \   000019   7416         MOV     A,#0x16
   \   00001B   12....       LCALL   ?XSTACK_DISP0_8
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   FE           MOV     R6,A
   \   000020   A3           INC     DPTR
   \   000021   E0           MOVX    A,@DPTR
   \   000022   FF           MOV     R7,A
   1329            uint8 *pBuf = ZDP_TmpBuf;
   \   000023   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000026   E0           MOVX    A,@DPTR
   \   000027   FA           MOV     R2,A
   \   000028   A3           INC     DPTR
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   FB           MOV     R3,A
   1330            byte len = sizeof( uint32 ) + 1;  // ChannelMask + ScanDuration
   \   00002B   75..05       MOV     ?V0 + 7,#0x5
   1331          
   1332            pBuf = osal_buffer_uint32( pBuf, ChannelMask );
   \   00002E                ; Setup parameters for call to function osal_buffer_uint32
   \   00002E   78..         MOV     R0,#?V0 + 0
   \   000030   12....       LCALL   ?PUSH_XSTACK_I_FOUR
   \   000033   12....       LCALL   ??osal_buffer_uint32?relay
   \   000036   7404         MOV     A,#0x4
   \   000038   12....       LCALL   ?DEALLOC_XSTACK8
   \   00003B   8A..         MOV     ?V0 + 0,R2
   \   00003D   8B..         MOV     ?V0 + 1,R3
   \   00003F   AA..         MOV     R2,?V0 + 0
   \   000041   AB..         MOV     R3,?V0 + 1
   1333          
   1334            *pBuf++ = ScanDuration;
   \   000043   E5..         MOV     A,?V0 + 4
   \   000045   8A82         MOV     DPL,R2
   \   000047   8B83         MOV     DPH,R3
   \   000049   E5..         MOV     A,?V0 + 4
   \   00004B   F0           MOVX    @DPTR,A
   \   00004C   8A82         MOV     DPL,R2
   \   00004E   8B83         MOV     DPH,R3
   \   000050   A3           INC     DPTR
   \   000051   AA82         MOV     R2,DPL
   \   000053   AB83         MOV     R3,DPH
   1335          
   1336            if ( ScanDuration <= 0x05 )
   \   000055   E5..         MOV     A,?V0 + 4
   \   000057   C3           CLR     C
   \   000058   9406         SUBB    A,#0x6
   \   00005A   5016         JNC     ??ZDP_MgmtNwkUpdateReq_0
   1337            {
   1338              // Request is to scan over channelMask
   1339              len += sizeof( uint8 );
   \   00005C   05..         INC     ?V0 + 7
   1340          
   1341              *pBuf++ = ScanCount;
   \   00005E   E5..         MOV     A,?V0 + 6
   \   000060   8A82         MOV     DPL,R2
   \   000062   8B83         MOV     DPH,R3
   \   000064   E5..         MOV     A,?V0 + 6
   \   000066   F0           MOVX    @DPTR,A
   \   000067   8A82         MOV     DPL,R2
   \   000069   8B83         MOV     DPH,R3
   \   00006B   A3           INC     DPTR
   \   00006C   AA82         MOV     R2,DPL
   \   00006E   AB83         MOV     R3,DPH
   \   000070   804A         SJMP    ??ZDP_MgmtNwkUpdateReq_1
   1342            }
   1343            else if ( ( ScanDuration == 0xFE ) || ( ScanDuration == 0xFF ) )
   \                     ??ZDP_MgmtNwkUpdateReq_0:
   \   000072   74FE         MOV     A,#-0x2
   \   000074   65..         XRL     A,?V0 + 4
   \   000076   6006         JZ      ??ZDP_MgmtNwkUpdateReq_2
   \   000078   74FF         MOV     A,#-0x1
   \   00007A   65..         XRL     A,?V0 + 4
   \   00007C   703E         JNZ     ??ZDP_MgmtNwkUpdateReq_1
   1344            {
   1345              // Request is to change Channel (0xFE) or apsChannelMask and NwkManagerAddr (0xFF)
   1346              len += sizeof( uint8 );
   \                     ??ZDP_MgmtNwkUpdateReq_2:
   \   00007E   05..         INC     ?V0 + 7
   1347          
   1348              *pBuf++ = NwkUpdateId;
   \   000080   E5..         MOV     A,?V0 + 5
   \   000082   8A82         MOV     DPL,R2
   \   000084   8B83         MOV     DPH,R3
   \   000086   E5..         MOV     A,?V0 + 5
   \   000088   F0           MOVX    @DPTR,A
   \   000089   8A82         MOV     DPL,R2
   \   00008B   8B83         MOV     DPH,R3
   \   00008D   A3           INC     DPTR
   \   00008E   AA82         MOV     R2,DPL
   \   000090   AB83         MOV     R3,DPH
   1349          
   1350              if ( ScanDuration == 0xFF )
   \   000092   74FF         MOV     A,#-0x1
   \   000094   65..         XRL     A,?V0 + 4
   \   000096   7024         JNZ     ??ZDP_MgmtNwkUpdateReq_1
   1351              {
   1352                len += sizeof( uint16 );
   \   000098   05..         INC     ?V0 + 7
   \   00009A   05..         INC     ?V0 + 7
   1353          
   1354                *pBuf++  = LO_UINT16( NwkManagerAddr );
   \   00009C   EE           MOV     A,R6
   \   00009D   8A82         MOV     DPL,R2
   \   00009F   8B83         MOV     DPH,R3
   \   0000A1   F0           MOVX    @DPTR,A
   \   0000A2   8A82         MOV     DPL,R2
   \   0000A4   8B83         MOV     DPH,R3
   \   0000A6   A3           INC     DPTR
   \   0000A7   AA82         MOV     R2,DPL
   \   0000A9   AB83         MOV     R3,DPH
   1355                *pBuf++  = HI_UINT16( NwkManagerAddr );
   \   0000AB   E4           CLR     A
   \   0000AC   EF           MOV     A,R7
   \   0000AD   FE           MOV     R6,A
   \   0000AE   8A82         MOV     DPL,R2
   \   0000B0   8B83         MOV     DPH,R3
   \   0000B2   F0           MOVX    @DPTR,A
   \   0000B3   8A82         MOV     DPL,R2
   \   0000B5   8B83         MOV     DPH,R3
   \   0000B7   A3           INC     DPTR
   \   0000B8   AA82         MOV     R2,DPL
   \   0000BA   AB83         MOV     R3,DPH
   1356              }
   1357            }
   1358          
   1359            return fillAndSend( &ZDP_TransID, dstAddr, Mgmt_NWK_Update_req, len );
   \                     ??ZDP_MgmtNwkUpdateReq_1:
   \   0000BC                ; Setup parameters for call to function fillAndSend
   \   0000BC   75..38       MOV     ?V0 + 0,#0x38
   \   0000BF   75..00       MOV     ?V0 + 1,#0x0
   \   0000C2   78..         MOV     R0,#?V0 + 0
   \   0000C4   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000C7   A9..         MOV     R1,?V0 + 7
   \   0000C9   AC..         MOV     R4,?V0 + 8
   \   0000CB   AD..         MOV     R5,?V0 + 9
   \   0000CD   7A..         MOV     R2,#ZDP_TransID & 0xff
   \   0000CF   7B..         MOV     R3,#(ZDP_TransID >> 8) & 0xff
   \   0000D1   12....       LCALL   ??fillAndSend?relay
   \   0000D4   7402         MOV     A,#0x2
   \   0000D6   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000D9   7F0A         MOV     R7,#0xa
   \   0000DB   02....       LJMP    ?BANKED_LEAVE_XDATA
   1360          }
   1361          
   1362          
   1363          /*********************************************************************
   1364           * Network Management Responses
   1365           */
   1366          
   1367          /*********************************************************************
   1368           * @fn          ZDP_MgmtNwkDiscRsp
   1369           *
   1370           * @brief       This builds and send a Mgmt_NWK_Disc_rsp message. This
   1371           *              function sends a unicast message.
   1372           *
   1373           * @param       dstAddr - destination address of the message
   1374           * @param       Status - message status (ZDP_SUCCESS or other)
   1375           * @param       NetworkCount - Total number of networks found
   1376           * @param       StartIndex - Starting index within the reporting network
   1377           *                           list
   1378           * @param       NetworkListCount - number of network lists included
   1379           *                                 in this message
   1380           * @param       NetworkList - List of network descriptors
   1381           * @param       SecurityEnable - Security Options
   1382           *
   1383           * @return      afStatus_t
   1384           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1385          afStatus_t ZDP_MgmtNwkDiscRsp( byte TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_MgmtNwkDiscRsp:
   1386                                      byte Status,
   1387                                      byte NetworkCount,
   1388                                      byte StartIndex,
   1389                                      byte NetworkListCount,
   1390                                      networkDesc_t *NetworkList,
   1391                                      byte SecurityEnable )
   1392          {
   \   000000   74EA         MOV     A,#-0x16
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 22
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   8A..         MOV     ?V0 + 12,R2
   \   000014   8B..         MOV     ?V0 + 13,R3
   \   000016   8C..         MOV     ?V0 + 8,R4
   \   000018   8D..         MOV     ?V0 + 6,R5
   \   00001A   7417         MOV     A,#0x17
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F5..         MOV     ?V0 + 7,A
   \   000022   7418         MOV     A,#0x18
   \   000024   12....       LCALL   ?XSTACK_DISP0_8
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F5..         MOV     ?V0 + 5,A
   \   00002A   7419         MOV     A,#0x19
   \   00002C   12....       LCALL   ?XSTACK_DISP0_8
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F5..         MOV     ?V0 + 2,A
   \   000032   A3           INC     DPTR
   \   000033   E0           MOVX    A,@DPTR
   \   000034   F5..         MOV     ?V0 + 3,A
   1393            uint8 *buf;
   1394            uint8 *pBuf;
   1395            byte len = 1+1+1+1;  // Status + NetworkCount + StartIndex + NetworkCountList.
   \   000036   75..04       MOV     ?V0 + 4,#0x4
   1396            byte idx;
   1397          
   1398            (void)SecurityEnable;  // Intentionally unreferenced parameter
   1399          
   1400            len += (NetworkListCount * ( ZDP_NETWORK_EXTENDED_DISCRIPTOR_SIZE - 2 ));
   \   000039   75F00C       MOV     B,#0xc
   \   00003C   E5..         MOV     A,?V0 + 5
   \   00003E   A4           MUL     AB
   \   00003F   25..         ADD     A,?V0 + 4
   \   000041   F5..         MOV     ?V0 + 4,A
   1401          
   1402            buf = osal_mem_alloc( len+1 );
   \   000043                ; Setup parameters for call to function osal_mem_alloc
   \   000043   85....       MOV     ?V0 + 0,?V0 + 4
   \   000046   75..00       MOV     ?V0 + 1,#0x0
   \   000049   E5..         MOV     A,?V0 + 0
   \   00004B   2401         ADD     A,#0x1
   \   00004D   FA           MOV     R2,A
   \   00004E   E5..         MOV     A,?V0 + 1
   \   000050   3400         ADDC    A,#0x0
   \   000052   FB           MOV     R3,A
   \   000053   12....       LCALL   ??osal_mem_alloc?relay
   \   000056   8A..         MOV     ?V0 + 10,R2
   \   000058   8B..         MOV     ?V0 + 11,R3
   \   00005A   85....       MOV     ?V0 + 0,?V0 + 10
   \   00005D   85....       MOV     ?V0 + 1,?V0 + 11
   1403            if ( buf == NULL )
   \   000060   E5..         MOV     A,?V0 + 0
   \   000062   45..         ORL     A,?V0 + 1
   \   000064   7005         JNZ     ??ZDP_MgmtNwkDiscRsp_0
   1404            {
   1405              return afStatus_MEM_FAIL;
   \   000066   7910         MOV     R1,#0x10
   \   000068   02....       LJMP    ??ZDP_MgmtNwkDiscRsp_1 & 0xFFFF
   1406            }
   1407          
   1408            pBuf = buf+1;
   \                     ??ZDP_MgmtNwkDiscRsp_0:
   \   00006B   85..82       MOV     DPL,?V0 + 0
   \   00006E   85..83       MOV     DPH,?V0 + 1
   \   000071   A3           INC     DPTR
   \   000072   AE82         MOV     R6,DPL
   \   000074   AF83         MOV     R7,DPH
   1409          
   1410            *pBuf++ = Status;
   \   000076   E5..         MOV     A,?V0 + 8
   \   000078   8E82         MOV     DPL,R6
   \   00007A   8F83         MOV     DPH,R7
   \   00007C   E5..         MOV     A,?V0 + 8
   \   00007E   F0           MOVX    @DPTR,A
   \   00007F   8E82         MOV     DPL,R6
   \   000081   8F83         MOV     DPH,R7
   \   000083   A3           INC     DPTR
   \   000084   AE82         MOV     R6,DPL
   \   000086   AF83         MOV     R7,DPH
   1411            *pBuf++ = NetworkCount;
   \   000088   E5..         MOV     A,?V0 + 6
   \   00008A   8E82         MOV     DPL,R6
   \   00008C   8F83         MOV     DPH,R7
   \   00008E   E5..         MOV     A,?V0 + 6
   \   000090   F0           MOVX    @DPTR,A
   \   000091   8E82         MOV     DPL,R6
   \   000093   8F83         MOV     DPH,R7
   \   000095   A3           INC     DPTR
   \   000096   AE82         MOV     R6,DPL
   \   000098   AF83         MOV     R7,DPH
   1412            *pBuf++ = StartIndex;
   \   00009A   E5..         MOV     A,?V0 + 7
   \   00009C   8E82         MOV     DPL,R6
   \   00009E   8F83         MOV     DPH,R7
   \   0000A0   E5..         MOV     A,?V0 + 7
   \   0000A2   F0           MOVX    @DPTR,A
   \   0000A3   8E82         MOV     DPL,R6
   \   0000A5   8F83         MOV     DPH,R7
   \   0000A7   A3           INC     DPTR
   \   0000A8   AE82         MOV     R6,DPL
   \   0000AA   AF83         MOV     R7,DPH
   1413            *pBuf++ = NetworkListCount;
   \   0000AC   E5..         MOV     A,?V0 + 5
   \   0000AE   8E82         MOV     DPL,R6
   \   0000B0   8F83         MOV     DPH,R7
   \   0000B2   E5..         MOV     A,?V0 + 5
   \   0000B4   F0           MOVX    @DPTR,A
   \   0000B5   8E82         MOV     DPL,R6
   \   0000B7   8F83         MOV     DPH,R7
   \   0000B9   A3           INC     DPTR
   \   0000BA   AE82         MOV     R6,DPL
   \   0000BC   AF83         MOV     R7,DPH
   1414          
   1415            for ( idx = 0; idx < NetworkListCount; idx++ )
   \   0000BE   75..00       MOV     ?V0 + 7,#0x0
   \   0000C1   8025         SJMP    ??ZDP_MgmtNwkDiscRsp_2
   1416            {
   1417              osal_cpyExtAddr( pBuf, NetworkList->extendedPANID);
   1418              pBuf += Z_EXTADDR_LEN;
   1419          
   1420              *pBuf++  = NetworkList->logicalChannel;                // LogicalChannel
   1421              *pBuf    = NetworkList->stackProfile;                  // Stack profile
   1422              *pBuf++ |= (byte)(NetworkList->version << 4);          // ZigBee Version
   1423              *pBuf    = BEACON_ORDER_NO_BEACONS;                    // Beacon Order
   1424              *pBuf++ |= (uint8)(BEACON_ORDER_NO_BEACONS << 4);      // Superframe Order
   1425          
   1426              if ( NetworkList->chosenRouter != INVALID_NODE_ADDR )
   1427              {
   1428                *pBuf++ = TRUE;                         // Permit Joining
   1429              }
   1430              else
   1431              {
   1432                *pBuf++ = FALSE;
   \                     ??ZDP_MgmtNwkDiscRsp_3:
   \   0000C3   8E82         MOV     DPL,R6
   \   0000C5   8F83         MOV     DPH,R7
   \   0000C7   7400         MOV     A,#0x0
   \   0000C9   F0           MOVX    @DPTR,A
   \   0000CA   8E82         MOV     DPL,R6
   \   0000CC   8F83         MOV     DPH,R7
   \   0000CE   A3           INC     DPTR
   \   0000CF   AE82         MOV     R6,DPL
   \   0000D1   AF83         MOV     R7,DPH
   1433              }
   1434          
   1435              NetworkList = NetworkList->nextDesc;    // Move to next list entry
   \                     ??ZDP_MgmtNwkDiscRsp_4:
   \   0000D3   E5..         MOV     A,?V0 + 2
   \   0000D5   2414         ADD     A,#0x14
   \   0000D7   F582         MOV     DPL,A
   \   0000D9   E5..         MOV     A,?V0 + 3
   \   0000DB   3400         ADDC    A,#0x0
   \   0000DD   F583         MOV     DPH,A
   \   0000DF   E0           MOVX    A,@DPTR
   \   0000E0   F5..         MOV     ?V0 + 2,A
   \   0000E2   A3           INC     DPTR
   \   0000E3   E0           MOVX    A,@DPTR
   \   0000E4   F5..         MOV     ?V0 + 3,A
   \   0000E6   05..         INC     ?V0 + 7
   \                     ??ZDP_MgmtNwkDiscRsp_2:
   \   0000E8   E5..         MOV     A,?V0 + 7
   \   0000EA   C3           CLR     C
   \   0000EB   95..         SUBB    A,?V0 + 5
   \   0000ED   4003         JC      $+5
   \   0000EF   02....       LJMP    ??ZDP_MgmtNwkDiscRsp_5 & 0xFFFF
   \   0000F2                ; Setup parameters for call to function sAddrExtCpy
   \   0000F2   E5..         MOV     A,?V0 + 2
   \   0000F4   240B         ADD     A,#0xb
   \   0000F6   FC           MOV     R4,A
   \   0000F7   E5..         MOV     A,?V0 + 3
   \   0000F9   3400         ADDC    A,#0x0
   \   0000FB   FD           MOV     R5,A
   \   0000FC   EE           MOV     A,R6
   \   0000FD   FA           MOV     R2,A
   \   0000FE   EF           MOV     A,R7
   \   0000FF   FB           MOV     R3,A
   \   000100   12....       LCALL   ??sAddrExtCpy?relay
   \   000103   EE           MOV     A,R6
   \   000104   2408         ADD     A,#0x8
   \   000106   FE           MOV     R6,A
   \   000107   EF           MOV     A,R7
   \   000108   3400         ADDC    A,#0x0
   \   00010A   FF           MOV     R7,A
   \   00010B   85..82       MOV     DPL,?V0 + 2
   \   00010E   85..83       MOV     DPH,?V0 + 3
   \   000111   A3           INC     DPTR
   \   000112   A3           INC     DPTR
   \   000113   E0           MOVX    A,@DPTR
   \   000114   8E82         MOV     DPL,R6
   \   000116   8F83         MOV     DPH,R7
   \   000118   F0           MOVX    @DPTR,A
   \   000119   8E82         MOV     DPL,R6
   \   00011B   8F83         MOV     DPH,R7
   \   00011D   A3           INC     DPTR
   \   00011E   AE82         MOV     R6,DPL
   \   000120   AF83         MOV     R7,DPH
   \   000122   85..82       MOV     DPL,?V0 + 2
   \   000125   85..83       MOV     DPH,?V0 + 3
   \   000128   A3           INC     DPTR
   \   000129   A3           INC     DPTR
   \   00012A   A3           INC     DPTR
   \   00012B   A3           INC     DPTR
   \   00012C   A3           INC     DPTR
   \   00012D   A3           INC     DPTR
   \   00012E   E0           MOVX    A,@DPTR
   \   00012F   8E82         MOV     DPL,R6
   \   000131   8F83         MOV     DPH,R7
   \   000133   F0           MOVX    @DPTR,A
   \   000134   EE           MOV     A,R6
   \   000135   F8           MOV     R0,A
   \   000136   EF           MOV     A,R7
   \   000137   F9           MOV     R1,A
   \   000138   8882         MOV     DPL,R0
   \   00013A   8983         MOV     DPH,R1
   \   00013C   A3           INC     DPTR
   \   00013D   AE82         MOV     R6,DPL
   \   00013F   AF83         MOV     R7,DPH
   \   000141   85..82       MOV     DPL,?V0 + 2
   \   000144   85..83       MOV     DPH,?V0 + 3
   \   000147   A3           INC     DPTR
   \   000148   A3           INC     DPTR
   \   000149   A3           INC     DPTR
   \   00014A   A3           INC     DPTR
   \   00014B   A3           INC     DPTR
   \   00014C   E0           MOVX    A,@DPTR
   \   00014D   C4           SWAP    A
   \   00014E   54F0         ANL     A,#0xf0
   \   000150   FA           MOV     R2,A
   \   000151   8882         MOV     DPL,R0
   \   000153   8983         MOV     DPH,R1
   \   000155   E0           MOVX    A,@DPTR
   \   000156   4A           ORL     A,R2
   \   000157   F0           MOVX    @DPTR,A
   \   000158   8E82         MOV     DPL,R6
   \   00015A   8F83         MOV     DPH,R7
   \   00015C   740F         MOV     A,#0xf
   \   00015E   F0           MOVX    @DPTR,A
   \   00015F   EE           MOV     A,R6
   \   000160   F8           MOV     R0,A
   \   000161   EF           MOV     A,R7
   \   000162   F9           MOV     R1,A
   \   000163   8882         MOV     DPL,R0
   \   000165   8983         MOV     DPH,R1
   \   000167   A3           INC     DPTR
   \   000168   AE82         MOV     R6,DPL
   \   00016A   AF83         MOV     R7,DPH
   \   00016C   8882         MOV     DPL,R0
   \   00016E   8983         MOV     DPH,R1
   \   000170   E0           MOVX    A,@DPTR
   \   000171   44F0         ORL     A,#0xf0
   \   000173   F0           MOVX    @DPTR,A
   \   000174   85..82       MOV     DPL,?V0 + 2
   \   000177   85..83       MOV     DPH,?V0 + 3
   \   00017A   A3           INC     DPTR
   \   00017B   A3           INC     DPTR
   \   00017C   A3           INC     DPTR
   \   00017D   A3           INC     DPTR
   \   00017E   A3           INC     DPTR
   \   00017F   A3           INC     DPTR
   \   000180   A3           INC     DPTR
   \   000181   E0           MOVX    A,@DPTR
   \   000182   64FE         XRL     A,#0xfe
   \   000184   7004         JNZ     ??ZDP_MgmtNwkDiscRsp_6
   \   000186   A3           INC     DPTR
   \   000187   E0           MOVX    A,@DPTR
   \   000188   64FF         XRL     A,#0xff
   \                     ??ZDP_MgmtNwkDiscRsp_6:
   \   00018A   7003         JNZ     $+5
   \   00018C   02....       LJMP    ??ZDP_MgmtNwkDiscRsp_3 & 0xFFFF
   \   00018F   8E82         MOV     DPL,R6
   \   000191   8F83         MOV     DPH,R7
   \   000193   7401         MOV     A,#0x1
   \   000195   F0           MOVX    @DPTR,A
   \   000196   8E82         MOV     DPL,R6
   \   000198   8F83         MOV     DPH,R7
   \   00019A   A3           INC     DPTR
   \   00019B   AE82         MOV     R6,DPL
   \   00019D   AF83         MOV     R7,DPH
   \   00019F   02....       LJMP    ??ZDP_MgmtNwkDiscRsp_4 & 0xFFFF
   1436            }
   1437          
   1438            FillAndSendBuffer( &TransSeq, dstAddr, Mgmt_NWK_Disc_rsp, len, buf );
   \                     ??ZDP_MgmtNwkDiscRsp_5:
   \   0001A2   85..82       MOV     DPL,?V0 + 0
   \   0001A5   85..83       MOV     DPH,?V0 + 1
   \   0001A8   A3           INC     DPTR
   \   0001A9   A882         MOV     R0,DPL
   \   0001AB   A983         MOV     R1,DPH
   \   0001AD   90....       MOV     DPTR,#ZDP_TmpBuf
   \   0001B0   E8           MOV     A,R0
   \   0001B1   F0           MOVX    @DPTR,A
   \   0001B2   A3           INC     DPTR
   \   0001B3   E9           MOV     A,R1
   \   0001B4   F0           MOVX    @DPTR,A
   \   0001B5                ; Setup parameters for call to function fillAndSend
   \   0001B5   75..30       MOV     ?V0 + 2,#0x30
   \   0001B8   75..80       MOV     ?V0 + 3,#-0x80
   \   0001BB   78..         MOV     R0,#?V0 + 2
   \   0001BD   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001C0   A9..         MOV     R1,?V0 + 4
   \   0001C2   AC..         MOV     R4,?V0 + 12
   \   0001C4   AD..         MOV     R5,?V0 + 13
   \   0001C6   7402         MOV     A,#0x2
   \   0001C8   12....       LCALL   ?XSTACK_DISP0_8
   \   0001CB   AA82         MOV     R2,DPL
   \   0001CD   AB83         MOV     R3,DPH
   \   0001CF   12....       LCALL   ??fillAndSend?relay
   \   0001D2   7402         MOV     A,#0x2
   \   0001D4   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001D7   E9           MOV     A,R1
   \   0001D8   FE           MOV     R6,A
   \   0001D9                ; Setup parameters for call to function osal_mem_free
   \   0001D9   AA..         MOV     R2,?V0 + 0
   \   0001DB   AB..         MOV     R3,?V0 + 1
   \   0001DD   12....       LCALL   ??osal_mem_free?relay
   \   0001E0   90....       MOV     DPTR,#ZDP_TmpBuf
   \   0001E3   74..         MOV     A,#(ZDP_Buf + 1) & 0xff
   \   0001E5   F0           MOVX    @DPTR,A
   \   0001E6   A3           INC     DPTR
   \   0001E7   74..         MOV     A,#((ZDP_Buf + 1) >> 8) & 0xff
   \   0001E9   F0           MOVX    @DPTR,A
   \   0001EA   EE           MOV     A,R6
   \   0001EB   F9           MOV     R1,A
   \                     ??ZDP_MgmtNwkDiscRsp_1:
   \   0001EC   7401         MOV     A,#0x1
   \   0001EE   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001F1   7F0E         MOV     R7,#0xe
   \   0001F3   02....       LJMP    ?BANKED_LEAVE_XDATA
   1439          }
   1440          
   1441          /*********************************************************************
   1442           * @fn          ZDP_MgmtLqiRsp
   1443           *
   1444           * @brief       This builds and send a Mgmt_Lqi_rsp message. This
   1445           *              function sends a unicast message.
   1446           *
   1447           * @param       dstAddr - destination address of the message
   1448           * @param       Status - message status (ZDP_SUCCESS or other)
   1449           * @param       NeighborLqiEntries - Total number of entries found
   1450           * @param       StartIndex - Starting index within the reporting list
   1451           * @param       NeighborLqiCount - number of lists included
   1452           *                                 in this message
   1453           * @param       NeighborLqiList - List of NeighborLqiItems.  This list
   1454           *                is the list to be sent, not the entire list
   1455           * @param       SecurityEnable - true if secure
   1456           *
   1457           * @return      ZStatus_t
   1458           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1459          ZStatus_t ZDP_MgmtLqiRsp( byte TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_MgmtLqiRsp:
   1460                                    byte Status,
   1461                                    byte NeighborLqiEntries,
   1462                                    byte StartIndex,
   1463                                    byte NeighborLqiCount,
   1464                                    ZDP_MgmtLqiItem_t* NeighborList,
   1465                                    byte SecurityEnable )
   1466          {
   \   000000   74EB         MOV     A,#-0x15
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 21
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   8A..         MOV     ?V0 + 10,R2
   \   000014   8B..         MOV     ?V0 + 11,R3
   \   000016   8C..         MOV     ?V0 + 6,R4
   \   000018   8D..         MOV     ?V0 + 12,R5
   \   00001A   7416         MOV     A,#0x16
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F5..         MOV     ?V0 + 4,A
   \   000022   7417         MOV     A,#0x17
   \   000024   12....       LCALL   ?XSTACK_DISP0_8
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F5..         MOV     ?V0 + 5,A
   \   00002A   7418         MOV     A,#0x18
   \   00002C   12....       LCALL   ?XSTACK_DISP0_8
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F5..         MOV     ?V0 + 0,A
   \   000032   A3           INC     DPTR
   \   000033   E0           MOVX    A,@DPTR
   \   000034   F5..         MOV     ?V0 + 1,A
   1467            ZDP_MgmtLqiItem_t* list = NeighborList;
   1468            uint8 *buf, *pBuf;
   1469            byte len, x;
   1470          
   1471            (void)SecurityEnable;  // Intentionally unreferenced parameter
   1472          
   1473            if ( ZSuccess != Status )
   \   000036   E5..         MOV     A,?V0 + 6
   \   000038   6035         JZ      ??ZDP_MgmtLqiRsp_0
   1474            {
   1475              ZDP_TmpBuf[0] = Status;
   \   00003A   E5..         MOV     A,?V0 + 6
   \   00003C   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00003F   E0           MOVX    A,@DPTR
   \   000040   F8           MOV     R0,A
   \   000041   A3           INC     DPTR
   \   000042   E0           MOVX    A,@DPTR
   \   000043   F583         MOV     DPH,A
   \   000045   8882         MOV     DPL,R0
   \   000047   E5..         MOV     A,?V0 + 6
   \   000049   F0           MOVX    @DPTR,A
   1476              return fillAndSend( &TransSeq, dstAddr, Mgmt_Lqi_rsp, 1 );
   \   00004A                ; Setup parameters for call to function fillAndSend
   \   00004A   75..31       MOV     ?V0 + 0,#0x31
   \   00004D   75..80       MOV     ?V0 + 1,#-0x80
   \   000050   78..         MOV     R0,#?V0 + 0
   \   000052   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000055   7901         MOV     R1,#0x1
   \   000057   AC..         MOV     R4,?V0 + 10
   \   000059   AD..         MOV     R5,?V0 + 11
   \   00005B   7402         MOV     A,#0x2
   \   00005D   12....       LCALL   ?XSTACK_DISP0_8
   \   000060   AA82         MOV     R2,DPL
   \   000062   AB83         MOV     R3,DPH
   \   000064   12....       LCALL   ??fillAndSend?relay
   \   000067   7402         MOV     A,#0x2
   \   000069   12....       LCALL   ?DEALLOC_XSTACK8
   \   00006C   02....       LJMP    ??ZDP_MgmtLqiRsp_1 & 0xFFFF
   1477            }
   1478          
   1479            // (Status + NeighborLqiEntries + StartIndex + NeighborLqiCount) +
   1480            //  neighbor LQI data.
   1481            len = (1 + 1 + 1 + 1) + (NeighborLqiCount * ZDP_MGMTLQI_EXTENDED_SIZE);
   \                     ??ZDP_MgmtLqiRsp_0:
   \   00006F   75F016       MOV     B,#0x16
   \   000072   E5..         MOV     A,?V0 + 5
   \   000074   A4           MUL     AB
   \   000075   2404         ADD     A,#0x4
   \   000077   F5..         MOV     ?V0 + 7,A
   1482          
   1483            buf = osal_mem_alloc( len+1 );
   \   000079                ; Setup parameters for call to function osal_mem_alloc
   \   000079   85....       MOV     ?V0 + 2,?V0 + 7
   \   00007C   75..00       MOV     ?V0 + 3,#0x0
   \   00007F   E5..         MOV     A,?V0 + 2
   \   000081   2401         ADD     A,#0x1
   \   000083   FA           MOV     R2,A
   \   000084   E5..         MOV     A,?V0 + 3
   \   000086   3400         ADDC    A,#0x0
   \   000088   FB           MOV     R3,A
   \   000089   12....       LCALL   ??osal_mem_alloc?relay
   \   00008C   8A..         MOV     ?V0 + 8,R2
   \   00008E   8B..         MOV     ?V0 + 9,R3
   \   000090   85....       MOV     ?V0 + 2,?V0 + 8
   \   000093   85....       MOV     ?V0 + 3,?V0 + 9
   1484            if ( buf == NULL )
   \   000096   E5..         MOV     A,?V0 + 2
   \   000098   45..         ORL     A,?V0 + 3
   \   00009A   7005         JNZ     ??ZDP_MgmtLqiRsp_2
   1485            {
   1486              return afStatus_MEM_FAIL;
   \   00009C   7910         MOV     R1,#0x10
   \   00009E   02....       LJMP    ??ZDP_MgmtLqiRsp_1 & 0xFFFF
   1487            }
   1488          
   1489            pBuf = buf+1;
   \                     ??ZDP_MgmtLqiRsp_2:
   \   0000A1   85..82       MOV     DPL,?V0 + 2
   \   0000A4   85..83       MOV     DPH,?V0 + 3
   \   0000A7   A3           INC     DPTR
   \   0000A8   AE82         MOV     R6,DPL
   \   0000AA   AF83         MOV     R7,DPH
   1490          
   1491            *pBuf++ = Status;
   \   0000AC   E5..         MOV     A,?V0 + 6
   \   0000AE   8E82         MOV     DPL,R6
   \   0000B0   8F83         MOV     DPH,R7
   \   0000B2   E5..         MOV     A,?V0 + 6
   \   0000B4   F0           MOVX    @DPTR,A
   \   0000B5   8E82         MOV     DPL,R6
   \   0000B7   8F83         MOV     DPH,R7
   \   0000B9   A3           INC     DPTR
   \   0000BA   AE82         MOV     R6,DPL
   \   0000BC   AF83         MOV     R7,DPH
   1492            *pBuf++ = NeighborLqiEntries;
   \   0000BE   E5..         MOV     A,?V0 + 12
   \   0000C0   8E82         MOV     DPL,R6
   \   0000C2   8F83         MOV     DPH,R7
   \   0000C4   E5..         MOV     A,?V0 + 12
   \   0000C6   F0           MOVX    @DPTR,A
   \   0000C7   8E82         MOV     DPL,R6
   \   0000C9   8F83         MOV     DPH,R7
   \   0000CB   A3           INC     DPTR
   \   0000CC   AE82         MOV     R6,DPL
   \   0000CE   AF83         MOV     R7,DPH
   1493            *pBuf++ = StartIndex;
   \   0000D0   E5..         MOV     A,?V0 + 4
   \   0000D2   8E82         MOV     DPL,R6
   \   0000D4   8F83         MOV     DPH,R7
   \   0000D6   E5..         MOV     A,?V0 + 4
   \   0000D8   F0           MOVX    @DPTR,A
   \   0000D9   8E82         MOV     DPL,R6
   \   0000DB   8F83         MOV     DPH,R7
   \   0000DD   A3           INC     DPTR
   \   0000DE   AE82         MOV     R6,DPL
   \   0000E0   AF83         MOV     R7,DPH
   1494            *pBuf++ = NeighborLqiCount;
   \   0000E2   E5..         MOV     A,?V0 + 5
   \   0000E4   8E82         MOV     DPL,R6
   \   0000E6   8F83         MOV     DPH,R7
   \   0000E8   E5..         MOV     A,?V0 + 5
   \   0000EA   F0           MOVX    @DPTR,A
   \   0000EB   8E82         MOV     DPL,R6
   \   0000ED   8F83         MOV     DPH,R7
   \   0000EF   A3           INC     DPTR
   \   0000F0   AE82         MOV     R6,DPL
   \   0000F2   AF83         MOV     R7,DPH
   1495          
   1496            for ( x = 0; x < NeighborLqiCount; x++ )
   \   0000F4   75..00       MOV     ?V0 + 4,#0x0
   \   0000F7   02....       LJMP    ??ZDP_MgmtLqiRsp_3 & 0xFFFF
   1497            {
   1498              osal_cpyExtAddr( pBuf, list->extPanID);         // Extended PanID
   \                     ??ZDP_MgmtLqiRsp_4:
   \   0000FA                ; Setup parameters for call to function sAddrExtCpy
   \   0000FA   E5..         MOV     A,?V0 + 0
   \   0000FC   2402         ADD     A,#0x2
   \   0000FE   FC           MOV     R4,A
   \   0000FF   E5..         MOV     A,?V0 + 1
   \   000101   3400         ADDC    A,#0x0
   \   000103   FD           MOV     R5,A
   \   000104   EE           MOV     A,R6
   \   000105   FA           MOV     R2,A
   \   000106   EF           MOV     A,R7
   \   000107   FB           MOV     R3,A
   \   000108   12....       LCALL   ??sAddrExtCpy?relay
   1499              pBuf += Z_EXTADDR_LEN;
   \   00010B   EE           MOV     A,R6
   \   00010C   2408         ADD     A,#0x8
   \   00010E   FE           MOV     R6,A
   \   00010F   EF           MOV     A,R7
   \   000110   3400         ADDC    A,#0x0
   \   000112   FF           MOV     R7,A
   1500          
   1501              // EXTADDR
   1502              pBuf = osal_cpyExtAddr( pBuf, list->extAddr );
   \   000113                ; Setup parameters for call to function sAddrExtCpy
   \   000113   E5..         MOV     A,?V0 + 0
   \   000115   240A         ADD     A,#0xa
   \   000117   FC           MOV     R4,A
   \   000118   E5..         MOV     A,?V0 + 1
   \   00011A   3400         ADDC    A,#0x0
   \   00011C   FD           MOV     R5,A
   \   00011D   EE           MOV     A,R6
   \   00011E   FA           MOV     R2,A
   \   00011F   EF           MOV     A,R7
   \   000120   FB           MOV     R3,A
   \   000121   12....       LCALL   ??sAddrExtCpy?relay
   \   000124   8A..         MOV     ?V0 + 8,R2
   \   000126   8B..         MOV     ?V0 + 9,R3
   \   000128   AE..         MOV     R6,?V0 + 8
   \   00012A   AF..         MOV     R7,?V0 + 9
   1503          
   1504              // NWKADDR
   1505              *pBuf++ = LO_UINT16( list->nwkAddr );
   \   00012C   E5..         MOV     A,?V0 + 0
   \   00012E   2412         ADD     A,#0x12
   \   000130   F582         MOV     DPL,A
   \   000132   E5..         MOV     A,?V0 + 1
   \   000134   3400         ADDC    A,#0x0
   \   000136   F583         MOV     DPH,A
   \   000138   E0           MOVX    A,@DPTR
   \   000139   F8           MOV     R0,A
   \   00013A   A3           INC     DPTR
   \   00013B   E0           MOVX    A,@DPTR
   \   00013C   F9           MOV     R1,A
   \   00013D   E8           MOV     A,R0
   \   00013E   8E82         MOV     DPL,R6
   \   000140   8F83         MOV     DPH,R7
   \   000142   F0           MOVX    @DPTR,A
   \   000143   8E82         MOV     DPL,R6
   \   000145   8F83         MOV     DPH,R7
   \   000147   A3           INC     DPTR
   \   000148   AE82         MOV     R6,DPL
   \   00014A   AF83         MOV     R7,DPH
   1506              *pBuf++ = HI_UINT16( list->nwkAddr );
   \   00014C   E5..         MOV     A,?V0 + 0
   \   00014E   2412         ADD     A,#0x12
   \   000150   F582         MOV     DPL,A
   \   000152   E5..         MOV     A,?V0 + 1
   \   000154   3400         ADDC    A,#0x0
   \   000156   F583         MOV     DPH,A
   \   000158   E0           MOVX    A,@DPTR
   \   000159   F8           MOV     R0,A
   \   00015A   A3           INC     DPTR
   \   00015B   E0           MOVX    A,@DPTR
   \   00015C   F9           MOV     R1,A
   \   00015D   E4           CLR     A
   \   00015E   E9           MOV     A,R1
   \   00015F   F8           MOV     R0,A
   \   000160   8E82         MOV     DPL,R6
   \   000162   8F83         MOV     DPH,R7
   \   000164   F0           MOVX    @DPTR,A
   \   000165   8E82         MOV     DPL,R6
   \   000167   8F83         MOV     DPH,R7
   \   000169   A3           INC     DPTR
   \   00016A   AE82         MOV     R6,DPL
   \   00016C   AF83         MOV     R7,DPH
   1507          
   1508              // DEVICETYPE
   1509              *pBuf = list->devType;
   \   00016E   E5..         MOV     A,?V0 + 0
   \   000170   2414         ADD     A,#0x14
   \   000172   F582         MOV     DPL,A
   \   000174   E5..         MOV     A,?V0 + 1
   \   000176   3400         ADDC    A,#0x0
   \   000178   F583         MOV     DPH,A
   \   00017A   E0           MOVX    A,@DPTR
   \   00017B   8E82         MOV     DPL,R6
   \   00017D   8F83         MOV     DPH,R7
   \   00017F   F0           MOVX    @DPTR,A
   1510          
   1511              // RXONIDLE
   1512              *pBuf |= (uint8)(list->rxOnIdle << 2);
   \   000180   E5..         MOV     A,?V0 + 0
   \   000182   2415         ADD     A,#0x15
   \   000184   F582         MOV     DPL,A
   \   000186   E5..         MOV     A,?V0 + 1
   \   000188   3400         ADDC    A,#0x0
   \   00018A   F583         MOV     DPH,A
   \   00018C   E0           MOVX    A,@DPTR
   \   00018D   33           RLC     A
   \   00018E   33           RLC     A
   \   00018F   54FC         ANL     A,#0xfc
   \   000191   F8           MOV     R0,A
   \   000192   8E82         MOV     DPL,R6
   \   000194   8F83         MOV     DPH,R7
   \   000196   E0           MOVX    A,@DPTR
   \   000197   48           ORL     A,R0
   \   000198   F0           MOVX    @DPTR,A
   1513          
   1514              // RELATIONSHIP
   1515              *pBuf++ |= (uint8)(list->relation << 4);
   \   000199   EE           MOV     A,R6
   \   00019A   F8           MOV     R0,A
   \   00019B   EF           MOV     A,R7
   \   00019C   F9           MOV     R1,A
   \   00019D   8882         MOV     DPL,R0
   \   00019F   8983         MOV     DPH,R1
   \   0001A1   A3           INC     DPTR
   \   0001A2   AE82         MOV     R6,DPL
   \   0001A4   AF83         MOV     R7,DPH
   \   0001A6   E5..         MOV     A,?V0 + 0
   \   0001A8   2416         ADD     A,#0x16
   \   0001AA   F582         MOV     DPL,A
   \   0001AC   E5..         MOV     A,?V0 + 1
   \   0001AE   3400         ADDC    A,#0x0
   \   0001B0   F583         MOV     DPH,A
   \   0001B2   E0           MOVX    A,@DPTR
   \   0001B3   C4           SWAP    A
   \   0001B4   54F0         ANL     A,#0xf0
   \   0001B6   FA           MOV     R2,A
   \   0001B7   8882         MOV     DPL,R0
   \   0001B9   8983         MOV     DPH,R1
   \   0001BB   E0           MOVX    A,@DPTR
   \   0001BC   4A           ORL     A,R2
   \   0001BD   F0           MOVX    @DPTR,A
   1516          
   1517              // PERMITJOINING
   1518              *pBuf++ = (uint8)(list->permit);
   \   0001BE   E5..         MOV     A,?V0 + 0
   \   0001C0   2417         ADD     A,#0x17
   \   0001C2   F582         MOV     DPL,A
   \   0001C4   E5..         MOV     A,?V0 + 1
   \   0001C6   3400         ADDC    A,#0x0
   \   0001C8   F583         MOV     DPH,A
   \   0001CA   E0           MOVX    A,@DPTR
   \   0001CB   8E82         MOV     DPL,R6
   \   0001CD   8F83         MOV     DPH,R7
   \   0001CF   F0           MOVX    @DPTR,A
   \   0001D0   8E82         MOV     DPL,R6
   \   0001D2   8F83         MOV     DPH,R7
   \   0001D4   A3           INC     DPTR
   \   0001D5   AE82         MOV     R6,DPL
   \   0001D7   AF83         MOV     R7,DPH
   1519          
   1520              // DEPTH
   1521              *pBuf++ = list->depth;
   \   0001D9   E5..         MOV     A,?V0 + 0
   \   0001DB   2418         ADD     A,#0x18
   \   0001DD   F582         MOV     DPL,A
   \   0001DF   E5..         MOV     A,?V0 + 1
   \   0001E1   3400         ADDC    A,#0x0
   \   0001E3   F583         MOV     DPH,A
   \   0001E5   E0           MOVX    A,@DPTR
   \   0001E6   8E82         MOV     DPL,R6
   \   0001E8   8F83         MOV     DPH,R7
   \   0001EA   F0           MOVX    @DPTR,A
   \   0001EB   8E82         MOV     DPL,R6
   \   0001ED   8F83         MOV     DPH,R7
   \   0001EF   A3           INC     DPTR
   \   0001F0   AE82         MOV     R6,DPL
   \   0001F2   AF83         MOV     R7,DPH
   1522          
   1523              // LQI
   1524              *pBuf++ = list->lqi;
   \   0001F4   E5..         MOV     A,?V0 + 0
   \   0001F6   2419         ADD     A,#0x19
   \   0001F8   F582         MOV     DPL,A
   \   0001FA   E5..         MOV     A,?V0 + 1
   \   0001FC   3400         ADDC    A,#0x0
   \   0001FE   F583         MOV     DPH,A
   \   000200   E0           MOVX    A,@DPTR
   \   000201   8E82         MOV     DPL,R6
   \   000203   8F83         MOV     DPH,R7
   \   000205   F0           MOVX    @DPTR,A
   \   000206   8E82         MOV     DPL,R6
   \   000208   8F83         MOV     DPH,R7
   \   00020A   A3           INC     DPTR
   \   00020B   AE82         MOV     R6,DPL
   \   00020D   AF83         MOV     R7,DPH
   1525          
   1526              list++; // next list entry
   \   00020F   E5..         MOV     A,?V0 + 0
   \   000211   241A         ADD     A,#0x1a
   \   000213   F5..         MOV     ?V0 + 0,A
   \   000215   E5..         MOV     A,?V0 + 1
   \   000217   3400         ADDC    A,#0x0
   \   000219   F5..         MOV     ?V0 + 1,A
   1527            }
   \   00021B   05..         INC     ?V0 + 4
   \                     ??ZDP_MgmtLqiRsp_3:
   \   00021D   E5..         MOV     A,?V0 + 4
   \   00021F   C3           CLR     C
   \   000220   95..         SUBB    A,?V0 + 5
   \   000222   5003         JNC     $+5
   \   000224   02....       LJMP    ??ZDP_MgmtLqiRsp_4 & 0xFFFF
   1528          
   1529            FillAndSendBuffer( &TransSeq, dstAddr, Mgmt_Lqi_rsp, len, buf );
   \   000227   85..82       MOV     DPL,?V0 + 2
   \   00022A   85..83       MOV     DPH,?V0 + 3
   \   00022D   A3           INC     DPTR
   \   00022E   A882         MOV     R0,DPL
   \   000230   A983         MOV     R1,DPH
   \   000232   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000235   E8           MOV     A,R0
   \   000236   F0           MOVX    @DPTR,A
   \   000237   A3           INC     DPTR
   \   000238   E9           MOV     A,R1
   \   000239   F0           MOVX    @DPTR,A
   \   00023A                ; Setup parameters for call to function fillAndSend
   \   00023A   75..31       MOV     ?V0 + 0,#0x31
   \   00023D   75..80       MOV     ?V0 + 1,#-0x80
   \   000240   78..         MOV     R0,#?V0 + 0
   \   000242   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000245   A9..         MOV     R1,?V0 + 7
   \   000247   AC..         MOV     R4,?V0 + 10
   \   000249   AD..         MOV     R5,?V0 + 11
   \   00024B   7402         MOV     A,#0x2
   \   00024D   12....       LCALL   ?XSTACK_DISP0_8
   \   000250   AA82         MOV     R2,DPL
   \   000252   AB83         MOV     R3,DPH
   \   000254   12....       LCALL   ??fillAndSend?relay
   \   000257   7402         MOV     A,#0x2
   \   000259   12....       LCALL   ?DEALLOC_XSTACK8
   \   00025C   E9           MOV     A,R1
   \   00025D   FE           MOV     R6,A
   \   00025E                ; Setup parameters for call to function osal_mem_free
   \   00025E   AA..         MOV     R2,?V0 + 2
   \   000260   AB..         MOV     R3,?V0 + 3
   \   000262   12....       LCALL   ??osal_mem_free?relay
   \   000265   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000268   74..         MOV     A,#(ZDP_Buf + 1) & 0xff
   \   00026A   F0           MOVX    @DPTR,A
   \   00026B   A3           INC     DPTR
   \   00026C   74..         MOV     A,#((ZDP_Buf + 1) >> 8) & 0xff
   \   00026E   F0           MOVX    @DPTR,A
   \   00026F   EE           MOV     A,R6
   \   000270   F9           MOV     R1,A
   \                     ??ZDP_MgmtLqiRsp_1:
   \   000271   7401         MOV     A,#0x1
   \   000273   12....       LCALL   ?DEALLOC_XSTACK8
   \   000276   7F0D         MOV     R7,#0xd
   \   000278   02....       LJMP    ?BANKED_LEAVE_XDATA
   1530          }
   1531          
   1532          /*********************************************************************
   1533           * @fn          ZDP_MgmtRtgRsp
   1534           *
   1535           * @brief       This builds and send a Mgmt_Rtg_rsp message. This
   1536           *              function sends a unicast message.
   1537           *
   1538           * @param       dstAddr - destination address of the message
   1539           * @param       Status - message status (ZDP_SUCCESS or other)
   1540           * @param       RoutingTableEntries - Total number of entries
   1541           * @param       StartIndex - Starting index within the reporting list
   1542           * @param       RoutingTableListCount - number of entries included
   1543           *                                      in this message
   1544           * @param       RoutingTableList - List of Routing Table entries
   1545           * @param       SecurityEnable - true to enable security for this message
   1546           *
   1547           * @return      ZStatus_t
   1548           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1549          ZStatus_t ZDP_MgmtRtgRsp( byte TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_MgmtRtgRsp:
   1550                                      byte Status,
   1551                                      byte RoutingTableEntries,
   1552                                      byte StartIndex,
   1553                                      byte RoutingListCount,
   1554                                      rtgItem_t *RoutingTableList,
   1555                                      byte SecurityEnable )
   1556          {
   \   000000   74ED         MOV     A,#-0x13
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 19
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   8A..         MOV     ?V0 + 2,R2
   \   000014   8B..         MOV     ?V0 + 3,R3
   \   000016   8C..         MOV     ?V0 + 6,R4
   \   000018   8D..         MOV     ?V0 + 0,R5
   \   00001A   7414         MOV     A,#0x14
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F5..         MOV     ?V0 + 7,A
   \   000022   7415         MOV     A,#0x15
   \   000024   12....       LCALL   ?XSTACK_DISP0_8
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F5..         MOV     ?V0 + 1,A
   \   00002A   7416         MOV     A,#0x16
   \   00002C   12....       LCALL   ?XSTACK_DISP0_8
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F5..         MOV     ?V0 + 4,A
   \   000032   A3           INC     DPTR
   \   000033   E0           MOVX    A,@DPTR
   \   000034   F5..         MOV     ?V0 + 5,A
   1557            uint8 *buf;
   1558            uint8 *pBuf;
   1559            // Status + RoutingTableEntries + StartIndex + RoutingListCount.
   1560            byte len = 1 + 1 + 1 + 1;
   \   000036   75..04       MOV     ?V0 + 10,#0x4
   1561            byte x;
   1562          
   1563            (void)SecurityEnable;  // Intentionally unreferenced parameter
   1564          
   1565            // Add an array for Routing List data
   1566            len += (RoutingListCount * ZDP_ROUTINGENTRY_SIZE);
   \   000039   75F005       MOV     B,#0x5
   \   00003C   E5..         MOV     A,?V0 + 1
   \   00003E   A4           MUL     AB
   \   00003F   25..         ADD     A,?V0 + 10
   \   000041   F5..         MOV     ?V0 + 10,A
   1567          
   1568            buf = osal_mem_alloc( (short)(len+1) );
   \   000043                ; Setup parameters for call to function osal_mem_alloc
   \   000043   85....       MOV     ?V0 + 8,?V0 + 10
   \   000046   75..00       MOV     ?V0 + 9,#0x0
   \   000049   E5..         MOV     A,?V0 + 8
   \   00004B   2401         ADD     A,#0x1
   \   00004D   FA           MOV     R2,A
   \   00004E   E5..         MOV     A,?V0 + 9
   \   000050   3400         ADDC    A,#0x0
   \   000052   FB           MOV     R3,A
   \   000053   12....       LCALL   ??osal_mem_alloc?relay
   \   000056   8A..         MOV     ?V0 + 8,R2
   \   000058   8B..         MOV     ?V0 + 9,R3
   \   00005A   AE..         MOV     R6,?V0 + 8
   \   00005C   AF..         MOV     R7,?V0 + 9
   1569            if ( buf == NULL )
   \   00005E   EE           MOV     A,R6
   \   00005F   4F           ORL     A,R7
   \   000060   7005         JNZ     ??ZDP_MgmtRtgRsp_0
   1570            {
   1571              return afStatus_MEM_FAIL;
   \   000062   7910         MOV     R1,#0x10
   \   000064   02....       LJMP    ??ZDP_MgmtRtgRsp_1 & 0xFFFF
   1572            }
   1573          
   1574            pBuf = buf+1;
   \                     ??ZDP_MgmtRtgRsp_0:
   \   000067   8E82         MOV     DPL,R6
   \   000069   8F83         MOV     DPH,R7
   \   00006B   A3           INC     DPTR
   \   00006C   A882         MOV     R0,DPL
   \   00006E   A983         MOV     R1,DPH
   1575          
   1576            *pBuf++ = Status;
   \   000070   E5..         MOV     A,?V0 + 6
   \   000072   8882         MOV     DPL,R0
   \   000074   8983         MOV     DPH,R1
   \   000076   E5..         MOV     A,?V0 + 6
   \   000078   F0           MOVX    @DPTR,A
   \   000079   8882         MOV     DPL,R0
   \   00007B   8983         MOV     DPH,R1
   \   00007D   A3           INC     DPTR
   \   00007E   A882         MOV     R0,DPL
   \   000080   A983         MOV     R1,DPH
   1577            *pBuf++ = RoutingTableEntries;
   \   000082   E5..         MOV     A,?V0 + 0
   \   000084   8882         MOV     DPL,R0
   \   000086   8983         MOV     DPH,R1
   \   000088   E5..         MOV     A,?V0 + 0
   \   00008A   F0           MOVX    @DPTR,A
   \   00008B   8882         MOV     DPL,R0
   \   00008D   8983         MOV     DPH,R1
   \   00008F   A3           INC     DPTR
   \   000090   A882         MOV     R0,DPL
   \   000092   A983         MOV     R1,DPH
   1578            *pBuf++ = StartIndex;
   \   000094   E5..         MOV     A,?V0 + 7
   \   000096   8882         MOV     DPL,R0
   \   000098   8983         MOV     DPH,R1
   \   00009A   E5..         MOV     A,?V0 + 7
   \   00009C   F0           MOVX    @DPTR,A
   \   00009D   8882         MOV     DPL,R0
   \   00009F   8983         MOV     DPH,R1
   \   0000A1   A3           INC     DPTR
   \   0000A2   A882         MOV     R0,DPL
   \   0000A4   A983         MOV     R1,DPH
   1579            *pBuf++ = RoutingListCount;
   \   0000A6   E5..         MOV     A,?V0 + 1
   \   0000A8   8882         MOV     DPL,R0
   \   0000AA   8983         MOV     DPH,R1
   \   0000AC   E5..         MOV     A,?V0 + 1
   \   0000AE   F0           MOVX    @DPTR,A
   \   0000AF   8882         MOV     DPL,R0
   \   0000B1   8983         MOV     DPH,R1
   \   0000B3   A3           INC     DPTR
   \   0000B4   A882         MOV     R0,DPL
   \   0000B6   A983         MOV     R1,DPH
   1580          
   1581            for ( x = 0; x < RoutingListCount; x++ )
   \   0000B8   7C00         MOV     R4,#0x0
   \   0000BA   02....       LJMP    ??ZDP_MgmtRtgRsp_2 & 0xFFFF
   1582            {
   1583              *pBuf++ = LO_UINT16( RoutingTableList->dstAddress );  // Destination Address
   \                     ??ZDP_MgmtRtgRsp_3:
   \   0000BD   85..82       MOV     DPL,?V0 + 4
   \   0000C0   85..83       MOV     DPH,?V0 + 5
   \   0000C3   E0           MOVX    A,@DPTR
   \   0000C4   FA           MOV     R2,A
   \   0000C5   A3           INC     DPTR
   \   0000C6   E0           MOVX    A,@DPTR
   \   0000C7   FB           MOV     R3,A
   \   0000C8   EA           MOV     A,R2
   \   0000C9   8882         MOV     DPL,R0
   \   0000CB   8983         MOV     DPH,R1
   \   0000CD   F0           MOVX    @DPTR,A
   \   0000CE   8882         MOV     DPL,R0
   \   0000D0   8983         MOV     DPH,R1
   \   0000D2   A3           INC     DPTR
   \   0000D3   A882         MOV     R0,DPL
   \   0000D5   A983         MOV     R1,DPH
   1584              *pBuf++ = HI_UINT16( RoutingTableList->dstAddress );
   \   0000D7   85..82       MOV     DPL,?V0 + 4
   \   0000DA   85..83       MOV     DPH,?V0 + 5
   \   0000DD   E0           MOVX    A,@DPTR
   \   0000DE   FA           MOV     R2,A
   \   0000DF   A3           INC     DPTR
   \   0000E0   E0           MOVX    A,@DPTR
   \   0000E1   FB           MOV     R3,A
   \   0000E2   E4           CLR     A
   \   0000E3   EB           MOV     A,R3
   \   0000E4   FA           MOV     R2,A
   \   0000E5   8882         MOV     DPL,R0
   \   0000E7   8983         MOV     DPH,R1
   \   0000E9   F0           MOVX    @DPTR,A
   \   0000EA   8882         MOV     DPL,R0
   \   0000EC   8983         MOV     DPH,R1
   \   0000EE   A3           INC     DPTR
   \   0000EF   A882         MOV     R0,DPL
   \   0000F1   A983         MOV     R1,DPH
   1585              *pBuf++ = RoutingTableList->status;
   \   0000F3   85..82       MOV     DPL,?V0 + 4
   \   0000F6   85..83       MOV     DPH,?V0 + 5
   \   0000F9   A3           INC     DPTR
   \   0000FA   A3           INC     DPTR
   \   0000FB   A3           INC     DPTR
   \   0000FC   A3           INC     DPTR
   \   0000FD   A3           INC     DPTR
   \   0000FE   E0           MOVX    A,@DPTR
   \   0000FF   8882         MOV     DPL,R0
   \   000101   8983         MOV     DPH,R1
   \   000103   F0           MOVX    @DPTR,A
   \   000104   8882         MOV     DPL,R0
   \   000106   8983         MOV     DPH,R1
   \   000108   A3           INC     DPTR
   \   000109   A882         MOV     R0,DPL
   \   00010B   A983         MOV     R1,DPH
   1586              *pBuf++ = LO_UINT16( RoutingTableList->nextHopAddress );  // Next hop
   \   00010D   85..82       MOV     DPL,?V0 + 4
   \   000110   85..83       MOV     DPH,?V0 + 5
   \   000113   A3           INC     DPTR
   \   000114   A3           INC     DPTR
   \   000115   E0           MOVX    A,@DPTR
   \   000116   FA           MOV     R2,A
   \   000117   A3           INC     DPTR
   \   000118   E0           MOVX    A,@DPTR
   \   000119   FB           MOV     R3,A
   \   00011A   EA           MOV     A,R2
   \   00011B   8882         MOV     DPL,R0
   \   00011D   8983         MOV     DPH,R1
   \   00011F   F0           MOVX    @DPTR,A
   \   000120   8882         MOV     DPL,R0
   \   000122   8983         MOV     DPH,R1
   \   000124   A3           INC     DPTR
   \   000125   A882         MOV     R0,DPL
   \   000127   A983         MOV     R1,DPH
   1587              *pBuf++ = HI_UINT16( RoutingTableList->nextHopAddress );
   \   000129   85..82       MOV     DPL,?V0 + 4
   \   00012C   85..83       MOV     DPH,?V0 + 5
   \   00012F   A3           INC     DPTR
   \   000130   A3           INC     DPTR
   \   000131   E0           MOVX    A,@DPTR
   \   000132   FA           MOV     R2,A
   \   000133   A3           INC     DPTR
   \   000134   E0           MOVX    A,@DPTR
   \   000135   FB           MOV     R3,A
   \   000136   E4           CLR     A
   \   000137   EB           MOV     A,R3
   \   000138   FA           MOV     R2,A
   \   000139   8882         MOV     DPL,R0
   \   00013B   8983         MOV     DPH,R1
   \   00013D   F0           MOVX    @DPTR,A
   \   00013E   8882         MOV     DPL,R0
   \   000140   8983         MOV     DPH,R1
   \   000142   A3           INC     DPTR
   \   000143   A882         MOV     R0,DPL
   \   000145   A983         MOV     R1,DPH
   1588              RoutingTableList++;    // Move to next list entry
   \   000147   E5..         MOV     A,?V0 + 4
   \   000149   2407         ADD     A,#0x7
   \   00014B   F5..         MOV     ?V0 + 4,A
   \   00014D   E5..         MOV     A,?V0 + 5
   \   00014F   3400         ADDC    A,#0x0
   \   000151   F5..         MOV     ?V0 + 5,A
   1589            }
   \   000153   0C           INC     R4
   \                     ??ZDP_MgmtRtgRsp_2:
   \   000154   EC           MOV     A,R4
   \   000155   C3           CLR     C
   \   000156   95..         SUBB    A,?V0 + 1
   \   000158   5003         JNC     $+5
   \   00015A   02....       LJMP    ??ZDP_MgmtRtgRsp_3 & 0xFFFF
   1590          
   1591            FillAndSendBuffer( &TransSeq, dstAddr, Mgmt_Rtg_rsp, len, buf );
   \   00015D   8E82         MOV     DPL,R6
   \   00015F   8F83         MOV     DPH,R7
   \   000161   A3           INC     DPTR
   \   000162   A882         MOV     R0,DPL
   \   000164   A983         MOV     R1,DPH
   \   000166   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000169   E8           MOV     A,R0
   \   00016A   F0           MOVX    @DPTR,A
   \   00016B   A3           INC     DPTR
   \   00016C   E9           MOV     A,R1
   \   00016D   F0           MOVX    @DPTR,A
   \   00016E                ; Setup parameters for call to function fillAndSend
   \   00016E   75..32       MOV     ?V0 + 4,#0x32
   \   000171   75..80       MOV     ?V0 + 5,#-0x80
   \   000174   78..         MOV     R0,#?V0 + 4
   \   000176   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000179   A9..         MOV     R1,?V0 + 10
   \   00017B   AC..         MOV     R4,?V0 + 2
   \   00017D   AD..         MOV     R5,?V0 + 3
   \   00017F   7402         MOV     A,#0x2
   \   000181   12....       LCALL   ?XSTACK_DISP0_8
   \   000184   AA82         MOV     R2,DPL
   \   000186   AB83         MOV     R3,DPH
   \   000188   12....       LCALL   ??fillAndSend?relay
   \   00018B   7402         MOV     A,#0x2
   \   00018D   12....       LCALL   ?DEALLOC_XSTACK8
   \   000190   E9           MOV     A,R1
   \   000191   F5..         MOV     ?V0 + 1,A
   \   000193                ; Setup parameters for call to function osal_mem_free
   \   000193   EE           MOV     A,R6
   \   000194   FA           MOV     R2,A
   \   000195   EF           MOV     A,R7
   \   000196   FB           MOV     R3,A
   \   000197   12....       LCALL   ??osal_mem_free?relay
   \   00019A   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00019D   74..         MOV     A,#(ZDP_Buf + 1) & 0xff
   \   00019F   F0           MOVX    @DPTR,A
   \   0001A0   A3           INC     DPTR
   \   0001A1   74..         MOV     A,#((ZDP_Buf + 1) >> 8) & 0xff
   \   0001A3   F0           MOVX    @DPTR,A
   \   0001A4   A9..         MOV     R1,?V0 + 1
   \                     ??ZDP_MgmtRtgRsp_1:
   \   0001A6   7401         MOV     A,#0x1
   \   0001A8   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001AB   7F0B         MOV     R7,#0xb
   \   0001AD   02....       LJMP    ?BANKED_LEAVE_XDATA
   1592          }
   1593          
   1594          /*********************************************************************
   1595           * @fn          ZDP_MgmtBindRsp
   1596           *
   1597           * @brief       This builds and send a Mgmt_Bind_rsp message. This
   1598           *              function sends a unicast message.
   1599           *
   1600           * @param       dstAddr - destination address of the message
   1601           * @param       Status - message status (ZDP_SUCCESS or other)
   1602           * @param       BindingTableEntries - Total number of entries
   1603           * @param       StartIndex - Starting index within the reporting list
   1604           * @param       BindingTableListCount - number of entries included
   1605           *                                 in this message
   1606           * @param       BindingTableList - List of Binding Table entries
   1607           * @param       SecurityEnable - Security Options
   1608           *
   1609           * @return      ZStatus_t
   1610           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1611          ZStatus_t ZDP_MgmtBindRsp( byte TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_MgmtBindRsp:
   1612                                      byte Status,
   1613                                      byte BindingTableEntries,
   1614                                      byte StartIndex,
   1615                                      byte BindingTableListCount,
   1616                                      apsBindingItem_t *BindingTableList,
   1617                                      byte SecurityEnable )
   1618          {
   \   000000   74EA         MOV     A,#-0x16
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 22
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   8A..         MOV     ?V0 + 12,R2
   \   000014   8B..         MOV     ?V0 + 13,R3
   \   000016   8C..         MOV     ?V0 + 10,R4
   \   000018   8D..         MOV     ?V0 + 7,R5
   \   00001A   7417         MOV     A,#0x17
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F5..         MOV     ?V0 + 8,A
   \   000022   7418         MOV     A,#0x18
   \   000024   12....       LCALL   ?XSTACK_DISP0_8
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F5..         MOV     ?V0 + 4,A
   \   00002A   7419         MOV     A,#0x19
   \   00002C   12....       LCALL   ?XSTACK_DISP0_8
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   FE           MOV     R6,A
   \   000031   A3           INC     DPTR
   \   000032   E0           MOVX    A,@DPTR
   \   000033   FF           MOV     R7,A
   1619            uint8 *buf;
   1620            uint8 *pBuf;
   1621            uint8 maxLen; // maxLen is the maximum packet length to allocate enough memory space
   1622            uint8 len;    // Actual length varies due to different addrMode
   1623            uint8 x;
   1624            byte extZdpBindEntrySize = ZDP_BINDINGENTRY_SIZE + 1 + 1; // One more byte for cluserID and DstAddrMode
   \   000034   75..15       MOV     ?V0 + 5,#0x15
   1625            byte shortZdpBindEntrySize = ZDP_BINDINGENTRY_SIZE + 1 + 1 + 2 - 8 - 1; // clusterID + DstAddrMode + shortAddr - ExtAddr - DstEndpoint
   \   000037   75..0E       MOV     ?V0 + 6,#0xe
   1626          
   1627            (void)SecurityEnable;  // Intentionally unreferenced parameter
   1628          
   1629            // Status + BindingTableEntries + StartIndex + BindingTableListCount.
   1630            maxLen = 1 + 1 + 1 + 1;
   \   00003A   7804         MOV     R0,#0x4
   1631            maxLen += (BindingTableListCount * extZdpBindEntrySize );  //max length
   \   00003C   E5..         MOV     A,?V0 + 5
   \   00003E   F5F0         MOV     B,A
   \   000040   E5..         MOV     A,?V0 + 4
   \   000042   A4           MUL     AB
   \   000043   28           ADD     A,R0
   \   000044   F8           MOV     R0,A
   1632            buf = osal_mem_alloc( maxLen + 1 );  // +1 for transaction ID
   \   000045                ; Setup parameters for call to function osal_mem_alloc
   \   000045   88..         MOV     ?V0 + 0,R0
   \   000047   75..00       MOV     ?V0 + 1,#0x0
   \   00004A   E5..         MOV     A,?V0 + 0
   \   00004C   2401         ADD     A,#0x1
   \   00004E   FA           MOV     R2,A
   \   00004F   E5..         MOV     A,?V0 + 1
   \   000051   3400         ADDC    A,#0x0
   \   000053   FB           MOV     R3,A
   \   000054   12....       LCALL   ??osal_mem_alloc?relay
   \   000057   8A..         MOV     ?V0 + 0,R2
   \   000059   8B..         MOV     ?V0 + 1,R3
   \   00005B   85....       MOV     ?V0 + 2,?V0 + 0
   \   00005E   85....       MOV     ?V0 + 3,?V0 + 1
   1633          
   1634            if ( buf == NULL )
   \   000061   E5..         MOV     A,?V0 + 2
   \   000063   45..         ORL     A,?V0 + 3
   \   000065   7005         JNZ     ??ZDP_MgmtBindRsp_0
   1635            {
   1636              return afStatus_MEM_FAIL;
   \   000067   7910         MOV     R1,#0x10
   \   000069   02....       LJMP    ??ZDP_MgmtBindRsp_1 & 0xFFFF
   1637            }
   1638          
   1639            pBuf = buf+1;
   \                     ??ZDP_MgmtBindRsp_0:
   \   00006C   85..82       MOV     DPL,?V0 + 2
   \   00006F   85..83       MOV     DPH,?V0 + 3
   \   000072   A3           INC     DPTR
   \   000073   AA82         MOV     R2,DPL
   \   000075   AB83         MOV     R3,DPH
   1640          
   1641            *pBuf++ = Status;
   \   000077   E5..         MOV     A,?V0 + 10
   \   000079   8A82         MOV     DPL,R2
   \   00007B   8B83         MOV     DPH,R3
   \   00007D   E5..         MOV     A,?V0 + 10
   \   00007F   F0           MOVX    @DPTR,A
   \   000080   8A82         MOV     DPL,R2
   \   000082   8B83         MOV     DPH,R3
   \   000084   A3           INC     DPTR
   \   000085   AA82         MOV     R2,DPL
   \   000087   AB83         MOV     R3,DPH
   1642            *pBuf++ = BindingTableEntries;
   \   000089   E5..         MOV     A,?V0 + 7
   \   00008B   8A82         MOV     DPL,R2
   \   00008D   8B83         MOV     DPH,R3
   \   00008F   E5..         MOV     A,?V0 + 7
   \   000091   F0           MOVX    @DPTR,A
   \   000092   8A82         MOV     DPL,R2
   \   000094   8B83         MOV     DPH,R3
   \   000096   A3           INC     DPTR
   \   000097   AA82         MOV     R2,DPL
   \   000099   AB83         MOV     R3,DPH
   1643            *pBuf++ = StartIndex;
   \   00009B   E5..         MOV     A,?V0 + 8
   \   00009D   8A82         MOV     DPL,R2
   \   00009F   8B83         MOV     DPH,R3
   \   0000A1   E5..         MOV     A,?V0 + 8
   \   0000A3   F0           MOVX    @DPTR,A
   \   0000A4   8A82         MOV     DPL,R2
   \   0000A6   8B83         MOV     DPH,R3
   \   0000A8   A3           INC     DPTR
   \   0000A9   AA82         MOV     R2,DPL
   \   0000AB   AB83         MOV     R3,DPH
   1644            *pBuf++ = BindingTableListCount;
   \   0000AD   E5..         MOV     A,?V0 + 4
   \   0000AF   8A82         MOV     DPL,R2
   \   0000B1   8B83         MOV     DPH,R3
   \   0000B3   E5..         MOV     A,?V0 + 4
   \   0000B5   F0           MOVX    @DPTR,A
   \   0000B6   8A82         MOV     DPL,R2
   \   0000B8   8B83         MOV     DPH,R3
   \   0000BA   A3           INC     DPTR
   \   0000BB   AA82         MOV     R2,DPL
   \   0000BD   AB83         MOV     R3,DPH
   1645          
   1646            // Initial length = Status + BindingTableEntries + StartIndex + BindingTableListCount.
   1647            // length += ZDP_BINDINGENTRY_SIZE   -- Version 1.0
   1648            //           extZdpBindEntrySize     -- Version 1.1 extended address mode
   1649            //           shortZdpBindEntrySize   -- Version 1.1 group address mode
   1650          
   1651            len = 1 + 1 + 1 + 1;
   \   0000BF   75..04       MOV     ?V0 + 0,#0x4
   1652            for ( x = 0; x < BindingTableListCount; x++ )
   \   0000C2   75..00       MOV     ?V0 + 1,#0x0
   \   0000C5   804E         SJMP    ??ZDP_MgmtBindRsp_2
   1653            {
   1654              pBuf = osal_cpyExtAddr( pBuf, BindingTableList->srcAddr );
   1655              *pBuf++ = BindingTableList->srcEP;
   1656          
   1657              // Cluster ID
   1658              *pBuf++ = LO_UINT16( BindingTableList->clusterID );
   1659              *pBuf++ = HI_UINT16( BindingTableList->clusterID );
   1660          
   1661              *pBuf++ = BindingTableList->dstAddr.addrMode;
   1662              if ( BindingTableList->dstAddr.addrMode == Addr64Bit )
   1663              {
   1664                len += extZdpBindEntrySize;
   1665                pBuf = osal_cpyExtAddr( pBuf, BindingTableList->dstAddr.addr.extAddr );
   1666                *pBuf++ = BindingTableList->dstEP;
   1667              }
   1668              else
   1669              {
   1670                len += shortZdpBindEntrySize;
   \                     ??ZDP_MgmtBindRsp_3:
   \   0000C7   E5..         MOV     A,?V0 + 6
   \   0000C9   25..         ADD     A,?V0 + 0
   \   0000CB   F5..         MOV     ?V0 + 0,A
   1671                *pBuf++ = LO_UINT16( BindingTableList->dstAddr.addr.shortAddr );
   \   0000CD   EE           MOV     A,R6
   \   0000CE   240B         ADD     A,#0xb
   \   0000D0   F582         MOV     DPL,A
   \   0000D2   EF           MOV     A,R7
   \   0000D3   3400         ADDC    A,#0x0
   \   0000D5   F583         MOV     DPH,A
   \   0000D7   E0           MOVX    A,@DPTR
   \   0000D8   F8           MOV     R0,A
   \   0000D9   A3           INC     DPTR
   \   0000DA   E0           MOVX    A,@DPTR
   \   0000DB   F9           MOV     R1,A
   \   0000DC   E8           MOV     A,R0
   \   0000DD   8A82         MOV     DPL,R2
   \   0000DF   8B83         MOV     DPH,R3
   \   0000E1   F0           MOVX    @DPTR,A
   \   0000E2   8A82         MOV     DPL,R2
   \   0000E4   8B83         MOV     DPH,R3
   \   0000E6   A3           INC     DPTR
   \   0000E7   AA82         MOV     R2,DPL
   \   0000E9   AB83         MOV     R3,DPH
   1672                *pBuf++ = HI_UINT16( BindingTableList->dstAddr.addr.shortAddr );
   \   0000EB   EE           MOV     A,R6
   \   0000EC   240B         ADD     A,#0xb
   \   0000EE   F582         MOV     DPL,A
   \   0000F0   EF           MOV     A,R7
   \   0000F1   3400         ADDC    A,#0x0
   \   0000F3   F583         MOV     DPH,A
   \   0000F5   E0           MOVX    A,@DPTR
   \   0000F6   F8           MOV     R0,A
   \   0000F7   A3           INC     DPTR
   \   0000F8   E0           MOVX    A,@DPTR
   \   0000F9   F9           MOV     R1,A
   \   0000FA   E4           CLR     A
   \   0000FB   E9           MOV     A,R1
   \   0000FC   F8           MOV     R0,A
   \   0000FD   8A82         MOV     DPL,R2
   \   0000FF   8B83         MOV     DPH,R3
   \   000101   F0           MOVX    @DPTR,A
   \   000102   8A82         MOV     DPL,R2
   \   000104   8B83         MOV     DPH,R3
   \   000106   A3           INC     DPTR
   \   000107   AA82         MOV     R2,DPL
   \   000109   AB83         MOV     R3,DPH
   1673              }
   1674              BindingTableList++;    // Move to next list entry
   \                     ??ZDP_MgmtBindRsp_4:
   \   00010B   EE           MOV     A,R6
   \   00010C   2415         ADD     A,#0x15
   \   00010E   FE           MOV     R6,A
   \   00010F   EF           MOV     A,R7
   \   000110   3400         ADDC    A,#0x0
   \   000112   FF           MOV     R7,A
   \   000113   05..         INC     ?V0 + 1
   \                     ??ZDP_MgmtBindRsp_2:
   \   000115   E5..         MOV     A,?V0 + 1
   \   000117   C3           CLR     C
   \   000118   95..         SUBB    A,?V0 + 4
   \   00011A   4003         JC      $+5
   \   00011C   02....       LJMP    ??ZDP_MgmtBindRsp_5 & 0xFFFF
   \   00011F                ; Setup parameters for call to function sAddrExtCpy
   \   00011F   EE           MOV     A,R6
   \   000120   FC           MOV     R4,A
   \   000121   EF           MOV     A,R7
   \   000122   FD           MOV     R5,A
   \   000123   12....       LCALL   ??sAddrExtCpy?relay
   \   000126   8A..         MOV     ?V0 + 8,R2
   \   000128   8B..         MOV     ?V0 + 9,R3
   \   00012A   AA..         MOV     R2,?V0 + 8
   \   00012C   AB..         MOV     R3,?V0 + 9
   \   00012E   8E82         MOV     DPL,R6
   \   000130   8F83         MOV     DPH,R7
   \   000132   A3           INC     DPTR
   \   000133   A3           INC     DPTR
   \   000134   A3           INC     DPTR
   \   000135   A3           INC     DPTR
   \   000136   A3           INC     DPTR
   \   000137   A3           INC     DPTR
   \   000138   A3           INC     DPTR
   \   000139   A3           INC     DPTR
   \   00013A   E0           MOVX    A,@DPTR
   \   00013B   8A82         MOV     DPL,R2
   \   00013D   8B83         MOV     DPH,R3
   \   00013F   F0           MOVX    @DPTR,A
   \   000140   8A82         MOV     DPL,R2
   \   000142   8B83         MOV     DPH,R3
   \   000144   A3           INC     DPTR
   \   000145   AA82         MOV     R2,DPL
   \   000147   AB83         MOV     R3,DPH
   \   000149   8E82         MOV     DPL,R6
   \   00014B   8F83         MOV     DPH,R7
   \   00014D   A3           INC     DPTR
   \   00014E   A3           INC     DPTR
   \   00014F   A3           INC     DPTR
   \   000150   A3           INC     DPTR
   \   000151   A3           INC     DPTR
   \   000152   A3           INC     DPTR
   \   000153   A3           INC     DPTR
   \   000154   A3           INC     DPTR
   \   000155   A3           INC     DPTR
   \   000156   E0           MOVX    A,@DPTR
   \   000157   F8           MOV     R0,A
   \   000158   A3           INC     DPTR
   \   000159   E0           MOVX    A,@DPTR
   \   00015A   F9           MOV     R1,A
   \   00015B   E8           MOV     A,R0
   \   00015C   8A82         MOV     DPL,R2
   \   00015E   8B83         MOV     DPH,R3
   \   000160   F0           MOVX    @DPTR,A
   \   000161   8A82         MOV     DPL,R2
   \   000163   8B83         MOV     DPH,R3
   \   000165   A3           INC     DPTR
   \   000166   AA82         MOV     R2,DPL
   \   000168   AB83         MOV     R3,DPH
   \   00016A   8E82         MOV     DPL,R6
   \   00016C   8F83         MOV     DPH,R7
   \   00016E   A3           INC     DPTR
   \   00016F   A3           INC     DPTR
   \   000170   A3           INC     DPTR
   \   000171   A3           INC     DPTR
   \   000172   A3           INC     DPTR
   \   000173   A3           INC     DPTR
   \   000174   A3           INC     DPTR
   \   000175   A3           INC     DPTR
   \   000176   A3           INC     DPTR
   \   000177   E0           MOVX    A,@DPTR
   \   000178   F8           MOV     R0,A
   \   000179   A3           INC     DPTR
   \   00017A   E0           MOVX    A,@DPTR
   \   00017B   F9           MOV     R1,A
   \   00017C   E4           CLR     A
   \   00017D   E9           MOV     A,R1
   \   00017E   F8           MOV     R0,A
   \   00017F   8A82         MOV     DPL,R2
   \   000181   8B83         MOV     DPH,R3
   \   000183   F0           MOVX    @DPTR,A
   \   000184   8A82         MOV     DPL,R2
   \   000186   8B83         MOV     DPH,R3
   \   000188   A3           INC     DPTR
   \   000189   AA82         MOV     R2,DPL
   \   00018B   AB83         MOV     R3,DPH
   \   00018D   EE           MOV     A,R6
   \   00018E   2413         ADD     A,#0x13
   \   000190   F582         MOV     DPL,A
   \   000192   EF           MOV     A,R7
   \   000193   3400         ADDC    A,#0x0
   \   000195   F583         MOV     DPH,A
   \   000197   E0           MOVX    A,@DPTR
   \   000198   8A82         MOV     DPL,R2
   \   00019A   8B83         MOV     DPH,R3
   \   00019C   F0           MOVX    @DPTR,A
   \   00019D   8A82         MOV     DPL,R2
   \   00019F   8B83         MOV     DPH,R3
   \   0001A1   A3           INC     DPTR
   \   0001A2   AA82         MOV     R2,DPL
   \   0001A4   AB83         MOV     R3,DPH
   \   0001A6   EE           MOV     A,R6
   \   0001A7   2413         ADD     A,#0x13
   \   0001A9   F582         MOV     DPL,A
   \   0001AB   EF           MOV     A,R7
   \   0001AC   3400         ADDC    A,#0x0
   \   0001AE   F583         MOV     DPH,A
   \   0001B0   E0           MOVX    A,@DPTR
   \   0001B1   6403         XRL     A,#0x3
   \   0001B3   6003         JZ      $+5
   \   0001B5   02....       LJMP    ??ZDP_MgmtBindRsp_3 & 0xFFFF
   \   0001B8   E5..         MOV     A,?V0 + 5
   \   0001BA   25..         ADD     A,?V0 + 0
   \   0001BC   F5..         MOV     ?V0 + 0,A
   \   0001BE                ; Setup parameters for call to function sAddrExtCpy
   \   0001BE   EE           MOV     A,R6
   \   0001BF   240B         ADD     A,#0xb
   \   0001C1   FC           MOV     R4,A
   \   0001C2   EF           MOV     A,R7
   \   0001C3   3400         ADDC    A,#0x0
   \   0001C5   FD           MOV     R5,A
   \   0001C6   12....       LCALL   ??sAddrExtCpy?relay
   \   0001C9   8A..         MOV     ?V0 + 8,R2
   \   0001CB   8B..         MOV     ?V0 + 9,R3
   \   0001CD   AA..         MOV     R2,?V0 + 8
   \   0001CF   AB..         MOV     R3,?V0 + 9
   \   0001D1   EE           MOV     A,R6
   \   0001D2   2414         ADD     A,#0x14
   \   0001D4   F582         MOV     DPL,A
   \   0001D6   EF           MOV     A,R7
   \   0001D7   3400         ADDC    A,#0x0
   \   0001D9   F583         MOV     DPH,A
   \   0001DB   E0           MOVX    A,@DPTR
   \   0001DC   8A82         MOV     DPL,R2
   \   0001DE   8B83         MOV     DPH,R3
   \   0001E0   F0           MOVX    @DPTR,A
   \   0001E1   8A82         MOV     DPL,R2
   \   0001E3   8B83         MOV     DPH,R3
   \   0001E5   A3           INC     DPTR
   \   0001E6   AA82         MOV     R2,DPL
   \   0001E8   AB83         MOV     R3,DPH
   \   0001EA   02....       LJMP    ??ZDP_MgmtBindRsp_4 & 0xFFFF
   1675            }
   1676          
   1677            FillAndSendBuffer( &TransSeq, dstAddr, Mgmt_Bind_rsp, len, buf );
   \                     ??ZDP_MgmtBindRsp_5:
   \   0001ED   85..82       MOV     DPL,?V0 + 2
   \   0001F0   85..83       MOV     DPH,?V0 + 3
   \   0001F3   A3           INC     DPTR
   \   0001F4   A882         MOV     R0,DPL
   \   0001F6   A983         MOV     R1,DPH
   \   0001F8   90....       MOV     DPTR,#ZDP_TmpBuf
   \   0001FB   E8           MOV     A,R0
   \   0001FC   F0           MOVX    @DPTR,A
   \   0001FD   A3           INC     DPTR
   \   0001FE   E9           MOV     A,R1
   \   0001FF   F0           MOVX    @DPTR,A
   \   000200                ; Setup parameters for call to function fillAndSend
   \   000200   75..33       MOV     ?V0 + 4,#0x33
   \   000203   75..80       MOV     ?V0 + 5,#-0x80
   \   000206   78..         MOV     R0,#?V0 + 4
   \   000208   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00020B   A9..         MOV     R1,?V0 + 0
   \   00020D   AC..         MOV     R4,?V0 + 12
   \   00020F   AD..         MOV     R5,?V0 + 13
   \   000211   7402         MOV     A,#0x2
   \   000213   12....       LCALL   ?XSTACK_DISP0_8
   \   000216   AA82         MOV     R2,DPL
   \   000218   AB83         MOV     R3,DPH
   \   00021A   12....       LCALL   ??fillAndSend?relay
   \   00021D   7402         MOV     A,#0x2
   \   00021F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000222   E9           MOV     A,R1
   \   000223   FE           MOV     R6,A
   \   000224                ; Setup parameters for call to function osal_mem_free
   \   000224   AA..         MOV     R2,?V0 + 2
   \   000226   AB..         MOV     R3,?V0 + 3
   \   000228   12....       LCALL   ??osal_mem_free?relay
   \   00022B   90....       MOV     DPTR,#ZDP_TmpBuf
   \   00022E   74..         MOV     A,#(ZDP_Buf + 1) & 0xff
   \   000230   F0           MOVX    @DPTR,A
   \   000231   A3           INC     DPTR
   \   000232   74..         MOV     A,#((ZDP_Buf + 1) >> 8) & 0xff
   \   000234   F0           MOVX    @DPTR,A
   \   000235   EE           MOV     A,R6
   \   000236   F9           MOV     R1,A
   \                     ??ZDP_MgmtBindRsp_1:
   \   000237   7401         MOV     A,#0x1
   \   000239   12....       LCALL   ?DEALLOC_XSTACK8
   \   00023C   7F0E         MOV     R7,#0xe
   \   00023E   02....       LJMP    ?BANKED_LEAVE_XDATA
   1678          }
   1679          
   1680          /*********************************************************************
   1681           * @fn          ZDP_MgmtNwkUpdateNotify
   1682           *
   1683           * @brief       This builds and send a Mgmt_NWK_Update_notify message. This
   1684           *              function sends a unicast message.
   1685           *
   1686           * @param       dstAddr - destination address of the message
   1687           * @param       status - message status (ZDP_SUCCESS or other)
   1688           * @param       scannedChannels - List of channels scanned by the request
   1689           * @param       totalTransmissions - Total transmissions
   1690           * @param       transmissionFailures - Sum of transmission failures
   1691           * @param       listCount - Number of records contained in the energyValues list
   1692           * @param       energyValues - List of descriptors, one for each of ListCount,
   1693           *                             of the enegry detect descriptors
   1694           * @param       txOptions - Transmit options
   1695           * @param       securityEnable - Security options
   1696           *
   1697           * @return      afStatus_t
   1698           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1699          afStatus_t ZDP_MgmtNwkUpdateNotify( uint8 TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_MgmtNwkUpdateNotify:
   1700                                              uint8 status, uint32 scannedChannels,
   1701                                              uint16 totalTransmissions, uint16 transmissionFailures,
   1702                                              uint8 listCount, uint8 *energyValues, uint8 txOptions,
   1703                                              uint8 securityEnable )
   1704          {
   \   000000   74E8         MOV     A,#-0x18
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 24
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   7401         MOV     A,#0x1
   \   000014   12....       LCALL   ?XSTACK_DISP0_8
   \   000017   EA           MOV     A,R2
   \   000018   F0           MOVX    @DPTR,A
   \   000019   A3           INC     DPTR
   \   00001A   EB           MOV     A,R3
   \   00001B   F0           MOVX    @DPTR,A
   \   00001C   8C..         MOV     ?V0 + 13,R4
   \   00001E   8D..         MOV     ?V0 + 8,R5
   \   000020   741B         MOV     A,#0x1b
   \   000022   12....       LCALL   ?XSTACK_DISP0_8
   \   000025   78..         MOV     R0,#?V0 + 4
   \   000027   12....       LCALL   ?L_MOV_X
   \   00002A   741F         MOV     A,#0x1f
   \   00002C   12....       LCALL   ?XSTACK_DISP0_8
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   FE           MOV     R6,A
   \   000031   A3           INC     DPTR
   \   000032   E0           MOVX    A,@DPTR
   \   000033   FF           MOV     R7,A
   \   000034   7421         MOV     A,#0x21
   \   000036   12....       LCALL   ?XSTACK_DISP0_8
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   F5..         MOV     ?V0 + 0,A
   \   00003C   A3           INC     DPTR
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   F5..         MOV     ?V0 + 1,A
   \   000040   7423         MOV     A,#0x23
   \   000042   12....       LCALL   ?XSTACK_DISP0_8
   \   000045   E0           MOVX    A,@DPTR
   \   000046   F5..         MOV     ?V0 + 14,A
   \   000048   A3           INC     DPTR
   \   000049   E0           MOVX    A,@DPTR
   \   00004A   F5..         MOV     ?V0 + 15,A
   \   00004C   7425         MOV     A,#0x25
   \   00004E   12....       LCALL   ?XSTACK_DISP0_8
   \   000051   E0           MOVX    A,@DPTR
   \   000052   F5..         MOV     ?V0 + 12,A
   1705            uint8 *buf;
   1706            uint8 *pBuf;
   1707            uint8 len;
   1708          
   1709            (void)securityEnable;  // Intentionally unreferenced parameter
   1710          
   1711            // Status + ScannedChannels + totalTransmissions + transmissionFailures + ListCount + energyValues
   1712            len = 1 + 4 + 2 + 2 + 1 + listCount;
   \   000054   740A         MOV     A,#0xa
   \   000056   25..         ADD     A,?V0 + 8
   \   000058   F5..         MOV     ?V0 + 9,A
   1713          
   1714            buf = osal_mem_alloc( len+1 ); // +1 for transaction ID
   \   00005A                ; Setup parameters for call to function osal_mem_alloc
   \   00005A   85....       MOV     ?V0 + 2,?V0 + 9
   \   00005D   75..00       MOV     ?V0 + 3,#0x0
   \   000060   E5..         MOV     A,?V0 + 2
   \   000062   2401         ADD     A,#0x1
   \   000064   FA           MOV     R2,A
   \   000065   E5..         MOV     A,?V0 + 3
   \   000067   3400         ADDC    A,#0x0
   \   000069   FB           MOV     R3,A
   \   00006A   12....       LCALL   ??osal_mem_alloc?relay
   \   00006D   8A..         MOV     ?V0 + 10,R2
   \   00006F   8B..         MOV     ?V0 + 11,R3
   \   000071   85....       MOV     ?V0 + 2,?V0 + 10
   \   000074   85....       MOV     ?V0 + 3,?V0 + 11
   1715            if ( buf == NULL )
   \   000077   E5..         MOV     A,?V0 + 2
   \   000079   45..         ORL     A,?V0 + 3
   \   00007B   7005         JNZ     ??ZDP_MgmtNwkUpdateNotify_0
   1716            {
   1717              return afStatus_MEM_FAIL;
   \   00007D   7910         MOV     R1,#0x10
   \   00007F   02....       LJMP    ??ZDP_MgmtNwkUpdateNotify_1 & 0xFFFF
   1718            }
   1719          
   1720            pBuf = buf+1;
   \                     ??ZDP_MgmtNwkUpdateNotify_0:
   \   000082   85..82       MOV     DPL,?V0 + 2
   \   000085   85..83       MOV     DPH,?V0 + 3
   \   000088   A3           INC     DPTR
   \   000089   AA82         MOV     R2,DPL
   \   00008B   AB83         MOV     R3,DPH
   1721          
   1722            *pBuf++ = status;
   \   00008D   E5..         MOV     A,?V0 + 13
   \   00008F   8A82         MOV     DPL,R2
   \   000091   8B83         MOV     DPH,R3
   \   000093   E5..         MOV     A,?V0 + 13
   \   000095   F0           MOVX    @DPTR,A
   \   000096   8A82         MOV     DPL,R2
   \   000098   8B83         MOV     DPH,R3
   \   00009A   A3           INC     DPTR
   \   00009B   AA82         MOV     R2,DPL
   \   00009D   AB83         MOV     R3,DPH
   1723          
   1724            pBuf = osal_buffer_uint32( pBuf, scannedChannels );
   \   00009F                ; Setup parameters for call to function osal_buffer_uint32
   \   00009F   78..         MOV     R0,#?V0 + 4
   \   0000A1   12....       LCALL   ?PUSH_XSTACK_I_FOUR
   \   0000A4   12....       LCALL   ??osal_buffer_uint32?relay
   \   0000A7   7404         MOV     A,#0x4
   \   0000A9   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000AC   8A..         MOV     ?V0 + 4,R2
   \   0000AE   8B..         MOV     ?V0 + 5,R3
   \   0000B0   AA..         MOV     R2,?V0 + 4
   \   0000B2   AB..         MOV     R3,?V0 + 5
   1725          
   1726            *pBuf++ = LO_UINT16( totalTransmissions );
   \   0000B4   EE           MOV     A,R6
   \   0000B5   8A82         MOV     DPL,R2
   \   0000B7   8B83         MOV     DPH,R3
   \   0000B9   F0           MOVX    @DPTR,A
   \   0000BA   8A82         MOV     DPL,R2
   \   0000BC   8B83         MOV     DPH,R3
   \   0000BE   A3           INC     DPTR
   \   0000BF   AA82         MOV     R2,DPL
   \   0000C1   AB83         MOV     R3,DPH
   1727            *pBuf++ = HI_UINT16( totalTransmissions );
   \   0000C3   E4           CLR     A
   \   0000C4   EF           MOV     A,R7
   \   0000C5   FE           MOV     R6,A
   \   0000C6   8A82         MOV     DPL,R2
   \   0000C8   8B83         MOV     DPH,R3
   \   0000CA   F0           MOVX    @DPTR,A
   \   0000CB   8A82         MOV     DPL,R2
   \   0000CD   8B83         MOV     DPH,R3
   \   0000CF   A3           INC     DPTR
   \   0000D0   AA82         MOV     R2,DPL
   \   0000D2   AB83         MOV     R3,DPH
   1728          
   1729            *pBuf++ = LO_UINT16( transmissionFailures );
   \   0000D4   E5..         MOV     A,?V0 + 0
   \   0000D6   8A82         MOV     DPL,R2
   \   0000D8   8B83         MOV     DPH,R3
   \   0000DA   E5..         MOV     A,?V0 + 0
   \   0000DC   F0           MOVX    @DPTR,A
   \   0000DD   8A82         MOV     DPL,R2
   \   0000DF   8B83         MOV     DPH,R3
   \   0000E1   A3           INC     DPTR
   \   0000E2   AA82         MOV     R2,DPL
   \   0000E4   AB83         MOV     R3,DPH
   1730            *pBuf++ = HI_UINT16( transmissionFailures );
   \   0000E6   E4           CLR     A
   \   0000E7   E5..         MOV     A,?V0 + 1
   \   0000E9   F5..         MOV     ?V0 + 0,A
   \   0000EB   E5..         MOV     A,?V0 + 0
   \   0000ED   8A82         MOV     DPL,R2
   \   0000EF   8B83         MOV     DPH,R3
   \   0000F1   E5..         MOV     A,?V0 + 0
   \   0000F3   F0           MOVX    @DPTR,A
   \   0000F4   8A82         MOV     DPL,R2
   \   0000F6   8B83         MOV     DPH,R3
   \   0000F8   A3           INC     DPTR
   \   0000F9   AA82         MOV     R2,DPL
   \   0000FB   AB83         MOV     R3,DPH
   1731          
   1732            *pBuf++ = listCount;
   \   0000FD   E5..         MOV     A,?V0 + 8
   \   0000FF   8A82         MOV     DPL,R2
   \   000101   8B83         MOV     DPH,R3
   \   000103   E5..         MOV     A,?V0 + 8
   \   000105   F0           MOVX    @DPTR,A
   \   000106   8A82         MOV     DPL,R2
   \   000108   8B83         MOV     DPH,R3
   \   00010A   A3           INC     DPTR
   \   00010B   AA82         MOV     R2,DPL
   \   00010D   AB83         MOV     R3,DPH
   1733          
   1734            if ( listCount > 0 )
   \   00010F   E5..         MOV     A,?V0 + 8
   \   000111   C3           CLR     C
   \   000112   9401         SUBB    A,#0x1
   \   000114   4020         JC      ??ZDP_MgmtNwkUpdateNotify_2
   1735              osal_memcpy( pBuf, energyValues, listCount );
   \   000116                ; Setup parameters for call to function osal_memcpy
   \   000116   85....       MOV     ?V0 + 4,?V0 + 14
   \   000119   85....       MOV     ?V0 + 5,?V0 + 15
   \   00011C   75..00       MOV     ?V0 + 6,#0x0
   \   00011F   78..         MOV     R0,#?V0 + 4
   \   000121   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000124   85....       MOV     ?V0 + 0,?V0 + 8
   \   000127   75..00       MOV     ?V0 + 1,#0x0
   \   00012A   AC..         MOV     R4,?V0 + 0
   \   00012C   AD..         MOV     R5,?V0 + 1
   \   00012E   12....       LCALL   ??osal_memcpy?relay
   \   000131   7403         MOV     A,#0x3
   \   000133   12....       LCALL   ?DEALLOC_XSTACK8
   1736          
   1737            FillAndSendBufferTxOptions( &TransSeq, dstAddr, Mgmt_NWK_Update_notify, len, buf, txOptions );
   \                     ??ZDP_MgmtNwkUpdateNotify_2:
   \   000136   85..82       MOV     DPL,?V0 + 2
   \   000139   85..83       MOV     DPH,?V0 + 3
   \   00013C   A3           INC     DPTR
   \   00013D   A882         MOV     R0,DPL
   \   00013F   A983         MOV     R1,DPH
   \   000141   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000144   E8           MOV     A,R0
   \   000145   F0           MOVX    @DPTR,A
   \   000146   A3           INC     DPTR
   \   000147   E9           MOV     A,R1
   \   000148   F0           MOVX    @DPTR,A
   \   000149   E5..         MOV     A,?V0 + 12
   \   00014B   90....       MOV     DPTR,#ZDP_TxOptions
   \   00014E   F0           MOVX    @DPTR,A
   \   00014F                ; Setup parameters for call to function fillAndSend
   \   00014F   75..38       MOV     ?V0 + 0,#0x38
   \   000152   75..80       MOV     ?V0 + 1,#-0x80
   \   000155   78..         MOV     R0,#?V0 + 0
   \   000157   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00015A   A9..         MOV     R1,?V0 + 9
   \   00015C   7403         MOV     A,#0x3
   \   00015E   12....       LCALL   ?XSTACK_DISP0_8
   \   000161   E0           MOVX    A,@DPTR
   \   000162   FC           MOV     R4,A
   \   000163   A3           INC     DPTR
   \   000164   E0           MOVX    A,@DPTR
   \   000165   FD           MOV     R5,A
   \   000166   7402         MOV     A,#0x2
   \   000168   12....       LCALL   ?XSTACK_DISP0_8
   \   00016B   AA82         MOV     R2,DPL
   \   00016D   AB83         MOV     R3,DPH
   \   00016F   12....       LCALL   ??fillAndSend?relay
   \   000172   7402         MOV     A,#0x2
   \   000174   12....       LCALL   ?DEALLOC_XSTACK8
   \   000177   E9           MOV     A,R1
   \   000178   FE           MOV     R6,A
   \   000179                ; Setup parameters for call to function osal_mem_free
   \   000179   AA..         MOV     R2,?V0 + 2
   \   00017B   AB..         MOV     R3,?V0 + 3
   \   00017D   12....       LCALL   ??osal_mem_free?relay
   \   000180   90....       MOV     DPTR,#ZDP_TmpBuf
   \   000183   74..         MOV     A,#(ZDP_Buf + 1) & 0xff
   \   000185   F0           MOVX    @DPTR,A
   \   000186   A3           INC     DPTR
   \   000187   74..         MOV     A,#((ZDP_Buf + 1) >> 8) & 0xff
   \   000189   F0           MOVX    @DPTR,A
   \   00018A   90....       MOV     DPTR,#ZDP_TxOptions
   \   00018D   7400         MOV     A,#0x0
   \   00018F   F0           MOVX    @DPTR,A
   \   000190   EE           MOV     A,R6
   \   000191   F9           MOV     R1,A
   \                     ??ZDP_MgmtNwkUpdateNotify_1:
   \   000192   7403         MOV     A,#0x3
   \   000194   12....       LCALL   ?DEALLOC_XSTACK8
   \   000197   7F10         MOV     R7,#0x10
   \   000199   02....       LJMP    ?BANKED_LEAVE_XDATA
   1738          }
   1739          
   1740          /*********************************************************************
   1741           * Functions to register for ZDO Over-the-air messages
   1742           */
   1743          
   1744          /*********************************************************************
   1745           * @fn          ZDO_RegisterForZDOMsg
   1746           *
   1747           * @brief       Call this function to register of an incoming over
   1748           *              the air ZDO message - probably a response message
   1749           *              but requests can also be received.
   1750           *              Messages are delivered to the task with ZDO_CB_MSG
   1751           *              as the message ID.
   1752           *
   1753           * @param       taskID - Where you would like the message delivered
   1754           * @param       clusterID - What message?
   1755           *
   1756           * @return      ZSuccess - successful, ZMemError if not
   1757           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1758          ZStatus_t ZDO_RegisterForZDOMsg( uint8 taskID, uint16 clusterID )
   \                     ZDO_RegisterForZDOMsg:
   1759          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 2,R1
   \   000007   8A..         MOV     ?V0 + 0,R2
   \   000009   8B..         MOV     ?V0 + 1,R3
   1760            ZDO_MsgCB_t *pList;
   1761            ZDO_MsgCB_t *pLast;
   1762            ZDO_MsgCB_t *pNew;
   1763          
   1764            // Look for duplicate
   1765            pList = pLast = zdoMsgCBs;
   \   00000B   90....       MOV     DPTR,#zdoMsgCBs
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   F8           MOV     R0,A
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F9           MOV     R1,A
   \   000013   E8           MOV     A,R0
   \   000014   FE           MOV     R6,A
   \   000015   E9           MOV     A,R1
   \   000016   FF           MOV     R7,A
   \   000017   800D         SJMP    ??ZDO_RegisterForZDOMsg_0
   1766            while ( pList )
   1767            {
   1768              if ( pList->taskID == taskID && pList->clusterID == clusterID )
   1769                return ( ZSuccess );
   1770              pLast = pList;
   \                     ??ZDO_RegisterForZDOMsg_1:
   \   000019   E8           MOV     A,R0
   \   00001A   FE           MOV     R6,A
   \   00001B   E9           MOV     A,R1
   \   00001C   FF           MOV     R7,A
   1771              pList = (ZDO_MsgCB_t *)pList->next;
   \   00001D   8882         MOV     DPL,R0
   \   00001F   8983         MOV     DPH,R1
   \   000021   E0           MOVX    A,@DPTR
   \   000022   F8           MOV     R0,A
   \   000023   A3           INC     DPTR
   \   000024   E0           MOVX    A,@DPTR
   \   000025   F9           MOV     R1,A
   \                     ??ZDO_RegisterForZDOMsg_0:
   \   000026   E8           MOV     A,R0
   \   000027   49           ORL     A,R1
   \   000028   6021         JZ      ??ZDO_RegisterForZDOMsg_2
   \   00002A   8882         MOV     DPL,R0
   \   00002C   8983         MOV     DPH,R1
   \   00002E   A3           INC     DPTR
   \   00002F   A3           INC     DPTR
   \   000030   E0           MOVX    A,@DPTR
   \   000031   65..         XRL     A,?V0 + 2
   \   000033   70E4         JNZ     ??ZDO_RegisterForZDOMsg_1
   \   000035   8882         MOV     DPL,R0
   \   000037   8983         MOV     DPH,R1
   \   000039   A3           INC     DPTR
   \   00003A   A3           INC     DPTR
   \   00003B   A3           INC     DPTR
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   65..         XRL     A,?V0 + 0
   \   00003F   7004         JNZ     ??ZDO_RegisterForZDOMsg_3
   \   000041   A3           INC     DPTR
   \   000042   E0           MOVX    A,@DPTR
   \   000043   65..         XRL     A,?V0 + 1
   \                     ??ZDO_RegisterForZDOMsg_3:
   \   000045   70D2         JNZ     ??ZDO_RegisterForZDOMsg_1
   \   000047   7900         MOV     R1,#0x0
   \   000049   805C         SJMP    ??ZDO_RegisterForZDOMsg_4
   1772            }
   1773          
   1774            // Add to the list
   1775            pNew = (ZDO_MsgCB_t *)osal_mem_alloc( sizeof ( ZDO_MsgCB_t ) );
   \                     ??ZDO_RegisterForZDOMsg_2:
   \   00004B                ; Setup parameters for call to function osal_mem_alloc
   \   00004B   7A05         MOV     R2,#0x5
   \   00004D   7B00         MOV     R3,#0x0
   \   00004F   12....       LCALL   ??osal_mem_alloc?relay
   \   000052   8A..         MOV     ?V0 + 4,R2
   \   000054   8B..         MOV     ?V0 + 5,R3
   \   000056   A8..         MOV     R0,?V0 + 4
   \   000058   A9..         MOV     R1,?V0 + 5
   1776            if ( pNew )
   \   00005A   E8           MOV     A,R0
   \   00005B   49           ORL     A,R1
   \   00005C   6047         JZ      ??ZDO_RegisterForZDOMsg_5
   1777            {
   1778              pNew->taskID = taskID;
   \   00005E   E5..         MOV     A,?V0 + 2
   \   000060   8882         MOV     DPL,R0
   \   000062   8983         MOV     DPH,R1
   \   000064   A3           INC     DPTR
   \   000065   A3           INC     DPTR
   \   000066   E5..         MOV     A,?V0 + 2
   \   000068   F0           MOVX    @DPTR,A
   1779              pNew->clusterID = clusterID;
   \   000069   8882         MOV     DPL,R0
   \   00006B   8983         MOV     DPH,R1
   \   00006D   A3           INC     DPTR
   \   00006E   A3           INC     DPTR
   \   00006F   A3           INC     DPTR
   \   000070   E5..         MOV     A,?V0 + 0
   \   000072   F0           MOVX    @DPTR,A
   \   000073   A3           INC     DPTR
   \   000074   E5..         MOV     A,?V0 + 1
   \   000076   F0           MOVX    @DPTR,A
   1780              pNew->next = NULL;
   \   000077   8882         MOV     DPL,R0
   \   000079   8983         MOV     DPH,R1
   \   00007B   7400         MOV     A,#0x0
   \   00007D   F0           MOVX    @DPTR,A
   \   00007E   A3           INC     DPTR
   \   00007F   7400         MOV     A,#0x0
   \   000081   F0           MOVX    @DPTR,A
   1781              if ( zdoMsgCBs )
   \   000082   90....       MOV     DPTR,#zdoMsgCBs
   \   000085   E0           MOVX    A,@DPTR
   \   000086   FA           MOV     R2,A
   \   000087   A3           INC     DPTR
   \   000088   E0           MOVX    A,@DPTR
   \   000089   FB           MOV     R3,A
   \   00008A   EA           MOV     A,R2
   \   00008B   4B           ORL     A,R3
   \   00008C   600B         JZ      ??ZDO_RegisterForZDOMsg_6
   1782              {
   1783                pLast->next = pNew;
   \   00008E   8E82         MOV     DPL,R6
   \   000090   8F83         MOV     DPH,R7
   \   000092   E8           MOV     A,R0
   \   000093   F0           MOVX    @DPTR,A
   \   000094   A3           INC     DPTR
   \   000095   E9           MOV     A,R1
   \   000096   F0           MOVX    @DPTR,A
   \   000097   8008         SJMP    ??ZDO_RegisterForZDOMsg_7
   1784              }
   1785              else
   1786                zdoMsgCBs = pNew;
   \                     ??ZDO_RegisterForZDOMsg_6:
   \   000099   90....       MOV     DPTR,#zdoMsgCBs
   \   00009C   E8           MOV     A,R0
   \   00009D   F0           MOVX    @DPTR,A
   \   00009E   A3           INC     DPTR
   \   00009F   E9           MOV     A,R1
   \   0000A0   F0           MOVX    @DPTR,A
   1787              return ( ZSuccess );
   \                     ??ZDO_RegisterForZDOMsg_7:
   \   0000A1   7900         MOV     R1,#0x0
   \   0000A3   8002         SJMP    ??ZDO_RegisterForZDOMsg_4
   1788            }
   1789            else
   1790              return ( ZMemError );
   \                     ??ZDO_RegisterForZDOMsg_5:
   \   0000A5   7910         MOV     R1,#0x10
   \                     ??ZDO_RegisterForZDOMsg_4:
   \   0000A7   7F06         MOV     R7,#0x6
   \   0000A9   02....       LJMP    ?BANKED_LEAVE_XDATA
   1791          }
   1792          
   1793          /*********************************************************************
   1794           * @fn          ZDO_RemoveRegisteredCB
   1795           *
   1796           * @brief       Call this function if you don't want to receive the
   1797           *              incoming message.
   1798           *
   1799           * @param       taskID - Where the messages are being delivered.
   1800           * @param       clusterID - What message?
   1801           *
   1802           * @return      ZSuccess - successful, ZFailure if not found
   1803           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1804          ZStatus_t ZDO_RemoveRegisteredCB( uint8 taskID, uint16 clusterID )
   \                     ZDO_RemoveRegisteredCB:
   1805          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   EA           MOV     A,R2
   \   000008   FC           MOV     R4,A
   \   000009   EB           MOV     A,R3
   \   00000A   FD           MOV     R5,A
   1806            ZDO_MsgCB_t *pList;
   1807            ZDO_MsgCB_t *pLast = NULL;
   \   00000B   7800         MOV     R0,#0x0
   \   00000D   7900         MOV     R1,#0x0
   1808          
   1809            pList = zdoMsgCBs;
   \   00000F   90....       MOV     DPTR,#zdoMsgCBs
   \   000012   E0           MOVX    A,@DPTR
   \   000013   FA           MOV     R2,A
   \   000014   A3           INC     DPTR
   \   000015   E0           MOVX    A,@DPTR
   \   000016   FB           MOV     R3,A
   \   000017   800D         SJMP    ??ZDO_RemoveRegisteredCB_0
   1810            while ( pList )
   1811            {
   1812              if ( pList->taskID == taskID && pList->clusterID == clusterID )
   1813              {
   1814                if ( pLast )
   1815                {
   1816                  // remove this one from the linked list
   1817                  pLast->next = pList->next;
   1818                }
   1819                else if ( pList->next )
   1820                {
   1821                  // remove the first one from the linked list
   1822                  zdoMsgCBs = pList->next;
   1823                }
   1824                else
   1825                {
   1826                  // remove the only item from the list
   1827                  zdoMsgCBs = (ZDO_MsgCB_t *)NULL;
   1828                }
   1829                osal_mem_free( pList );
   1830                return ( ZSuccess );
   1831              }
   1832              pLast = pList;
   \                     ??ZDO_RemoveRegisteredCB_1:
   \   000019   EA           MOV     A,R2
   \   00001A   F8           MOV     R0,A
   \   00001B   EB           MOV     A,R3
   \   00001C   F9           MOV     R1,A
   1833              pList = pList->next;
   \   00001D   8A82         MOV     DPL,R2
   \   00001F   8B83         MOV     DPH,R3
   \   000021   E0           MOVX    A,@DPTR
   \   000022   FA           MOV     R2,A
   \   000023   A3           INC     DPTR
   \   000024   E0           MOVX    A,@DPTR
   \   000025   FB           MOV     R3,A
   \                     ??ZDO_RemoveRegisteredCB_0:
   \   000026   EA           MOV     A,R2
   \   000027   4B           ORL     A,R3
   \   000028   6063         JZ      ??ZDO_RemoveRegisteredCB_2
   \   00002A   8A82         MOV     DPL,R2
   \   00002C   8B83         MOV     DPH,R3
   \   00002E   A3           INC     DPTR
   \   00002F   A3           INC     DPTR
   \   000030   E0           MOVX    A,@DPTR
   \   000031   6E           XRL     A,R6
   \   000032   70E5         JNZ     ??ZDO_RemoveRegisteredCB_1
   \   000034   8A82         MOV     DPL,R2
   \   000036   8B83         MOV     DPH,R3
   \   000038   A3           INC     DPTR
   \   000039   A3           INC     DPTR
   \   00003A   A3           INC     DPTR
   \   00003B   E0           MOVX    A,@DPTR
   \   00003C   6C           XRL     A,R4
   \   00003D   7003         JNZ     ??ZDO_RemoveRegisteredCB_3
   \   00003F   A3           INC     DPTR
   \   000040   E0           MOVX    A,@DPTR
   \   000041   6D           XRL     A,R5
   \                     ??ZDO_RemoveRegisteredCB_3:
   \   000042   70D5         JNZ     ??ZDO_RemoveRegisteredCB_1
   \   000044   E8           MOV     A,R0
   \   000045   49           ORL     A,R1
   \   000046   6014         JZ      ??ZDO_RemoveRegisteredCB_4
   \   000048   8A82         MOV     DPL,R2
   \   00004A   8B83         MOV     DPH,R3
   \   00004C   E0           MOVX    A,@DPTR
   \   00004D   FC           MOV     R4,A
   \   00004E   A3           INC     DPTR
   \   00004F   E0           MOVX    A,@DPTR
   \   000050   FD           MOV     R5,A
   \   000051   8882         MOV     DPL,R0
   \   000053   8983         MOV     DPH,R1
   \   000055   EC           MOV     A,R4
   \   000056   F0           MOVX    @DPTR,A
   \   000057   A3           INC     DPTR
   \   000058   ED           MOV     A,R5
   \   000059   F0           MOVX    @DPTR,A
   \   00005A   802A         SJMP    ??ZDO_RemoveRegisteredCB_5
   \                     ??ZDO_RemoveRegisteredCB_4:
   \   00005C   8A82         MOV     DPL,R2
   \   00005E   8B83         MOV     DPH,R3
   \   000060   E0           MOVX    A,@DPTR
   \   000061   F8           MOV     R0,A
   \   000062   A3           INC     DPTR
   \   000063   E0           MOVX    A,@DPTR
   \   000064   F9           MOV     R1,A
   \   000065   E8           MOV     A,R0
   \   000066   49           ORL     A,R1
   \   000067   6013         JZ      ??ZDO_RemoveRegisteredCB_6
   \   000069   8A82         MOV     DPL,R2
   \   00006B   8B83         MOV     DPH,R3
   \   00006D   E0           MOVX    A,@DPTR
   \   00006E   F8           MOV     R0,A
   \   00006F   A3           INC     DPTR
   \   000070   E0           MOVX    A,@DPTR
   \   000071   F9           MOV     R1,A
   \   000072   90....       MOV     DPTR,#zdoMsgCBs
   \   000075   E8           MOV     A,R0
   \   000076   F0           MOVX    @DPTR,A
   \   000077   A3           INC     DPTR
   \   000078   E9           MOV     A,R1
   \   000079   F0           MOVX    @DPTR,A
   \   00007A   800A         SJMP    ??ZDO_RemoveRegisteredCB_5
   \                     ??ZDO_RemoveRegisteredCB_6:
   \   00007C   90....       MOV     DPTR,#zdoMsgCBs
   \   00007F   7400         MOV     A,#0x0
   \   000081   F0           MOVX    @DPTR,A
   \   000082   A3           INC     DPTR
   \   000083   7400         MOV     A,#0x0
   \   000085   F0           MOVX    @DPTR,A
   \                     ??ZDO_RemoveRegisteredCB_5:
   \   000086                ; Setup parameters for call to function osal_mem_free
   \   000086   12....       LCALL   ??osal_mem_free?relay
   \   000089   7900         MOV     R1,#0x0
   \   00008B   8002         SJMP    ??ZDO_RemoveRegisteredCB_7
   1834            }
   1835          
   1836            return ( ZFailure );
   \                     ??ZDO_RemoveRegisteredCB_2:
   \   00008D   7901         MOV     R1,#0x1
   \                     ??ZDO_RemoveRegisteredCB_7:
   \   00008F   7F01         MOV     R7,#0x1
   \   000091   02....       LJMP    ?BANKED_LEAVE_XDATA
   1837          }
   1838          
   1839          /*********************************************************************
   1840           * @fn          ZDO_SendMsgCBs
   1841           *
   1842           * @brief       This function sends messages to registered tasks.
   1843           *              Local to ZDO and shouldn't be called outside of ZDO.
   1844           *
   1845           * @param       inMsg - incoming message
   1846           *
   1847           * @return      TRUE if sent to at least 1 task, FALSE if not
   1848           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1849          uint8 ZDO_SendMsgCBs( zdoIncomingMsg_t *inMsg )
   \                     ZDO_SendMsgCBs:
   1850          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 2,R2
   \   000007   8B..         MOV     ?V0 + 3,R3
   1851            uint8 ret = FALSE;
   \   000009   75..00       MOV     ?V0 + 4,#0x0
   1852            ZDO_MsgCB_t *pList = zdoMsgCBs;
   \   00000C   90....       MOV     DPTR,#zdoMsgCBs
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   F5..         MOV     ?V0 + 0,A
   \   000012   A3           INC     DPTR
   \   000013   E0           MOVX    A,@DPTR
   \   000014   F5..         MOV     ?V0 + 1,A
   \   000016   02....       LJMP    ??ZDO_SendMsgCBs_0 & 0xFFFF
   1853            while ( pList )
   1854            {
   1855              if ( pList->clusterID == inMsg->clusterID )
   \                     ??ZDO_SendMsgCBs_1:
   \   000019   85..82       MOV     DPL,?V0 + 0
   \   00001C   85..83       MOV     DPH,?V0 + 1
   \   00001F   A3           INC     DPTR
   \   000020   A3           INC     DPTR
   \   000021   A3           INC     DPTR
   \   000022   E0           MOVX    A,@DPTR
   \   000023   F8           MOV     R0,A
   \   000024   A3           INC     DPTR
   \   000025   E0           MOVX    A,@DPTR
   \   000026   F9           MOV     R1,A
   \   000027   E5..         MOV     A,?V0 + 2
   \   000029   240C         ADD     A,#0xc
   \   00002B   F582         MOV     DPL,A
   \   00002D   E5..         MOV     A,?V0 + 3
   \   00002F   3400         ADDC    A,#0x0
   \   000031   F583         MOV     DPH,A
   \   000033   E0           MOVX    A,@DPTR
   \   000034   68           XRL     A,R0
   \   000035   7003         JNZ     ??ZDO_SendMsgCBs_2
   \   000037   A3           INC     DPTR
   \   000038   E0           MOVX    A,@DPTR
   \   000039   69           XRL     A,R1
   \                     ??ZDO_SendMsgCBs_2:
   \   00003A   6003         JZ      $+5
   \   00003C   02....       LJMP    ??ZDO_SendMsgCBs_3 & 0xFFFF
   1856              {
   1857                zdoIncomingMsg_t *msgPtr;
   1858          
   1859                // Send the address to the task
   1860                msgPtr = (zdoIncomingMsg_t *)osal_msg_allocate( sizeof( zdoIncomingMsg_t ) + inMsg->asduLen );
   \   00003F                ; Setup parameters for call to function osal_msg_allocate
   \   00003F   E5..         MOV     A,?V0 + 2
   \   000041   2410         ADD     A,#0x10
   \   000043   F582         MOV     DPL,A
   \   000045   E5..         MOV     A,?V0 + 3
   \   000047   3400         ADDC    A,#0x0
   \   000049   F583         MOV     DPH,A
   \   00004B   E0           MOVX    A,@DPTR
   \   00004C   F8           MOV     R0,A
   \   00004D   7900         MOV     R1,#0x0
   \   00004F   2415         ADD     A,#0x15
   \   000051   FA           MOV     R2,A
   \   000052   E9           MOV     A,R1
   \   000053   3400         ADDC    A,#0x0
   \   000055   FB           MOV     R3,A
   \   000056   12....       LCALL   ??osal_msg_allocate?relay
   \   000059   8A..         MOV     ?V0 + 6,R2
   \   00005B   8B..         MOV     ?V0 + 7,R3
   \   00005D   AE..         MOV     R6,?V0 + 6
   \   00005F   AF..         MOV     R7,?V0 + 7
   1861                if ( msgPtr )
   \   000061   EE           MOV     A,R6
   \   000062   4F           ORL     A,R7
   \   000063   7003         JNZ     $+5
   \   000065   02....       LJMP    ??ZDO_SendMsgCBs_3 & 0xFFFF
   1862                {
   1863                  // copy struct
   1864                  osal_memcpy( msgPtr, inMsg, sizeof( zdoIncomingMsg_t ));
   \   000068                ; Setup parameters for call to function osal_memcpy
   \   000068   85....       MOV     ?V0 + 4,?V0 + 2
   \   00006B   85....       MOV     ?V0 + 5,?V0 + 3
   \   00006E   75..00       MOV     ?V0 + 6,#0x0
   \   000071   78..         MOV     R0,#?V0 + 4
   \   000073   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000076   7C15         MOV     R4,#0x15
   \   000078   7D00         MOV     R5,#0x0
   \   00007A   EE           MOV     A,R6
   \   00007B   FA           MOV     R2,A
   \   00007C   EF           MOV     A,R7
   \   00007D   FB           MOV     R3,A
   \   00007E   12....       LCALL   ??osal_memcpy?relay
   \   000081   7403         MOV     A,#0x3
   \   000083   12....       LCALL   ?DEALLOC_XSTACK8
   1865          
   1866                  if ( inMsg->asduLen )
   \   000086   E5..         MOV     A,?V0 + 2
   \   000088   2410         ADD     A,#0x10
   \   00008A   F582         MOV     DPL,A
   \   00008C   E5..         MOV     A,?V0 + 3
   \   00008E   3400         ADDC    A,#0x0
   \   000090   F583         MOV     DPH,A
   \   000092   E0           MOVX    A,@DPTR
   \   000093   6059         JZ      ??ZDO_SendMsgCBs_4
   1867                  {
   1868                    msgPtr->asdu = (byte*)(((byte*)msgPtr) + sizeof( zdoIncomingMsg_t ));
   \   000095   EE           MOV     A,R6
   \   000096   2415         ADD     A,#0x15
   \   000098   F8           MOV     R0,A
   \   000099   EF           MOV     A,R7
   \   00009A   3400         ADDC    A,#0x0
   \   00009C   F9           MOV     R1,A
   \   00009D   EE           MOV     A,R6
   \   00009E   2413         ADD     A,#0x13
   \   0000A0   F582         MOV     DPL,A
   \   0000A2   EF           MOV     A,R7
   \   0000A3   3400         ADDC    A,#0x0
   \   0000A5   F583         MOV     DPH,A
   \   0000A7   E8           MOV     A,R0
   \   0000A8   F0           MOVX    @DPTR,A
   \   0000A9   A3           INC     DPTR
   \   0000AA   E9           MOV     A,R1
   \   0000AB   F0           MOVX    @DPTR,A
   1869                    osal_memcpy( msgPtr->asdu, inMsg->asdu, inMsg->asduLen );
   \   0000AC                ; Setup parameters for call to function osal_memcpy
   \   0000AC   E5..         MOV     A,?V0 + 2
   \   0000AE   2413         ADD     A,#0x13
   \   0000B0   F582         MOV     DPL,A
   \   0000B2   E5..         MOV     A,?V0 + 3
   \   0000B4   3400         ADDC    A,#0x0
   \   0000B6   F583         MOV     DPH,A
   \   0000B8   E0           MOVX    A,@DPTR
   \   0000B9   F5..         MOV     ?V0 + 4,A
   \   0000BB   A3           INC     DPTR
   \   0000BC   E0           MOVX    A,@DPTR
   \   0000BD   F5..         MOV     ?V0 + 5,A
   \   0000BF   75..00       MOV     ?V0 + 6,#0x0
   \   0000C2   78..         MOV     R0,#?V0 + 4
   \   0000C4   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000C7   E5..         MOV     A,?V0 + 2
   \   0000C9   2410         ADD     A,#0x10
   \   0000CB   F582         MOV     DPL,A
   \   0000CD   E5..         MOV     A,?V0 + 3
   \   0000CF   3400         ADDC    A,#0x0
   \   0000D1   F583         MOV     DPH,A
   \   0000D3   E0           MOVX    A,@DPTR
   \   0000D4   FC           MOV     R4,A
   \   0000D5   7D00         MOV     R5,#0x0
   \   0000D7   EE           MOV     A,R6
   \   0000D8   2413         ADD     A,#0x13
   \   0000DA   F582         MOV     DPL,A
   \   0000DC   EF           MOV     A,R7
   \   0000DD   3400         ADDC    A,#0x0
   \   0000DF   F583         MOV     DPH,A
   \   0000E1   E0           MOVX    A,@DPTR
   \   0000E2   FA           MOV     R2,A
   \   0000E3   A3           INC     DPTR
   \   0000E4   E0           MOVX    A,@DPTR
   \   0000E5   FB           MOV     R3,A
   \   0000E6   12....       LCALL   ??osal_memcpy?relay
   \   0000E9   7403         MOV     A,#0x3
   \   0000EB   12....       LCALL   ?DEALLOC_XSTACK8
   1870                  }
   1871          
   1872                  msgPtr->hdr.event = ZDO_CB_MSG;
   \                     ??ZDO_SendMsgCBs_4:
   \   0000EE   8E82         MOV     DPL,R6
   \   0000F0   8F83         MOV     DPH,R7
   \   0000F2   74D3         MOV     A,#-0x2d
   \   0000F4   F0           MOVX    @DPTR,A
   1873                  osal_msg_send( pList->taskID, (uint8 *)msgPtr );
   \   0000F5                ; Setup parameters for call to function osal_msg_send
   \   0000F5   EE           MOV     A,R6
   \   0000F6   FA           MOV     R2,A
   \   0000F7   EF           MOV     A,R7
   \   0000F8   FB           MOV     R3,A
   \   0000F9   85..82       MOV     DPL,?V0 + 0
   \   0000FC   85..83       MOV     DPH,?V0 + 1
   \   0000FF   A3           INC     DPTR
   \   000100   A3           INC     DPTR
   \   000101   E0           MOVX    A,@DPTR
   \   000102   F9           MOV     R1,A
   \   000103   12....       LCALL   ??osal_msg_send?relay
   \   000106   E9           MOV     A,R1
   1874                  ret = TRUE;
   \   000107   75..01       MOV     ?V0 + 4,#0x1
   1875                }
   1876              }
   1877              pList = (ZDO_MsgCB_t *)pList->next;
   \                     ??ZDO_SendMsgCBs_3:
   \   00010A   85..82       MOV     DPL,?V0 + 0
   \   00010D   85..83       MOV     DPH,?V0 + 1
   \   000110   E0           MOVX    A,@DPTR
   \   000111   F5..         MOV     ?V0 + 0,A
   \   000113   A3           INC     DPTR
   \   000114   E0           MOVX    A,@DPTR
   \   000115   F5..         MOV     ?V0 + 1,A
   1878            }
   \                     ??ZDO_SendMsgCBs_0:
   \   000117   E5..         MOV     A,?V0 + 0
   \   000119   45..         ORL     A,?V0 + 1
   \   00011B   6003         JZ      $+5
   \   00011D   02....       LJMP    ??ZDO_SendMsgCBs_1 & 0xFFFF
   1879            return ( ret );
   \   000120   A9..         MOV     R1,?V0 + 4
   \   000122   7F08         MOV     R7,#0x8
   \   000124   02....       LJMP    ?BANKED_LEAVE_XDATA
   1880          }
   1881          
   1882          /*********************************************************************
   1883           * Incoming message processor
   1884           */
   1885          
   1886          /*********************************************************************
   1887           * @fn          ZDP_IncomingData
   1888           *
   1889           * @brief       This function indicates the transfer of a data PDU (ASDU)
   1890           *              from the APS sub-layer to the ZDO.
   1891           *
   1892           * @param       pData - Incoming Message
   1893           *
   1894           * @return      none
   1895           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1896          void ZDP_IncomingData( afIncomingMSGPacket_t *pData )
   \                     ZDP_IncomingData:
   1897          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1898            uint8 x = 0;
   \   00000A   7E00         MOV     R6,#0x0
   1899            uint8 handled;
   1900            zdoIncomingMsg_t inMsg;
   1901          
   1902            inMsg.srcAddr.addrMode = Addr16Bit;
   \   00000C   740A         MOV     A,#0xa
   \   00000E   12....       LCALL   ?XSTACK_DISP0_8
   \   000011   7402         MOV     A,#0x2
   \   000013   F0           MOVX    @DPTR,A
   1903            inMsg.srcAddr.addr.shortAddr = pData->srcAddr.addr.shortAddr;
   \   000014   8A82         MOV     DPL,R2
   \   000016   8B83         MOV     DPH,R3
   \   000018   A3           INC     DPTR
   \   000019   A3           INC     DPTR
   \   00001A   A3           INC     DPTR
   \   00001B   A3           INC     DPTR
   \   00001C   A3           INC     DPTR
   \   00001D   A3           INC     DPTR
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   F8           MOV     R0,A
   \   000020   A3           INC     DPTR
   \   000021   E0           MOVX    A,@DPTR
   \   000022   F9           MOV     R1,A
   \   000023   7402         MOV     A,#0x2
   \   000025   12....       LCALL   ?XSTACK_DISP0_8
   \   000028   E8           MOV     A,R0
   \   000029   F0           MOVX    @DPTR,A
   \   00002A   A3           INC     DPTR
   \   00002B   E9           MOV     A,R1
   \   00002C   F0           MOVX    @DPTR,A
   1904            inMsg.wasBroadcast = pData->wasBroadcast;
   \   00002D   EA           MOV     A,R2
   \   00002E   2415         ADD     A,#0x15
   \   000030   F582         MOV     DPL,A
   \   000032   EB           MOV     A,R3
   \   000033   3400         ADDC    A,#0x0
   \   000035   F583         MOV     DPH,A
   \   000037   E0           MOVX    A,@DPTR
   \   000038   C0E0         PUSH    A
   \   00003A   740B         MOV     A,#0xb
   \   00003C   12....       LCALL   ?XSTACK_DISP0_8
   \   00003F   D0E0         POP     A
   \   000041   F0           MOVX    @DPTR,A
   1905            inMsg.clusterID = pData->clusterId;
   \   000042   8A82         MOV     DPL,R2
   \   000044   8B83         MOV     DPH,R3
   \   000046   A3           INC     DPTR
   \   000047   A3           INC     DPTR
   \   000048   A3           INC     DPTR
   \   000049   A3           INC     DPTR
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   F8           MOV     R0,A
   \   00004C   A3           INC     DPTR
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   F9           MOV     R1,A
   \   00004F   740C         MOV     A,#0xc
   \   000051   12....       LCALL   ?XSTACK_DISP0_8
   \   000054   E8           MOV     A,R0
   \   000055   F0           MOVX    @DPTR,A
   \   000056   A3           INC     DPTR
   \   000057   E9           MOV     A,R1
   \   000058   F0           MOVX    @DPTR,A
   1906            inMsg.SecurityUse = pData->SecurityUse;
   \   000059   EA           MOV     A,R2
   \   00005A   2419         ADD     A,#0x19
   \   00005C   F582         MOV     DPL,A
   \   00005E   EB           MOV     A,R3
   \   00005F   3400         ADDC    A,#0x0
   \   000061   F583         MOV     DPH,A
   \   000063   E0           MOVX    A,@DPTR
   \   000064   C0E0         PUSH    A
   \   000066   740E         MOV     A,#0xe
   \   000068   12....       LCALL   ?XSTACK_DISP0_8
   \   00006B   D0E0         POP     A
   \   00006D   F0           MOVX    @DPTR,A
   1907          
   1908            inMsg.asduLen = pData->cmd.DataLength-1;
   \   00006E   EA           MOV     A,R2
   \   00006F   2420         ADD     A,#0x20
   \   000071   F582         MOV     DPL,A
   \   000073   EB           MOV     A,R3
   \   000074   3400         ADDC    A,#0x0
   \   000076   F583         MOV     DPH,A
   \   000078   E0           MOVX    A,@DPTR
   \   000079   F8           MOV     R0,A
   \   00007A   A3           INC     DPTR
   \   00007B   E0           MOVX    A,@DPTR
   \   00007C   F9           MOV     R1,A
   \   00007D   E8           MOV     A,R0
   \   00007E   24FF         ADD     A,#-0x1
   \   000080   C0E0         PUSH    A
   \   000082   7410         MOV     A,#0x10
   \   000084   12....       LCALL   ?XSTACK_DISP0_8
   \   000087   D0E0         POP     A
   \   000089   F0           MOVX    @DPTR,A
   1909            inMsg.asdu = pData->cmd.Data+1;
   \   00008A   EA           MOV     A,R2
   \   00008B   2422         ADD     A,#0x22
   \   00008D   F582         MOV     DPL,A
   \   00008F   EB           MOV     A,R3
   \   000090   3400         ADDC    A,#0x0
   \   000092   F583         MOV     DPH,A
   \   000094   E0           MOVX    A,@DPTR
   \   000095   2401         ADD     A,#0x1
   \   000097   F8           MOV     R0,A
   \   000098   A3           INC     DPTR
   \   000099   E0           MOVX    A,@DPTR
   \   00009A   3400         ADDC    A,#0x0
   \   00009C   F9           MOV     R1,A
   \   00009D   7413         MOV     A,#0x13
   \   00009F   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A2   E8           MOV     A,R0
   \   0000A3   F0           MOVX    @DPTR,A
   \   0000A4   A3           INC     DPTR
   \   0000A5   E9           MOV     A,R1
   \   0000A6   F0           MOVX    @DPTR,A
   1910            inMsg.TransSeq = pData->cmd.Data[0];
   \   0000A7   EA           MOV     A,R2
   \   0000A8   2422         ADD     A,#0x22
   \   0000AA   F582         MOV     DPL,A
   \   0000AC   EB           MOV     A,R3
   \   0000AD   3400         ADDC    A,#0x0
   \   0000AF   F583         MOV     DPH,A
   \   0000B1   E0           MOVX    A,@DPTR
   \   0000B2   F8           MOV     R0,A
   \   0000B3   A3           INC     DPTR
   \   0000B4   E0           MOVX    A,@DPTR
   \   0000B5   F583         MOV     DPH,A
   \   0000B7   8882         MOV     DPL,R0
   \   0000B9   E0           MOVX    A,@DPTR
   \   0000BA   C0E0         PUSH    A
   \   0000BC   740F         MOV     A,#0xf
   \   0000BE   12....       LCALL   ?XSTACK_DISP0_8
   \   0000C1   D0E0         POP     A
   \   0000C3   F0           MOVX    @DPTR,A
   1911            inMsg.macDestAddr = pData->macDestAddr;
   \   0000C4   EA           MOV     A,R2
   \   0000C5   2412         ADD     A,#0x12
   \   0000C7   F582         MOV     DPL,A
   \   0000C9   EB           MOV     A,R3
   \   0000CA   3400         ADDC    A,#0x0
   \   0000CC   F583         MOV     DPH,A
   \   0000CE   E0           MOVX    A,@DPTR
   \   0000CF   F8           MOV     R0,A
   \   0000D0   A3           INC     DPTR
   \   0000D1   E0           MOVX    A,@DPTR
   \   0000D2   F9           MOV     R1,A
   \   0000D3   7411         MOV     A,#0x11
   \   0000D5   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D8   E8           MOV     A,R0
   \   0000D9   F0           MOVX    @DPTR,A
   \   0000DA   A3           INC     DPTR
   \   0000DB   E9           MOV     A,R1
   \   0000DC   F0           MOVX    @DPTR,A
   1912          
   1913            handled = ZDO_SendMsgCBs( &inMsg );
   \   0000DD                ; Setup parameters for call to function ZDO_SendMsgCBs
   \   0000DD   85..82       MOV     DPL,?XSP + 0
   \   0000E0   85..83       MOV     DPH,?XSP + 1
   \   0000E3   AA82         MOV     R2,DPL
   \   0000E5   AB83         MOV     R3,DPH
   \   0000E7   12....       LCALL   ??ZDO_SendMsgCBs?relay
   \   0000EA   E9           MOV     A,R1
   \   0000EB   FB           MOV     R3,A
   \   0000EC   8001         SJMP    ??ZDP_IncomingData_0
   1914          
   1915          #if (defined MT_ZDO_CB_FUNC)
   1916          #if !defined MT_TASK
   1917            if (zgZdoDirectCB)
   1918          #endif
   1919            {
   1920              MT_ZdoDirectCB( pData, &inMsg );
   1921            }
   1922          #endif
   1923          
   1924            while ( zdpMsgProcs[x].clusterID != 0xFFFF )
   1925            {
   1926              if ( zdpMsgProcs[x].clusterID == inMsg.clusterID )
   1927              {
   1928                zdpMsgProcs[x].pFn( &inMsg );
   1929                return;
   1930              }
   1931              x++;
   \                     ??ZDP_IncomingData_1:
   \   0000EE   0E           INC     R6
   \                     ??ZDP_IncomingData_0:
   \   0000EF   EE           MOV     A,R6
   \   0000F0   F8           MOV     R0,A
   \   0000F1   7900         MOV     R1,#0x0
   \   0000F3   E8           MOV     A,R0
   \   0000F4   75F004       MOV     B,#0x4
   \   0000F7   A4           MUL     AB
   \   0000F8   C8           XCH     A,R0
   \   0000F9   AAF0         MOV     R2,B
   \   0000FB   75F000       MOV     B,#0x0
   \   0000FE   A4           MUL     AB
   \   0000FF   2A           ADD     A,R2
   \   000100   FA           MOV     R2,A
   \   000101   75F004       MOV     B,#0x4
   \   000104   E9           MOV     A,R1
   \   000105   A4           MUL     AB
   \   000106   2A           ADD     A,R2
   \   000107   F9           MOV     R1,A
   \   000108   74..         MOV     A,#zdpMsgProcs & 0xff
   \   00010A   28           ADD     A,R0
   \   00010B   F582         MOV     DPL,A
   \   00010D   74..         MOV     A,#(zdpMsgProcs >> 8) & 0xff
   \   00010F   39           ADDC    A,R1
   \   000110   F583         MOV     DPH,A
   \   000112   E4           CLR     A
   \   000113   93           MOVC    A,@A+DPTR
   \   000114   F8           MOV     R0,A
   \   000115   7401         MOV     A,#0x1
   \   000117   93           MOVC    A,@A+DPTR
   \   000118   F9           MOV     R1,A
   \   000119   74FF         MOV     A,#-0x1
   \   00011B   68           XRL     A,R0
   \   00011C   7003         JNZ     ??ZDP_IncomingData_2
   \   00011E   74FF         MOV     A,#-0x1
   \   000120   69           XRL     A,R1
   \                     ??ZDP_IncomingData_2:
   \   000121   6075         JZ      ??ZDP_IncomingData_3
   \   000123   EE           MOV     A,R6
   \   000124   F8           MOV     R0,A
   \   000125   7900         MOV     R1,#0x0
   \   000127   E8           MOV     A,R0
   \   000128   75F004       MOV     B,#0x4
   \   00012B   A4           MUL     AB
   \   00012C   C8           XCH     A,R0
   \   00012D   AAF0         MOV     R2,B
   \   00012F   75F000       MOV     B,#0x0
   \   000132   A4           MUL     AB
   \   000133   2A           ADD     A,R2
   \   000134   FA           MOV     R2,A
   \   000135   75F004       MOV     B,#0x4
   \   000138   E9           MOV     A,R1
   \   000139   A4           MUL     AB
   \   00013A   2A           ADD     A,R2
   \   00013B   F9           MOV     R1,A
   \   00013C   74..         MOV     A,#zdpMsgProcs & 0xff
   \   00013E   28           ADD     A,R0
   \   00013F   F582         MOV     DPL,A
   \   000141   74..         MOV     A,#(zdpMsgProcs >> 8) & 0xff
   \   000143   39           ADDC    A,R1
   \   000144   F583         MOV     DPH,A
   \   000146   E4           CLR     A
   \   000147   93           MOVC    A,@A+DPTR
   \   000148   F8           MOV     R0,A
   \   000149   7401         MOV     A,#0x1
   \   00014B   93           MOVC    A,@A+DPTR
   \   00014C   F9           MOV     R1,A
   \   00014D   740C         MOV     A,#0xc
   \   00014F   12....       LCALL   ?XSTACK_DISP0_8
   \   000152   E0           MOVX    A,@DPTR
   \   000153   68           XRL     A,R0
   \   000154   7003         JNZ     ??ZDP_IncomingData_4
   \   000156   A3           INC     DPTR
   \   000157   E0           MOVX    A,@DPTR
   \   000158   69           XRL     A,R1
   \                     ??ZDP_IncomingData_4:
   \   000159   7093         JNZ     ??ZDP_IncomingData_1
   \   00015B                ; Setup parameters for indirect call
   \   00015B   85..82       MOV     DPL,?XSP + 0
   \   00015E   85..83       MOV     DPH,?XSP + 1
   \   000161   AA82         MOV     R2,DPL
   \   000163   AB83         MOV     R3,DPH
   \   000165   EE           MOV     A,R6
   \   000166   F8           MOV     R0,A
   \   000167   7900         MOV     R1,#0x0
   \   000169   E8           MOV     A,R0
   \   00016A   75F004       MOV     B,#0x4
   \   00016D   A4           MUL     AB
   \   00016E   C8           XCH     A,R0
   \   00016F   ACF0         MOV     R4,B
   \   000171   75F000       MOV     B,#0x0
   \   000174   A4           MUL     AB
   \   000175   2C           ADD     A,R4
   \   000176   FC           MOV     R4,A
   \   000177   75F004       MOV     B,#0x4
   \   00017A   E9           MOV     A,R1
   \   00017B   A4           MUL     AB
   \   00017C   2C           ADD     A,R4
   \   00017D   F9           MOV     R1,A
   \   00017E   74..         MOV     A,#(zdpMsgProcs + 2) & 0xff
   \   000180   28           ADD     A,R0
   \   000181   F582         MOV     DPL,A
   \   000183   74..         MOV     A,#((zdpMsgProcs + 2) >> 8) & 0xff
   \   000185   39           ADDC    A,R1
   \   000186   F583         MOV     DPH,A
   \   000188   E4           CLR     A
   \   000189   93           MOVC    A,@A+DPTR
   \   00018A   C0E0         PUSH    A
   \   00018C   7401         MOV     A,#0x1
   \   00018E   93           MOVC    A,@A+DPTR
   \   00018F   F583         MOV     DPH,A
   \   000191   D082         POP     DPL
   \   000193   12....       LCALL   ?CALL_IND
   \   000196   8010         SJMP    ??ZDP_IncomingData_5
   1932            }
   1933          
   1934            // Handle unhandled messages
   1935            if ( !handled )
   \                     ??ZDP_IncomingData_3:
   \   000198   EB           MOV     A,R3
   \   000199   700D         JNZ     ??ZDP_IncomingData_5
   1936              ZDApp_InMsgCB( &inMsg );
   \   00019B                ; Setup parameters for call to function ZDApp_InMsgCB
   \   00019B   85..82       MOV     DPL,?XSP + 0
   \   00019E   85..83       MOV     DPH,?XSP + 1
   \   0001A1   AA82         MOV     R2,DPL
   \   0001A3   AB83         MOV     R3,DPH
   \   0001A5   12....       LCALL   ??ZDApp_InMsgCB?relay
   1937          }
   \                     ??ZDP_IncomingData_5:
   \   0001A8   7415         MOV     A,#0x15
   \   0001AA   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001AD   7F01         MOV     R7,#0x1
   \   0001AF   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for ZDP_TmpBuf>`:
   \   000000   ....         DW ZDP_Buf + 1H

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??fillAndSend?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    fillAndSend

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_SendData?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_SendData

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_NWKAddrOfInterestReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_NWKAddrOfInterestReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_NwkAddrReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_NwkAddrReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_IEEEAddrReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_IEEEAddrReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_MatchDescReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_MatchDescReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_SimpleDescReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_SimpleDescReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_UserDescSet?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_UserDescSet

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_ServerDiscReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_ServerDiscReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_DeviceAnnce?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_DeviceAnnce

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zdpProcessAddrReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zdpProcessAddrReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_NodeDescMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_NodeDescMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_PowerDescMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_PowerDescMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_SimpleDescMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_SimpleDescMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_EPRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_EPRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_UserDescRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_UserDescRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_ServerDiscRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_ServerDiscRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_GenericRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_GenericRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_EndDeviceBindReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_EndDeviceBindReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_BindUnbindReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_BindUnbindReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_MgmtNwkDiscReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_MgmtNwkDiscReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_MgmtDirectJoinReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_MgmtDirectJoinReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_MgmtPermitJoinReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_MgmtPermitJoinReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_MgmtLeaveReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_MgmtLeaveReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_MgmtNwkUpdateReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_MgmtNwkUpdateReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_MgmtNwkDiscRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_MgmtNwkDiscRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_MgmtLqiRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_MgmtLqiRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_MgmtRtgRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_MgmtRtgRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_MgmtBindRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_MgmtBindRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_MgmtNwkUpdateNotify?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_MgmtNwkUpdateNotify

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_RegisterForZDOMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_RegisterForZDOMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_RemoveRegisteredCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_RemoveRegisteredCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_SendMsgCBs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_SendMsgCBs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDP_IncomingData?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDP_IncomingData
   1938          
   1939          /*********************************************************************
   1940          *********************************************************************/
   1941          

   Maximum stack usage in bytes:

     Function                 ISTACK PSTACK XSTACK
     --------                 ------ ------ ------
     ZDO_RegisterForZDOMsg        1      0     14
       -> osal_mem_alloc          0      0     28
     ZDO_RemoveRegisteredCB       0      0      9
       -> osal_mem_free           0      0     18
     ZDO_SendMsgCBs               0      0     49
       -> osal_msg_allocate       0      0     32
       -> osal_memcpy             0      0     38
       -> osal_memcpy             0      0     38
       -> osal_msg_send           0      0     32
     ZDP_BindUnbindReq            1      0     30
       -> sAddrExtCpy             0      0     40
       -> sAddrExtCpy             0      0     40
       -> fillAndSend             0      0     44
     ZDP_DeviceAnnce              1      0     22
       -> sAddrExtCpy             0      0     38
       -> fillAndSend             0      0     42
     ZDP_EPRsp                    1      0     29
       -> osal_memcpy             0      0     44
       -> fillAndSend             0      0     42
     ZDP_EndDeviceBindReq         1      0     37
       -> NLME_GetShortAddr       0      0     52
       -> NLME_GetExtAddr         0      0     52
       -> sAddrExtCpy             0      0     52
       -> fillAndSend             0      0     56
     ZDP_GenericRsp               1      0     17
       -> fillAndSend             0      0     26
     ZDP_IEEEAddrReq              1      0     23
       -> fillAndSend             0      0     46
     ZDP_IncomingData             1      0     30
       -> ZDO_SendMsgCBs          0      0     60
       -> ZDApp_InMsgCB           0      0     60
     ZDP_MatchDescReq             1      0     29
       -> fillAndSend             0      0     42
     ZDP_MgmtBindRsp              1      0     30
       -> osal_mem_alloc          0      0     46
       -> sAddrExtCpy             0      0     46
       -> sAddrExtCpy             0      0     46
       -> fillAndSend             0      0     50
       -> osal_mem_free           0      0     46
     ZDP_MgmtDirectJoinReq        1      0     15
       -> sAddrExtCpy             0      0     24
       -> fillAndSend             0      0     28
     ZDP_MgmtLeaveReq             0      0     16
       -> sAddrExtCpy             0      0     24
       -> fillAndSend             0      0     28
     ZDP_MgmtLqiRsp               1      0     29
       -> fillAndSend             0      0     48
       -> osal_mem_alloc          0      0     44
       -> sAddrExtCpy             0      0     44
       -> sAddrExtCpy             0      0     44
       -> fillAndSend             0      0     48
       -> osal_mem_free           0      0     44
     ZDP_MgmtNwkDiscReq           1      0     23
       -> osal_buffer_uint32      0      0     38
       -> fillAndSend             0      0     34
     ZDP_MgmtNwkDiscRsp           1      0     30
       -> osal_mem_alloc          0      0     46
       -> sAddrExtCpy             0      0     46
       -> fillAndSend             0      0     50
       -> osal_mem_free           0      0     46
     ZDP_MgmtNwkUpdateNotify      1      0     43
       -> osal_mem_alloc          0      0     54
       -> osal_buffer_uint32      0      0     62
       -> osal_memcpy             0      0     60
       -> fillAndSend             0      0     58
       -> osal_mem_free           0      0     54
     ZDP_MgmtNwkUpdateReq         1      0     28
       -> osal_buffer_uint32      0      0     44
       -> fillAndSend             0      0     40
     ZDP_MgmtPermitJoinReq        1      0     12
       -> fillAndSend             0      0     24
     ZDP_MgmtRtgRsp               1      0     27
       -> osal_mem_alloc          0      0     40
       -> fillAndSend             0      0     44
       -> osal_mem_free           0      0     40
     ZDP_NWKAddrOfInterestReq     1      0     13
       -> fillAndSend             0      0     24
     ZDP_NodeDescMsg              1      0     16
       -> fillAndSend             0      0     28
     ZDP_NwkAddrReq               1      0     24
       -> sAddrExtCmp             0      0     44
       -> sAddrExtCpy             0      0     44
       -> fillAndSend             0      0     48
     ZDP_PowerDescMsg             1      0     16
       -> fillAndSend             0      0     28
     ZDP_SendData                 1      0     21
       -> fillAndSend             0      0     32
     ZDP_ServerDiscReq            1      0     21
       -> fillAndSend             0      0     42
     ZDP_ServerDiscRsp            1      0     19
       -> fillAndSend             0      0     30
     ZDP_SimpleDescMsg            1      0     16
       -> fillAndSend             0      0     32
     ZDP_SimpleDescReq            1      0     13
       -> fillAndSend             0      0     24
     ZDP_UserDescRsp              1      0     25
       -> osal_memcpy             0      0     44
       -> fillAndSend             0      0     42
     ZDP_UserDescSet              1      0     20
       -> osal_memcpy             0      0     36
       -> osal_memset             0      0     30
       -> fillAndSend             0      0     34
     fillAndSend                  1      0     64
       -> osal_memset             0      0     52
       -> AF_DataRequest          0      0     70
     zdpProcessAddrReq            1      0     18
       -> sAddrExtCmp             0      0     32
       -> sAddrExtCpy             0      0     32
       -> fillAndSend             0      0     36


   Segment part sizes:

     Function/Label                   Bytes
     --------------                   -----
     ZDP_AF_ENDPOINT                     1
     ZDP_TransID                         1
     ZDP_Buf                            80
     ZDP_TmpBuf                          2
     ZDP_TxOptions                       1
     zdoMsgCBs                           2
     zdpMsgProcs                        40
     fillAndSend                       233
     ZDP_SendData                      138
     ZDP_NWKAddrOfInterestReq           77
     ZDP_NwkAddrReq                    191
     ZDP_IEEEAddrReq                   153
     ZDP_MatchDescReq                  611
     ZDP_SimpleDescReq                  97
     ZDP_UserDescSet                   241
     ZDP_ServerDiscReq                 129
     ZDP_DeviceAnnce                   158
     zdpProcessAddrReq                 508
     ZDP_NodeDescMsg                   464
     ZDP_PowerDescMsg                  211
     ZDP_SimpleDescMsg                 942
     ZDP_EPRsp                         246
     ZDP_UserDescRsp                   243
     ZDP_ServerDiscRsp                 146
     ZDP_GenericRsp                    153
     ZDP_EndDeviceBindReq              610
     ZDP_BindUnbindReq                 366
     ZDP_MgmtNwkDiscReq                116
     ZDP_MgmtDirectJoinReq              80
     ZDP_MgmtPermitJoinReq              78
     ZDP_MgmtLeaveReq                  144
     ZDP_MgmtNwkUpdateReq              222
     ZDP_MgmtNwkDiscRsp                502
     ZDP_MgmtLqiRsp                    635
     ZDP_MgmtRtgRsp                    432
     ZDP_MgmtBindRsp                   577
     ZDP_MgmtNwkUpdateNotify           412
     ZDO_RegisterForZDOMsg             172
     ZDO_RemoveRegisteredCB            148
     ZDO_SendMsgCBs                    295
     ZDP_IncomingData                  434
     ?<Initializer for ZDP_TmpBuf>       2
     ??fillAndSend?relay                 6
     ??ZDP_SendData?relay                6
     ??ZDP_NWKAddrOfInterestReq?relay    6
     ??ZDP_NwkAddrReq?relay              6
     ??ZDP_IEEEAddrReq?relay             6
     ??ZDP_MatchDescReq?relay            6
     ??ZDP_SimpleDescReq?relay           6
     ??ZDP_UserDescSet?relay             6
     ??ZDP_ServerDiscReq?relay           6
     ??ZDP_DeviceAnnce?relay             6
     ??zdpProcessAddrReq?relay           6
     ??ZDP_NodeDescMsg?relay             6
     ??ZDP_PowerDescMsg?relay            6
     ??ZDP_SimpleDescMsg?relay           6
     ??ZDP_EPRsp?relay                   6
     ??ZDP_UserDescRsp?relay             6
     ??ZDP_ServerDiscRsp?relay           6
     ??ZDP_GenericRsp?relay              6
     ??ZDP_EndDeviceBindReq?relay        6
     ??ZDP_BindUnbindReq?relay           6
     ??ZDP_MgmtNwkDiscReq?relay          6
     ??ZDP_MgmtDirectJoinReq?relay       6
     ??ZDP_MgmtPermitJoinReq?relay       6
     ??ZDP_MgmtLeaveReq?relay            6
     ??ZDP_MgmtNwkUpdateReq?relay        6
     ??ZDP_MgmtNwkDiscRsp?relay          6
     ??ZDP_MgmtLqiRsp?relay              6
     ??ZDP_MgmtRtgRsp?relay              6
     ??ZDP_MgmtBindRsp?relay             6
     ??ZDP_MgmtNwkUpdateNotify?relay     6
     ??ZDO_RegisterForZDOMsg?relay       6
     ??ZDO_RemoveRegisteredCB?relay      6
     ??ZDO_SendMsgCBs?relay              6
     ??ZDP_IncomingData?relay            6

 
 10 164 bytes in segment BANKED_CODE
    204 bytes in segment BANK_RELAYS
     41 bytes in segment CODE_C
      2 bytes in segment XDATA_I
      2 bytes in segment XDATA_ID
     84 bytes in segment XDATA_Z
 
 10 411 bytes of CODE  memory
     86 bytes of XDATA memory

Errors: none
Warnings: none
