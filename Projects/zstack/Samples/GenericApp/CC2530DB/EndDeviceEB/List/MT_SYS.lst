###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         25/Aug/2018  23:10:09 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  F:\work\iot-hardware\logger\logger\Components\mt\M #
#                          T_SYS.c                                            #
#    Command line       =  -f F:\work\iot-hardware\logger\logger\Projects\zst #
#                          ack\Samples\GenericApp\CC2530DB\..\..\..\Tools\CC2 #
#                          530DB\f8wEndev.cfg (-DCPU32MHZ -DROOT=__near_func  #
#                          -DMAC_CFG_TX_DATA_MAX=3 -DMAC_CFG_TX_MAX=6         #
#                          -DMAC_CFG_RX_MAX=3) -f F:\work\iot-hardware\logger #
#                          \logger\Projects\zstack\Samples\GenericApp\CC2530D #
#                          B\..\..\..\Tools\CC2530DB\f8wConfig.cfg            #
#                          (-DZIGBEEPRO -DSECURE=0 -DZG_SECURE_DYNAMIC=0      #
#                          -DREFLECTOR -DDEFAULT_CHANLIST=0x00000800          #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 F:\work\iot-hardware\logger #
#                          \logger\Components\mt\MT_SYS.c -D NWK_AUTO_POLL    #
#                          -D ZTOOL_P1 -D MT_TASK -D MT_SYS_FUNC -D           #
#                          MT_ZDO_FUNC -D LCD_SUPPORTED=DEBUG -D              #
#                          xPOWER_SAVING -lC F:\work\iot-hardware\logger\logg #
#                          er\Projects\zstack\Samples\GenericApp\CC2530DB\End #
#                          DeviceEB\List\ -lA F:\work\iot-hardware\logger\log #
#                          ger\Projects\zstack\Samples\GenericApp\CC2530DB\En #
#                          dDeviceEB\List\ --diag_suppress Pe001,Pa010 -o     #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\EndDeviceEB\Obj\ -e   #
#                          --no_cse --no_unroll --no_inline --no_code_motion  #
#                          --no_tbaa --debug --core=plain --dptr=16,1         #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I F:\work\iot-hardware\logger\logger\Projects\zst #
#                          ack\Samples\GenericApp\CC2530DB\ -I                #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\Source\ -I         #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\ZMain\TI2530 #
#                          DB\ -I F:\work\iot-hardware\logger\logger\Projects #
#                          \zstack\Samples\GenericApp\CC2530DB\..\..\..\..\.. #
#                          \Components\hal\include\ -I                        #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\hal\target\CC2530EB\ -I                       #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\mac\include\ -I F:\work\iot-hardware\logger\l #
#                          ogger\Projects\zstack\Samples\GenericApp\CC2530DB\ #
#                          ..\..\..\..\..\Components\mac\high_level\ -I       #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\mac\low_level\srf04\ -I                       #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\mac\low_level\srf04\single_chip\ -I           #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\mt\ -I F:\work\iot-hardware\logger\logger\Pro #
#                          jects\zstack\Samples\GenericApp\CC2530DB\..\..\..\ #
#                          ..\..\Components\osal\include\ -I                  #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\services\saddr\ -I F:\work\iot-hardware\logge #
#                          r\logger\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\Components\services\sdata\ -I    #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\stack\af\ -I F:\work\iot-hardware\logger\logg #
#                          er\Projects\zstack\Samples\GenericApp\CC2530DB\..\ #
#                          ..\..\..\..\Components\stack\nwk\ -I               #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\stack\sapi\ -I F:\work\iot-hardware\logger\lo #
#                          gger\Projects\zstack\Samples\GenericApp\CC2530DB\. #
#                          .\..\..\..\..\Components\stack\sec\ -I             #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\stack\sys\ -I F:\work\iot-hardware\logger\log #
#                          ger\Projects\zstack\Samples\GenericApp\CC2530DB\.. #
#                          \..\..\..\..\Components\stack\zdo\ -I              #
#                          F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\zmac\ -I F:\work\iot-hardware\logger\logger\P #
#                          rojects\zstack\Samples\GenericApp\CC2530DB\..\..\. #
#                          .\..\..\Components\zmac\f8w\ -Ol                   #
#                          --require_prototypes                               #
#    List file          =  F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\EndDeviceEB\List\MT_S #
#                          YS.lst                                             #
#    Object file        =  F:\work\iot-hardware\logger\logger\Projects\zstack #
#                          \Samples\GenericApp\CC2530DB\EndDeviceEB\Obj\MT_SY #
#                          S.r51                                              #
#                                                                             #
#                                                                             #
###############################################################################

F:\work\iot-hardware\logger\logger\Components\mt\MT_SYS.c
      1          /******************************************************************************
      2            Filename:       MT_SYS.c
      3            Revised:        $Date: 2012-03-07 01:04:58 -0800 (Wed, 07 Mar 2012) $
      4            Revision:       $Revision: 29656 $
      5          
      6            Description:   MonitorTest functions for SYS commands.
      7          
      8            Copyright 2007-2012 Texas Instruments Incorporated. All rights reserved.
      9          
     10            IMPORTANT: Your use of this Software is limited to those specific rights
     11            granted under the terms of a software license agreement between the user
     12            who downloaded the software, his/her employer (which must be your employer)
     13            and Texas Instruments Incorporated (the "License"). You may not use this
     14            Software unless you agree to abide by the terms of the License. The License
     15            limits your use, and you acknowledge, that the Software may not be modified,
     16            copied or distributed unless embedded on a Texas Instruments microcontroller
     17            or used solely and exclusively in conjunction with a Texas Instruments radio
     18            frequency transceiver, which is integrated into your product. Other than for
     19            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     20            works of, modify, distribute, perform, display or sell this Software and/or
     21            its documentation for any purpose.
     22          
     23            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     24            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     25            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     26            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     27            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     28            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     29            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     30            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     31            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     32            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     33            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     34          
     35            Should you have any questions regarding your right to use this Software,
     36            contact Texas Instruments Incorporated at www.TI.com.
     37          
     38           *****************************************************************************/
     39          
     40          /***************************************************************************************************
     41           * INCLUDES
     42           ***************************************************************************************************/
     43          #include "ZComDef.h"
     44          #include "MT.h"
     45          #include "MT_SYS.h"
     46          #include "MT_VERSION.h"
     47          #include "nwk_util.h"
     48          #include "OSAL.h"
     49          #include "OSAL_NV.h"
     50          #include "Onboard.h"  /* This is here because RAM read/write macros need it */

   \                                 In  segment SFR_AN, at 0x9d
   \   unsigned char volatile __sfr SLEEPSTA
   \                     SLEEPSTA:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xa8
   \   union <unnamed> volatile __sfr _A_IEN0
   \                     _A_IEN0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xc9
   \   unsigned char volatile __sfr WDCTL
   \                     WDCTL:
   \   000000                DS 1
     51          #include "hal_adc.h"
     52          #include "ZGlobals.h"
     53          #include "OSAL_Clock.h"
     54          #include "mac_low_level.h"
     55          
     56          /***************************************************************************************************
     57           * MACROS
     58           ***************************************************************************************************/
     59          
     60          #define MT_SYS_DEVICE_INFO_RESPONSE_LEN 14
     61          #define MT_NV_ITEM_MAX_LENGTH           250
     62          
     63          #if !defined HAL_GPIO || !HAL_GPIO
     64          #define GPIO_DIR_IN(IDX)
     65          #define GPIO_DIR_OUT(IDX)
     66          #define GPIO_TRI(IDX)
     67          #define GPIO_PULL_UP(IDX)
     68          #define GPIO_PULL_DN(IDX)
     69          #define GPIO_SET(IDX)
     70          #define GPIO_CLR(IDX)
     71          #define GPIO_TOG(IDX)
     72          #define GPIO_GET(IDX) 0
     73          #define GPIO_HiD_SET() (val = 0)
     74          #define GPIO_HiD_CLR() (val = 0)
     75          #endif
     76          
     77          /***************************************************************************************************
     78           * CONSTANTS
     79           ***************************************************************************************************/
     80          
     81          #if !defined MT_SYS_OSAL_NV_READ_CERTIFICATE_DATA
     82          #define MT_SYS_OSAL_NV_READ_CERTIFICATE_DATA  FALSE
     83          #endif
     84          

   \                                 In  segment XDATA_ROM_C, align 1
     85          const uint16 MT_SysOsalEventId [] = {
   \                     MT_SysOsalEventId:
   \   000000   0008         DW 2048
   \   000002   0004         DW 1024
   \   000004   0002         DW 512
   \   000006   0001         DW 256
     86                                                MT_SYS_OSAL_EVENT_0,
     87                                                MT_SYS_OSAL_EVENT_1,
     88                                                MT_SYS_OSAL_EVENT_2,
     89                                                MT_SYS_OSAL_EVENT_3
     90                                              };
     91          
     92          typedef enum {
     93            GPIO_DIR,
     94            GPIO_TRI,
     95            GPIO_SET,
     96            GPIO_CLR,
     97            GPIO_TOG,
     98            GPIO_GET,
     99            GPIO_HiD = 0x12
    100          } GPIO_Op_t;
    101          
    102          /***************************************************************************************************
    103           * LOCAL FUNCTIONS
    104           ***************************************************************************************************/
    105          #if defined (MT_SYS_FUNC)
    106          void MT_SysReset(uint8 *pBuf);
    107          void MT_SysPing(void);
    108          void MT_SysVersion(void);
    109          void MT_SysSetExtAddr(uint8 *pBuf);
    110          void MT_SysGetExtAddr(void);
    111          void MT_SysOsalNVItemInit(uint8 *pBuf);
    112          void MT_SysOsalNVDelete(uint8 *pBuf);
    113          void MT_SysOsalNVLength(uint8 *pBuf);
    114          void MT_SysOsalNVRead(uint8 *pBuf);
    115          void MT_SysOsalNVWrite(uint8 *pBuf);
    116          void MT_SysOsalStartTimer(uint8 *pBuf);
    117          void MT_SysOsalStopTimer(uint8 *pBuf);
    118          void MT_SysRandom(void);
    119          void MT_SysAdcRead(uint8 *pBuf);
    120          void MT_SysGpio(uint8 *pBuf);
    121          void MT_SysStackTune(uint8 *pBuf);
    122          void MT_SysGetDeviceInfo(uint8 *pBuf);
    123          void MT_SysSetUtcTime(uint8 *pBuf);
    124          void MT_SysGetUtcTime(void);
    125          void MT_SysSetTxPower(uint8 *pBuf);
    126          #endif /* MT_SYS_FUNC */
    127          
    128          #if defined (MT_SYS_FUNC)
    129          /***************************************************************************************************
    130           * @fn      MT_SysProcessing
    131           *
    132           * @brief   Process all the SYS commands that are issued by test tool
    133           *
    134           * @param   pBuf - pointer to the msg buffer
    135           *
    136           *          | LEN  | CMD0  | CMD1  |  DATA  |
    137           *          |  1   |   1   |   1   |  0-255 |
    138           *
    139           * @return  status
    140           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    141          uint8 MT_SysCommandProcessing(uint8 *pBuf)
   \                     MT_SysCommandProcessing:
    142          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    143            uint8 status = MT_RPC_SUCCESS;
   \   000005   7E00         MOV     R6,#0x0
    144          
    145            switch (pBuf[MT_RPC_POS_CMD1])
   \   000007   8A82         MOV     DPL,R2
   \   000009   8B83         MOV     DPH,R3
   \   00000B   A3           INC     DPTR
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   12....       LCALL   ?UC_SWITCH_DENSE
   \                     `?<Jumptable for MT_SysCommandProcessing>_0`:
   \   000011   00           DB        0
   \   000012   14           DB        20
   \   000013   ....         DW        ??MT_SysCommandProcessing_0
   \   000015   ....         DW        ??MT_SysCommandProcessing_1
   \   000017   ....         DW        ??MT_SysCommandProcessing_2
   \   000019   ....         DW        ??MT_SysCommandProcessing_3
   \   00001B   ....         DW        ??MT_SysCommandProcessing_4
   \   00001D   ....         DW        ??MT_SysCommandProcessing_5
   \   00001F   ....         DW        ??MT_SysCommandProcessing_0
   \   000021   ....         DW        ??MT_SysCommandProcessing_0
   \   000023   ....         DW        ??MT_SysCommandProcessing_6
   \   000025   ....         DW        ??MT_SysCommandProcessing_7
   \   000027   ....         DW        ??MT_SysCommandProcessing_8
   \   000029   ....         DW        ??MT_SysCommandProcessing_9
   \   00002B   ....         DW        ??MT_SysCommandProcessing_10
   \   00002D   ....         DW        ??MT_SysCommandProcessing_11
   \   00002F   ....         DW        ??MT_SysCommandProcessing_12
   \   000031   ....         DW        ??MT_SysCommandProcessing_13
   \   000033   ....         DW        ??MT_SysCommandProcessing_14
   \   000035   ....         DW        ??MT_SysCommandProcessing_15
   \   000037   ....         DW        ??MT_SysCommandProcessing_16
   \   000039   ....         DW        ??MT_SysCommandProcessing_17
   \   00003B   ....         DW        ??MT_SysCommandProcessing_18
   \   00003D   ....         DW        ??MT_SysCommandProcessing_19
    146            {
    147              case MT_SYS_RESET_REQ:
    148                MT_SysReset(pBuf);
   \                     ??MT_SysCommandProcessing_1:
   \   00003F                ; Setup parameters for call to function MT_SysReset
   \   00003F   12....       LCALL   ??MT_SysReset?relay
    149                break;
   \   000042   805C         SJMP    ??MT_SysCommandProcessing_20
    150          
    151              case MT_SYS_PING:
    152                MT_SysPing();
   \                     ??MT_SysCommandProcessing_2:
   \   000044                ; Setup parameters for call to function MT_SysPing
   \   000044   12....       LCALL   ??MT_SysPing?relay
    153                break;
   \   000047   8057         SJMP    ??MT_SysCommandProcessing_20
    154          
    155              case MT_SYS_VERSION:
    156                MT_SysVersion();
   \                     ??MT_SysCommandProcessing_3:
   \   000049                ; Setup parameters for call to function MT_SysVersion
   \   000049   12....       LCALL   ??MT_SysVersion?relay
    157                break;
   \   00004C   8052         SJMP    ??MT_SysCommandProcessing_20
    158          
    159              case MT_SYS_SET_EXTADDR:
    160                MT_SysSetExtAddr(pBuf);
   \                     ??MT_SysCommandProcessing_4:
   \   00004E                ; Setup parameters for call to function MT_SysSetExtAddr
   \   00004E   12....       LCALL   ??MT_SysSetExtAddr?relay
    161                break;
   \   000051   804D         SJMP    ??MT_SysCommandProcessing_20
    162          
    163              case MT_SYS_GET_EXTADDR:
    164                MT_SysGetExtAddr();
   \                     ??MT_SysCommandProcessing_5:
   \   000053                ; Setup parameters for call to function MT_SysGetExtAddr
   \   000053   12....       LCALL   ??MT_SysGetExtAddr?relay
    165                break;
   \   000056   8048         SJMP    ??MT_SysCommandProcessing_20
    166          
    167          // CC253X MAC Network Processor does not have NV support
    168          #if !defined(CC253X_MACNP)
    169              case MT_SYS_OSAL_NV_DELETE:
    170                MT_SysOsalNVDelete(pBuf);
   \                     ??MT_SysCommandProcessing_17:
   \   000058                ; Setup parameters for call to function MT_SysOsalNVDelete
   \   000058   12....       LCALL   ??MT_SysOsalNVDelete?relay
    171                break;
   \   00005B   8043         SJMP    ??MT_SysCommandProcessing_20
    172          
    173              case MT_SYS_OSAL_NV_ITEM_INIT:
    174                MT_SysOsalNVItemInit(pBuf);
   \                     ??MT_SysCommandProcessing_6:
   \   00005D                ; Setup parameters for call to function MT_SysOsalNVItemInit
   \   00005D   12....       LCALL   ??MT_SysOsalNVItemInit?relay
    175                break;
   \   000060   803E         SJMP    ??MT_SysCommandProcessing_20
    176          
    177              case MT_SYS_OSAL_NV_LENGTH:
    178                MT_SysOsalNVLength(pBuf);
   \                     ??MT_SysCommandProcessing_18:
   \   000062                ; Setup parameters for call to function MT_SysOsalNVLength
   \   000062   12....       LCALL   ??MT_SysOsalNVLength?relay
    179                break;
   \   000065   8039         SJMP    ??MT_SysCommandProcessing_20
    180          
    181              case MT_SYS_OSAL_NV_READ:
    182                MT_SysOsalNVRead(pBuf);
   \                     ??MT_SysCommandProcessing_7:
   \   000067                ; Setup parameters for call to function MT_SysOsalNVRead
   \   000067   12....       LCALL   ??MT_SysOsalNVRead?relay
    183                break;
   \   00006A   8034         SJMP    ??MT_SysCommandProcessing_20
    184          
    185              case MT_SYS_OSAL_NV_WRITE:
    186                MT_SysOsalNVWrite(pBuf);
   \                     ??MT_SysCommandProcessing_8:
   \   00006C                ; Setup parameters for call to function MT_SysOsalNVWrite
   \   00006C   12....       LCALL   ??MT_SysOsalNVWrite?relay
    187                break;
   \   00006F   802F         SJMP    ??MT_SysCommandProcessing_20
    188          #endif
    189          
    190              case MT_SYS_OSAL_START_TIMER:
    191                MT_SysOsalStartTimer(pBuf);
   \                     ??MT_SysCommandProcessing_9:
   \   000071                ; Setup parameters for call to function MT_SysOsalStartTimer
   \   000071   12....       LCALL   ??MT_SysOsalStartTimer?relay
    192                break;
   \   000074   802A         SJMP    ??MT_SysCommandProcessing_20
    193          
    194              case MT_SYS_OSAL_STOP_TIMER:
    195                MT_SysOsalStopTimer(pBuf);
   \                     ??MT_SysCommandProcessing_10:
   \   000076                ; Setup parameters for call to function MT_SysOsalStopTimer
   \   000076   12....       LCALL   ??MT_SysOsalStopTimer?relay
    196                break;
   \   000079   8025         SJMP    ??MT_SysCommandProcessing_20
    197          
    198              case MT_SYS_RANDOM:
    199                MT_SysRandom();
   \                     ??MT_SysCommandProcessing_11:
   \   00007B                ; Setup parameters for call to function MT_SysRandom
   \   00007B   12....       LCALL   ??MT_SysRandom?relay
    200                break;
   \   00007E   8020         SJMP    ??MT_SysCommandProcessing_20
    201          
    202              case MT_SYS_ADC_READ:
    203                MT_SysAdcRead(pBuf);
   \                     ??MT_SysCommandProcessing_12:
   \   000080                ; Setup parameters for call to function MT_SysAdcRead
   \   000080   12....       LCALL   ??MT_SysAdcRead?relay
    204                break;
   \   000083   801B         SJMP    ??MT_SysCommandProcessing_20
    205          
    206              case MT_SYS_GPIO:
    207                MT_SysGpio(pBuf);
   \                     ??MT_SysCommandProcessing_13:
   \   000085                ; Setup parameters for call to function MT_SysGpio
   \   000085   12....       LCALL   ??MT_SysGpio?relay
    208                break;
   \   000088   8016         SJMP    ??MT_SysCommandProcessing_20
    209          
    210              case MT_SYS_STACK_TUNE:
    211                MT_SysStackTune(pBuf);
   \                     ??MT_SysCommandProcessing_14:
   \   00008A                ; Setup parameters for call to function MT_SysStackTune
   \   00008A   12....       LCALL   ??MT_SysStackTune?relay
    212                break;
   \   00008D   8011         SJMP    ??MT_SysCommandProcessing_20
    213          
    214              case MT_SYS_SET_TIME:
    215                MT_SysSetUtcTime(pBuf);
   \                     ??MT_SysCommandProcessing_15:
   \   00008F                ; Setup parameters for call to function MT_SysSetUtcTime
   \   00008F   12....       LCALL   ??MT_SysSetUtcTime?relay
    216                break;
   \   000092   800C         SJMP    ??MT_SysCommandProcessing_20
    217          
    218              case MT_SYS_GET_TIME:
    219                MT_SysGetUtcTime();
   \                     ??MT_SysCommandProcessing_16:
   \   000094                ; Setup parameters for call to function MT_SysGetUtcTime
   \   000094   12....       LCALL   ??MT_SysGetUtcTime?relay
    220                break;
   \   000097   8007         SJMP    ??MT_SysCommandProcessing_20
    221          
    222              case MT_SYS_SET_TX_POWER:
    223                MT_SysSetTxPower(pBuf);
   \                     ??MT_SysCommandProcessing_19:
   \   000099                ; Setup parameters for call to function MT_SysSetTxPower
   \   000099   12....       LCALL   ??MT_SysSetTxPower?relay
    224                break;
   \   00009C   8002         SJMP    ??MT_SysCommandProcessing_20
    225          
    226              default:
    227                status = MT_RPC_ERR_COMMAND_ID;
   \                     ??MT_SysCommandProcessing_0:
   \   00009E   7E02         MOV     R6,#0x2
    228                break;
    229            }
    230          
    231            return status;
   \                     ??MT_SysCommandProcessing_20:
   \   0000A0   EE           MOV     A,R6
   \   0000A1   F9           MOV     R1,A
   \   0000A2   7F01         MOV     R7,#0x1
   \   0000A4   02....       LJMP    ?BANKED_LEAVE_XDATA
    232          }
    233          
    234          /**************************************************************************************************
    235           * @fn      MT_SysReset
    236           *
    237           * @brief   Reset the device.
    238           * @param   typID: 0=reset, 1=serial bootloader
    239           *
    240           * @return  None
    241           *************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    242          void MT_SysReset(uint8 *pBuf)
   \                     MT_SysReset:
    243          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    244            if (pBuf[MT_RPC_POS_DAT0] == 0)
   \   000004   8A82         MOV     DPL,R2
   \   000006   8B83         MOV     DPH,R3
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   700C         JNZ     ??MT_SysReset_0
    245            {
    246              SystemReset();
   \   00000E   C2AF         CLR     0xa8.7
   \   000010   C2AF         CLR     0xa8.7
   \   000012   75C9AB       MOV     0xc9,#-0x55
   \   000015   75C95B       MOV     0xc9,#0x5b
   \                     ??MT_SysReset_1:
   \   000018   80FE         SJMP    ??MT_SysReset_1
    247            }
    248          #if !(defined(HAL_BOARD_F2618) || defined(HAL_BOARD_F5438) || defined(HAL_BOARD_LM3S))
    249            else
    250            {
    251              SystemResetSoft();  // Especially useful for CC2531 to not break comm with USB Host.
   \                     ??MT_SysReset_0:
   \   00001A                ; Setup parameters for call to function Onboard_soft_reset
   \   00001A   12....       LCALL   Onboard_soft_reset & 0xFFFF
    252            }
    253          #endif
    254          
    255          }
   \   00001D   D083         POP     DPH
   \   00001F   D082         POP     DPL
   \   000021   02....       LJMP    ?BRET
   \   000024                REQUIRE _A_IEN0
   \   000024                REQUIRE WDCTL
    256          
    257          /***************************************************************************************************
    258           * @fn      MT_SysPing
    259           *
    260           * @brief   Process the Ping command
    261           *
    262           * @param   None
    263           *
    264           * @return  None
    265           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    266          void MT_SysPing(void)
   \                     MT_SysPing:
    267          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 2
   \   000004   74FE         MOV     A,#-0x2
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
    268            uint16 tmp16;
    269            uint8 retArray[2];
    270          
    271            /* Build Capabilities */
    272            tmp16 = MT_CAP_SYS | MT_CAP_MAC | MT_CAP_NWK | MT_CAP_AF | MT_CAP_ZDO |
    273                    MT_CAP_SAPI | MT_CAP_UTIL | MT_CAP_DEBUG | MT_CAP_APP | MT_CAP_ZOAD;
   \   000009   7811         MOV     R0,#0x11
   \   00000B   7900         MOV     R1,#0x0
    274          
    275            /* Convert to high byte first into temp buffer */
    276            retArray[0] = LO_UINT16( tmp16 );
   \   00000D   E8           MOV     A,R0
   \   00000E   85..82       MOV     DPL,?XSP + 0
   \   000011   85..83       MOV     DPH,?XSP + 1
   \   000014   F0           MOVX    @DPTR,A
    277            retArray[1] = HI_UINT16( tmp16 );
   \   000015   E4           CLR     A
   \   000016   E9           MOV     A,R1
   \   000017   F8           MOV     R0,A
   \   000018   C0E0         PUSH    A
   \   00001A   7401         MOV     A,#0x1
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   D0E0         POP     A
   \   000021   F0           MOVX    @DPTR,A
    278          
    279            /* Build and send back the response */
    280            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS), MT_SYS_PING,
    281                                          sizeof (tmp16), retArray );
   \   000022                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000022   85..82       MOV     DPL,?XSP + 0
   \   000025   85..83       MOV     DPH,?XSP + 1
   \   000028   AC82         MOV     R4,DPL
   \   00002A   AD83         MOV     R5,DPH
   \   00002C   7B02         MOV     R3,#0x2
   \   00002E   7A01         MOV     R2,#0x1
   \   000030   7961         MOV     R1,#0x61
   \   000032   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    282          }
   \   000035   7402         MOV     A,#0x2
   \   000037   12....       LCALL   ?DEALLOC_XSTACK8
   \   00003A   D083         POP     DPH
   \   00003C   D082         POP     DPL
   \   00003E   02....       LJMP    ?BRET
    283          
    284          /***************************************************************************************************
    285           * @fn      MT_SysVersion
    286           *
    287           * @brief   Process the Version command
    288           *
    289           * @param   None
    290           *
    291           * @return  None
    292           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    293          void MT_SysVersion(void)
   \                     MT_SysVersion:
    294          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    295            byte *verStr = (byte *)MTVersionString;
   \   000004   7C..         MOV     R4,#MTVersionString & 0xff
   \   000006   7D..         MOV     R5,#(MTVersionString >> 8) & 0xff
    296            uint8 respLen = sizeof(MTVersionString);
   \   000008   7B05         MOV     R3,#0x5
    297          
    298            /* Build and send back the response */
    299            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS), MT_SYS_VERSION,
    300                                         respLen, verStr);
   \   00000A                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00000A   7A02         MOV     R2,#0x2
   \   00000C   7961         MOV     R1,#0x61
   \   00000E   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    301          }
   \   000011   D083         POP     DPH
   \   000013   D082         POP     DPL
   \   000015   02....       LJMP    ?BRET
    302          
    303          /***************************************************************************************************
    304           * @fn      MT_SysSetExtAddr
    305           *
    306           * @brief   Set the Extended Address
    307           *
    308           * @param   pBuf
    309           *
    310           * @return  None
    311           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    312          void MT_SysSetExtAddr(uint8 *pBuf)
   \                     MT_SysSetExtAddr:
    313          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
    314            uint8 retValue = ZFailure;
   \   00000E   85..82       MOV     DPL,?XSP + 0
   \   000011   85..83       MOV     DPH,?XSP + 1
   \   000014   7401         MOV     A,#0x1
   \   000016   F0           MOVX    @DPTR,A
    315            uint8 cmdId;
    316          
    317            /* parse header */
    318            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   000017   85..82       MOV     DPL,?V0 + 0
   \   00001A   85..83       MOV     DPH,?V0 + 1
   \   00001D   A3           INC     DPTR
   \   00001E   A3           INC     DPTR
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   FE           MOV     R6,A
    319            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000021   E5..         MOV     A,?V0 + 0
   \   000023   2403         ADD     A,#0x3
   \   000025   F5..         MOV     ?V0 + 0,A
   \   000027   E5..         MOV     A,?V0 + 1
   \   000029   3400         ADDC    A,#0x0
   \   00002B   F5..         MOV     ?V0 + 1,A
    320          
    321            if ( ZMacSetReq(ZMacExtAddr, pBuf) == ZMacSuccess )
   \   00002D                ; Setup parameters for call to function ZMacSetReq
   \   00002D   AA..         MOV     R2,?V0 + 0
   \   00002F   AB..         MOV     R3,?V0 + 1
   \   000031   79E2         MOV     R1,#-0x1e
   \   000033   12....       LCALL   ??ZMacSetReq?relay
   \   000036   E9           MOV     A,R1
   \   000037   7028         JNZ     ??MT_SysSetExtAddr_0
    322            {
    323          // CC253X MAC Network Processor does not have NV support
    324          #if !defined(CC253X_MACNP)
    325              retValue = osal_nv_write(ZCD_NV_EXTADDR, 0, Z_EXTADDR_LEN, pBuf);
   \   000039                ; Setup parameters for call to function osal_nv_write
   \   000039   78..         MOV     R0,#?V0 + 0
   \   00003B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003E   75..08       MOV     ?V0 + 0,#0x8
   \   000041   75..00       MOV     ?V0 + 1,#0x0
   \   000044   78..         MOV     R0,#?V0 + 0
   \   000046   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000049   7C00         MOV     R4,#0x0
   \   00004B   7D00         MOV     R5,#0x0
   \   00004D   7A01         MOV     R2,#0x1
   \   00004F   7B00         MOV     R3,#0x0
   \   000051   12....       LCALL   ??osal_nv_write?relay
   \   000054   7404         MOV     A,#0x4
   \   000056   12....       LCALL   ?DEALLOC_XSTACK8
   \   000059   E9           MOV     A,R1
   \   00005A   85..82       MOV     DPL,?XSP + 0
   \   00005D   85..83       MOV     DPH,?XSP + 1
   \   000060   F0           MOVX    @DPTR,A
    326          #endif
    327            }
    328          
    329            /* Build and send back the response */
    330            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS), cmdId, 1, &retValue);
   \                     ??MT_SysSetExtAddr_0:
   \   000061                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000061   85..82       MOV     DPL,?XSP + 0
   \   000064   85..83       MOV     DPH,?XSP + 1
   \   000067   AC82         MOV     R4,DPL
   \   000069   AD83         MOV     R5,DPH
   \   00006B   7B01         MOV     R3,#0x1
   \   00006D   EE           MOV     A,R6
   \   00006E   FA           MOV     R2,A
   \   00006F   7961         MOV     R1,#0x61
   \   000071   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    331          
    332          }
   \   000074   7401         MOV     A,#0x1
   \   000076   12....       LCALL   ?DEALLOC_XSTACK8
   \   000079   7F02         MOV     R7,#0x2
   \   00007B   02....       LJMP    ?BANKED_LEAVE_XDATA
    333          
    334          /***************************************************************************************************
    335           * @fn      MT_SysGetExtAddr
    336           *
    337           * @brief   Get the Extended Address
    338           *
    339           * @param   None
    340           *
    341           * @return  None
    342           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    343          void MT_SysGetExtAddr(void)
   \                     MT_SysGetExtAddr:
    344          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 8
   \   000004   74F8         MOV     A,#-0x8
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
    345            uint8 extAddr[Z_EXTADDR_LEN];
    346          
    347            ZMacGetReq( ZMacExtAddr, extAddr );
   \   000009                ; Setup parameters for call to function ZMacGetReq
   \   000009   85..82       MOV     DPL,?XSP + 0
   \   00000C   85..83       MOV     DPH,?XSP + 1
   \   00000F   AA82         MOV     R2,DPL
   \   000011   AB83         MOV     R3,DPH
   \   000013   79E2         MOV     R1,#-0x1e
   \   000015   12....       LCALL   ??ZMacGetReq?relay
   \   000018   E9           MOV     A,R1
    348          
    349            /* Build and send back the response */
    350            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS), MT_SYS_GET_EXTADDR,
    351                                         Z_EXTADDR_LEN, extAddr);
   \   000019                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000019   85..82       MOV     DPL,?XSP + 0
   \   00001C   85..83       MOV     DPH,?XSP + 1
   \   00001F   AC82         MOV     R4,DPL
   \   000021   AD83         MOV     R5,DPH
   \   000023   7B08         MOV     R3,#0x8
   \   000025   7A04         MOV     R2,#0x4
   \   000027   7961         MOV     R1,#0x61
   \   000029   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    352          }
   \   00002C   7408         MOV     A,#0x8
   \   00002E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000031   D083         POP     DPH
   \   000033   D082         POP     DPL
   \   000035   02....       LJMP    ?BRET
    353          
    354          /***************************************************************************************************
    355           * @fn      MT_SysOsalNVRead
    356           *
    357           * @brief  Read a NV value
    358           *
    359           * @param  uint8 pBuf - pointer to the data
    360           *
    361           * @return  None
    362           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    363          void MT_SysOsalNVRead(uint8 *pBuf)
   \                     MT_SysOsalNVRead:
    364          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 4
   \   000005   74FC         MOV     A,#-0x4
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    365            uint16 nvId;
    366            uint8 nvItemLen=0, nvItemOffset=0;
   \   00000A   75..00       MOV     ?V0 + 3,#0x0
   \   00000D   75..00       MOV     ?V0 + 2,#0x0
    367            uint8 *pRetBuf=NULL;
   \   000010   7E00         MOV     R6,#0x0
   \   000012   7F00         MOV     R7,#0x0
    368            uint8 respLen;
    369          
    370            /* Skip over RPC header */
    371            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000014   EA           MOV     A,R2
   \   000015   2403         ADD     A,#0x3
   \   000017   FA           MOV     R2,A
   \   000018   EB           MOV     A,R3
   \   000019   3400         ADDC    A,#0x0
   \   00001B   FB           MOV     R3,A
    372          
    373            /* Get the ID */
    374            nvId = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   00001C   8A82         MOV     DPL,R2
   \   00001E   8B83         MOV     DPH,R3
   \   000020   E0           MOVX    A,@DPTR
   \   000021   FC           MOV     R4,A
   \   000022   7D00         MOV     R5,#0x0
   \   000024   8A82         MOV     DPL,R2
   \   000026   8B83         MOV     DPH,R3
   \   000028   A3           INC     DPTR
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F8           MOV     R0,A
   \   00002B   7900         MOV     R1,#0x0
   \   00002D   E4           CLR     A
   \   00002E   C8           XCH     A,R0
   \   00002F   F9           MOV     R1,A
   \   000030   EC           MOV     A,R4
   \   000031   28           ADD     A,R0
   \   000032   F5..         MOV     ?V0 + 0,A
   \   000034   ED           MOV     A,R5
   \   000035   39           ADDC    A,R1
   \   000036   F5..         MOV     ?V0 + 1,A
    375            /* Get the offset */
    376            nvItemOffset = pBuf[2];
   \   000038   8A82         MOV     DPL,R2
   \   00003A   8B83         MOV     DPH,R3
   \   00003C   A3           INC     DPTR
   \   00003D   A3           INC     DPTR
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   F5..         MOV     ?V0 + 2,A
    377          
    378          #if !MT_SYS_OSAL_NV_READ_CERTIFICATE_DATA
    379            if ((ZCD_NV_IMPLICIT_CERTIFICATE == nvId) ||
    380                (ZCD_NV_CA_PUBLIC_KEY == nvId)        ||
    381                (ZCD_NV_DEVICE_PRIVATE_KEY == nvId))
   \   000041   7469         MOV     A,#0x69
   \   000043   65..         XRL     A,?V0 + 0
   \   000045   7004         JNZ     ??MT_SysOsalNVRead_0
   \   000047   7400         MOV     A,#0x0
   \   000049   65..         XRL     A,?V0 + 1
   \                     ??MT_SysOsalNVRead_0:
   \   00004B   6018         JZ      ??MT_SysOsalNVRead_1
   \   00004D   746B         MOV     A,#0x6b
   \   00004F   65..         XRL     A,?V0 + 0
   \   000051   7004         JNZ     ??MT_SysOsalNVRead_2
   \   000053   7400         MOV     A,#0x0
   \   000055   65..         XRL     A,?V0 + 1
   \                     ??MT_SysOsalNVRead_2:
   \   000057   600C         JZ      ??MT_SysOsalNVRead_1
   \   000059   746A         MOV     A,#0x6a
   \   00005B   65..         XRL     A,?V0 + 0
   \   00005D   7004         JNZ     ??MT_SysOsalNVRead_3
   \   00005F   7400         MOV     A,#0x0
   \   000061   65..         XRL     A,?V0 + 1
   \                     ??MT_SysOsalNVRead_3:
   \   000063   702E         JNZ     ??MT_SysOsalNVRead_4
    382            {
    383              uint8 tmp[2] = { INVALIDPARAMETER, 0 };
   \                     ??MT_SysOsalNVRead_1:
   \   000065   90....       MOV     DPTR,#`?<Constant {2, 0}>`
   \   000068   C082         PUSH    DPL
   \   00006A   C083         PUSH    DPH
   \   00006C   7402         MOV     A,#0x2
   \   00006E   12....       LCALL   ?XSTACK_DISP0_8
   \   000071   AC82         MOV     R4,DPL
   \   000073   AD83         MOV     R5,DPH
   \   000075   D083         POP     DPH
   \   000077   D082         POP     DPL
   \   000079   7402         MOV     A,#0x2
   \   00007B   12....       LCALL   ?MOVE_LONG8_XDATA_XDATA
    384              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS),
    385                                             MT_SYS_OSAL_NV_READ, 2, tmp);
   \   00007E                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00007E   7402         MOV     A,#0x2
   \   000080   12....       LCALL   ?XSTACK_DISP0_8
   \   000083   AC82         MOV     R4,DPL
   \   000085   AD83         MOV     R5,DPH
   \   000087   7B02         MOV     R3,#0x2
   \   000089   7A08         MOV     R2,#0x8
   \   00008B   7961         MOV     R1,#0x61
   \   00008D   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    386              return;
   \   000090   02....       LJMP    ??MT_SysOsalNVRead_5 & 0xFFFF
    387            }
    388          #endif
    389          
    390          #if !MT_SYS_KEY_MANAGEMENT
    391            if ( (nvId == ZCD_NV_NWK_ACTIVE_KEY_INFO) ||
    392                 (nvId == ZCD_NV_NWK_ALTERN_KEY_INFO) ||
    393                ((nvId >= ZCD_NV_TCLK_TABLE_START) && (nvId <= ZCD_NV_TCLK_TABLE_END)) ||
    394                ((nvId >= ZCD_NV_APS_LINK_KEY_DATA_START) && (nvId <= ZCD_NV_APS_LINK_KEY_DATA_END)) ||
    395                ((nvId >= ZCD_NV_MASTER_KEY_DATA_START) && (nvId <= ZCD_NV_MASTER_KEY_DATA_END)) ||
    396                 (nvId == ZCD_NV_PRECFGKEY) )
   \                     ??MT_SysOsalNVRead_4:
   \   000093   743A         MOV     A,#0x3a
   \   000095   65..         XRL     A,?V0 + 0
   \   000097   7004         JNZ     ??MT_SysOsalNVRead_6
   \   000099   7400         MOV     A,#0x0
   \   00009B   65..         XRL     A,?V0 + 1
   \                     ??MT_SysOsalNVRead_6:
   \   00009D   6054         JZ      ??MT_SysOsalNVRead_7
   \   00009F   743B         MOV     A,#0x3b
   \   0000A1   65..         XRL     A,?V0 + 0
   \   0000A3   7004         JNZ     ??MT_SysOsalNVRead_8
   \   0000A5   7400         MOV     A,#0x0
   \   0000A7   65..         XRL     A,?V0 + 1
   \                     ??MT_SysOsalNVRead_8:
   \   0000A9   6048         JZ      ??MT_SysOsalNVRead_7
   \   0000AB   E5..         MOV     A,?V0 + 0
   \   0000AD   C3           CLR     C
   \   0000AE   9401         SUBB    A,#0x1
   \   0000B0   F8           MOV     R0,A
   \   0000B1   E5..         MOV     A,?V0 + 1
   \   0000B3   9401         SUBB    A,#0x1
   \   0000B5   F9           MOV     R1,A
   \   0000B6   C3           CLR     C
   \   0000B7   E8           MOV     A,R0
   \   0000B8   94FF         SUBB    A,#-0x1
   \   0000BA   E9           MOV     A,R1
   \   0000BB   9400         SUBB    A,#0x0
   \   0000BD   4034         JC      ??MT_SysOsalNVRead_7
   \   0000BF   E5..         MOV     A,?V0 + 0
   \   0000C1   C3           CLR     C
   \   0000C2   9401         SUBB    A,#0x1
   \   0000C4   F8           MOV     R0,A
   \   0000C5   E5..         MOV     A,?V0 + 1
   \   0000C7   9402         SUBB    A,#0x2
   \   0000C9   F9           MOV     R1,A
   \   0000CA   C3           CLR     C
   \   0000CB   E8           MOV     A,R0
   \   0000CC   94FF         SUBB    A,#-0x1
   \   0000CE   E9           MOV     A,R1
   \   0000CF   9400         SUBB    A,#0x0
   \   0000D1   4020         JC      ??MT_SysOsalNVRead_7
   \   0000D3   E5..         MOV     A,?V0 + 0
   \   0000D5   C3           CLR     C
   \   0000D6   9401         SUBB    A,#0x1
   \   0000D8   F8           MOV     R0,A
   \   0000D9   E5..         MOV     A,?V0 + 1
   \   0000DB   9403         SUBB    A,#0x3
   \   0000DD   F9           MOV     R1,A
   \   0000DE   C3           CLR     C
   \   0000DF   E8           MOV     A,R0
   \   0000E0   94FF         SUBB    A,#-0x1
   \   0000E2   E9           MOV     A,R1
   \   0000E3   9400         SUBB    A,#0x0
   \   0000E5   400C         JC      ??MT_SysOsalNVRead_7
   \   0000E7   7462         MOV     A,#0x62
   \   0000E9   65..         XRL     A,?V0 + 0
   \   0000EB   7004         JNZ     ??MT_SysOsalNVRead_9
   \   0000ED   7400         MOV     A,#0x0
   \   0000EF   65..         XRL     A,?V0 + 1
   \                     ??MT_SysOsalNVRead_9:
   \   0000F1   7030         JNZ     ??MT_SysOsalNVRead_10
    397            {
    398              uint8 tmp1[2] = { INVALIDPARAMETER, 0 };
   \                     ??MT_SysOsalNVRead_7:
   \   0000F3   90....       MOV     DPTR,#`?<Constant {2, 0}>_1`
   \   0000F6   C082         PUSH    DPL
   \   0000F8   C083         PUSH    DPH
   \   0000FA   85..82       MOV     DPL,?XSP + 0
   \   0000FD   85..83       MOV     DPH,?XSP + 1
   \   000100   AC82         MOV     R4,DPL
   \   000102   AD83         MOV     R5,DPH
   \   000104   D083         POP     DPH
   \   000106   D082         POP     DPL
   \   000108   7402         MOV     A,#0x2
   \   00010A   12....       LCALL   ?MOVE_LONG8_XDATA_XDATA
    399              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS),
    400                                             MT_SYS_OSAL_NV_READ, 2, tmp1);
   \   00010D                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00010D   85..82       MOV     DPL,?XSP + 0
   \   000110   85..83       MOV     DPH,?XSP + 1
   \   000113   AC82         MOV     R4,DPL
   \   000115   AD83         MOV     R5,DPH
   \   000117   7B02         MOV     R3,#0x2
   \   000119   7A08         MOV     R2,#0x8
   \   00011B   7961         MOV     R1,#0x61
   \   00011D   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    401              return;
   \   000120   02....       LJMP    ??MT_SysOsalNVRead_5 & 0xFFFF
    402            }
    403          #endif //!MT_SYS_KEY_MANAGEMENT
    404          
    405            nvItemLen = osal_nv_item_len(nvId);
   \                     ??MT_SysOsalNVRead_10:
   \   000123                ; Setup parameters for call to function osal_nv_item_len
   \   000123   AA..         MOV     R2,?V0 + 0
   \   000125   AB..         MOV     R3,?V0 + 1
   \   000127   12....       LCALL   ??osal_nv_item_len?relay
   \   00012A   EA           MOV     A,R2
   \   00012B   F5..         MOV     ?V0 + 3,A
    406          
    407            /* Return only 250 bytes max */
    408            if (nvItemLen > MT_NV_ITEM_MAX_LENGTH)
   \   00012D   E5..         MOV     A,?V0 + 3
   \   00012F   C3           CLR     C
   \   000130   94FB         SUBB    A,#-0x5
   \   000132   4003         JC      ??MT_SysOsalNVRead_11
    409            {
    410              nvItemLen = MT_NV_ITEM_MAX_LENGTH;
   \   000134   75..FA       MOV     ?V0 + 3,#-0x6
    411            }
    412          
    413            if ((nvItemLen > 0) && ((nvItemLen - nvItemOffset) > 0))
   \                     ??MT_SysOsalNVRead_11:
   \   000137   E5..         MOV     A,?V0 + 3
   \   000139   C3           CLR     C
   \   00013A   9401         SUBB    A,#0x1
   \   00013C   4030         JC      ??MT_SysOsalNVRead_12
   \   00013E   85....       MOV     ?V0 + 6,?V0 + 3
   \   000141   75..00       MOV     ?V0 + 7,#0x0
   \   000144   85....       MOV     ?V0 + 4,?V0 + 2
   \   000147   75..00       MOV     ?V0 + 5,#0x0
   \   00014A   E5..         MOV     A,?V0 + 6
   \   00014C   C3           CLR     C
   \   00014D   95..         SUBB    A,?V0 + 4
   \   00014F   F8           MOV     R0,A
   \   000150   E5..         MOV     A,?V0 + 7
   \   000152   95..         SUBB    A,?V0 + 5
   \   000154   F9           MOV     R1,A
   \   000155   C3           CLR     C
   \   000156   E8           MOV     A,R0
   \   000157   9401         SUBB    A,#0x1
   \   000159   E9           MOV     A,R1
   \   00015A   9400         SUBB    A,#0x0
   \   00015C   A2D2         MOV     C,0xD0 /* PSW */.2
   \   00015E   65D0         XRL     A,PSW
   \   000160   33           RLC     A
   \   000161   400B         JC      ??MT_SysOsalNVRead_12
    414            {
    415              respLen = nvItemLen - nvItemOffset + 2;
   \   000163   E5..         MOV     A,?V0 + 3
   \   000165   C3           CLR     C
   \   000166   95..         SUBB    A,?V0 + 2
   \   000168   2402         ADD     A,#0x2
   \   00016A   F5..         MOV     ?V0 + 6,A
   \   00016C   8003         SJMP    ??MT_SysOsalNVRead_13
    416            }
    417            else
    418            {
    419              respLen = 2;
   \                     ??MT_SysOsalNVRead_12:
   \   00016E   75..02       MOV     ?V0 + 6,#0x2
    420            }
    421          
    422            pRetBuf = osal_mem_alloc(respLen);
   \                     ??MT_SysOsalNVRead_13:
   \   000171                ; Setup parameters for call to function osal_mem_alloc
   \   000171   85....       MOV     ?V0 + 4,?V0 + 6
   \   000174   75..00       MOV     ?V0 + 5,#0x0
   \   000177   AA..         MOV     R2,?V0 + 4
   \   000179   AB..         MOV     R3,?V0 + 5
   \   00017B   12....       LCALL   ??osal_mem_alloc?relay
   \   00017E   8A..         MOV     ?V0 + 4,R2
   \   000180   8B..         MOV     ?V0 + 5,R3
   \   000182   AE..         MOV     R6,?V0 + 4
   \   000184   AF..         MOV     R7,?V0 + 5
    423          
    424            if (pRetBuf != NULL)
   \   000186   EE           MOV     A,R6
   \   000187   4F           ORL     A,R7
   \   000188   7003         JNZ     $+5
   \   00018A   02....       LJMP    ??MT_SysOsalNVRead_5 & 0xFFFF
    425            {
    426              osal_memset(pRetBuf, 0, respLen);
   \   00018D                ; Setup parameters for call to function osal_memset
   \   00018D   85....       MOV     ?V0 + 4,?V0 + 6
   \   000190   75..00       MOV     ?V0 + 5,#0x0
   \   000193   AC..         MOV     R4,?V0 + 4
   \   000195   AD..         MOV     R5,?V0 + 5
   \   000197   7900         MOV     R1,#0x0
   \   000199   EE           MOV     A,R6
   \   00019A   FA           MOV     R2,A
   \   00019B   EF           MOV     A,R7
   \   00019C   FB           MOV     R3,A
   \   00019D   12....       LCALL   ??osal_memset?relay
    427          
    428              /* Default to ZFailure */
    429              pRetBuf[0] = ZFailure;
   \   0001A0   8E82         MOV     DPL,R6
   \   0001A2   8F83         MOV     DPH,R7
   \   0001A4   7401         MOV     A,#0x1
   \   0001A6   F0           MOVX    @DPTR,A
    430          
    431              if (respLen > 2)
   \   0001A7   E5..         MOV     A,?V0 + 6
   \   0001A9   C3           CLR     C
   \   0001AA   9403         SUBB    A,#0x3
   \   0001AC   404E         JC      ??MT_SysOsalNVRead_14
    432              {
    433                if (((osal_nv_read( nvId, (uint16)nvItemOffset, (uint16)nvItemLen, &pRetBuf[2])) == ZSUCCESS) && (respLen > 2))
   \   0001AE                ; Setup parameters for call to function osal_nv_read
   \   0001AE   EE           MOV     A,R6
   \   0001AF   2402         ADD     A,#0x2
   \   0001B1   F5..         MOV     ?V0 + 4,A
   \   0001B3   EF           MOV     A,R7
   \   0001B4   3400         ADDC    A,#0x0
   \   0001B6   F5..         MOV     ?V0 + 5,A
   \   0001B8   78..         MOV     R0,#?V0 + 4
   \   0001BA   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001BD   85....       MOV     ?V0 + 4,?V0 + 3
   \   0001C0   75..00       MOV     ?V0 + 5,#0x0
   \   0001C3   78..         MOV     R0,#?V0 + 4
   \   0001C5   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001C8   85....       MOV     ?V0 + 4,?V0 + 2
   \   0001CB   75..00       MOV     ?V0 + 5,#0x0
   \   0001CE   AC..         MOV     R4,?V0 + 4
   \   0001D0   AD..         MOV     R5,?V0 + 5
   \   0001D2   AA..         MOV     R2,?V0 + 0
   \   0001D4   AB..         MOV     R3,?V0 + 1
   \   0001D6   12....       LCALL   ??osal_nv_read?relay
   \   0001D9   7404         MOV     A,#0x4
   \   0001DB   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001DE   E9           MOV     A,R1
   \   0001DF   700E         JNZ     ??MT_SysOsalNVRead_15
   \   0001E1   E5..         MOV     A,?V0 + 6
   \   0001E3   C3           CLR     C
   \   0001E4   9403         SUBB    A,#0x3
   \   0001E6   4007         JC      ??MT_SysOsalNVRead_15
    434                {
    435                  pRetBuf[0] = ZSuccess;
   \   0001E8   8E82         MOV     DPL,R6
   \   0001EA   8F83         MOV     DPH,R7
   \   0001EC   7400         MOV     A,#0x0
   \   0001EE   F0           MOVX    @DPTR,A
    436                }
    437                pRetBuf[1] = nvItemLen - nvItemOffset;
   \                     ??MT_SysOsalNVRead_15:
   \   0001EF   E5..         MOV     A,?V0 + 3
   \   0001F1   C3           CLR     C
   \   0001F2   95..         SUBB    A,?V0 + 2
   \   0001F4   8E82         MOV     DPL,R6
   \   0001F6   8F83         MOV     DPH,R7
   \   0001F8   A3           INC     DPTR
   \   0001F9   F0           MOVX    @DPTR,A
   \   0001FA   8008         SJMP    ??MT_SysOsalNVRead_16
    438              }
    439              else
    440              {
    441                pRetBuf[1] = 0;
   \                     ??MT_SysOsalNVRead_14:
   \   0001FC   8E82         MOV     DPL,R6
   \   0001FE   8F83         MOV     DPH,R7
   \   000200   A3           INC     DPTR
   \   000201   7400         MOV     A,#0x0
   \   000203   F0           MOVX    @DPTR,A
    442              }
    443          
    444              /* Build and send back the response */
    445              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS),
    446                                             MT_SYS_OSAL_NV_READ, respLen, pRetBuf );
   \                     ??MT_SysOsalNVRead_16:
   \   000204                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000204   EE           MOV     A,R6
   \   000205   FC           MOV     R4,A
   \   000206   EF           MOV     A,R7
   \   000207   FD           MOV     R5,A
   \   000208   AB..         MOV     R3,?V0 + 6
   \   00020A   7A08         MOV     R2,#0x8
   \   00020C   7961         MOV     R1,#0x61
   \   00020E   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    447          
    448              osal_mem_free(pRetBuf);
   \   000211                ; Setup parameters for call to function osal_mem_free
   \   000211   EE           MOV     A,R6
   \   000212   FA           MOV     R2,A
   \   000213   EF           MOV     A,R7
   \   000214   FB           MOV     R3,A
   \   000215   12....       LCALL   ??osal_mem_free?relay
    449            }
    450          }
   \                     ??MT_SysOsalNVRead_5:
   \   000218   7404         MOV     A,#0x4
   \   00021A   12....       LCALL   ?DEALLOC_XSTACK8
   \   00021D   7F08         MOV     R7,#0x8
   \   00021F   02....       LJMP    ?BANKED_LEAVE_XDATA
    451          
    452          /***************************************************************************************************
    453           * @fn      MT_SysOsalNVWrite
    454           *
    455           * @brief
    456           *
    457           * @param   uint8 pData - pointer to the data
    458           *
    459           * @return  None
    460           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    461          void MT_SysOsalNVWrite(uint8 *pBuf)
   \                     MT_SysOsalNVWrite:
    462          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
    463            uint16 nvId;
    464            uint8 nvItemLen=0, nvItemOffset=0;
   \   00000E   75..00       MOV     ?V0 + 4,#0x0
   \   000011   75..00       MOV     ?V0 + 6,#0x0
    465            uint8 rtrn;
    466          
    467            /* Skip over RPC header */
    468            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000014   E5..         MOV     A,?V0 + 0
   \   000016   2403         ADD     A,#0x3
   \   000018   F5..         MOV     ?V0 + 0,A
   \   00001A   E5..         MOV     A,?V0 + 1
   \   00001C   3400         ADDC    A,#0x0
   \   00001E   F5..         MOV     ?V0 + 1,A
    469          
    470            /* Get the ID */
    471            nvId = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   000020   85..82       MOV     DPL,?V0 + 0
   \   000023   85..83       MOV     DPH,?V0 + 1
   \   000026   E0           MOVX    A,@DPTR
   \   000027   FA           MOV     R2,A
   \   000028   7B00         MOV     R3,#0x0
   \   00002A   85..82       MOV     DPL,?V0 + 0
   \   00002D   85..83       MOV     DPH,?V0 + 1
   \   000030   A3           INC     DPTR
   \   000031   E0           MOVX    A,@DPTR
   \   000032   F8           MOV     R0,A
   \   000033   7900         MOV     R1,#0x0
   \   000035   E4           CLR     A
   \   000036   C8           XCH     A,R0
   \   000037   F9           MOV     R1,A
   \   000038   EA           MOV     A,R2
   \   000039   28           ADD     A,R0
   \   00003A   FE           MOV     R6,A
   \   00003B   EB           MOV     A,R3
   \   00003C   39           ADDC    A,R1
   \   00003D   FF           MOV     R7,A
    472            /* Get the offset */
    473            nvItemOffset = pBuf[2];
   \   00003E   85..82       MOV     DPL,?V0 + 0
   \   000041   85..83       MOV     DPH,?V0 + 1
   \   000044   A3           INC     DPTR
   \   000045   A3           INC     DPTR
   \   000046   E0           MOVX    A,@DPTR
   \   000047   F5..         MOV     ?V0 + 6,A
    474            /* Get the length */
    475            nvItemLen = pBuf[3];
   \   000049   85..82       MOV     DPL,?V0 + 0
   \   00004C   85..83       MOV     DPH,?V0 + 1
   \   00004F   A3           INC     DPTR
   \   000050   A3           INC     DPTR
   \   000051   A3           INC     DPTR
   \   000052   E0           MOVX    A,@DPTR
   \   000053   F5..         MOV     ?V0 + 4,A
    476            pBuf += 4;
   \   000055   E5..         MOV     A,?V0 + 0
   \   000057   2404         ADD     A,#0x4
   \   000059   F5..         MOV     ?V0 + 0,A
   \   00005B   E5..         MOV     A,?V0 + 1
   \   00005D   3400         ADDC    A,#0x0
   \   00005F   F5..         MOV     ?V0 + 1,A
    477          
    478            /* Default to ZFailure */
    479            rtrn = ZFailure;
   \   000061   85..82       MOV     DPL,?XSP + 0
   \   000064   85..83       MOV     DPH,?XSP + 1
   \   000067   7401         MOV     A,#0x1
   \   000069   F0           MOVX    @DPTR,A
    480          
    481            /* Set the Z-Globals value of this NV item. */
    482            zgSetItem( nvId, (uint16)nvItemLen, pBuf );
   \   00006A                ; Setup parameters for call to function zgSetItem
   \   00006A   78..         MOV     R0,#?V0 + 0
   \   00006C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00006F   85....       MOV     ?V0 + 2,?V0 + 4
   \   000072   75..00       MOV     ?V0 + 3,#0x0
   \   000075   AC..         MOV     R4,?V0 + 2
   \   000077   AD..         MOV     R5,?V0 + 3
   \   000079   EE           MOV     A,R6
   \   00007A   FA           MOV     R2,A
   \   00007B   EF           MOV     A,R7
   \   00007C   FB           MOV     R3,A
   \   00007D   12....       LCALL   ??zgSetItem?relay
   \   000080   7402         MOV     A,#0x2
   \   000082   12....       LCALL   ?DEALLOC_XSTACK8
    483          
    484            if ((osal_nv_write(nvId, (uint16)nvItemOffset, (uint16)nvItemLen, pBuf)) == ZSUCCESS)
   \   000085                ; Setup parameters for call to function osal_nv_write
   \   000085   78..         MOV     R0,#?V0 + 0
   \   000087   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008A   75..00       MOV     ?V0 + 5,#0x0
   \   00008D   78..         MOV     R0,#?V0 + 4
   \   00008F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000092   75..00       MOV     ?V0 + 7,#0x0
   \   000095   AC..         MOV     R4,?V0 + 6
   \   000097   AD..         MOV     R5,?V0 + 7
   \   000099   EE           MOV     A,R6
   \   00009A   FA           MOV     R2,A
   \   00009B   EF           MOV     A,R7
   \   00009C   FB           MOV     R3,A
   \   00009D   12....       LCALL   ??osal_nv_write?relay
   \   0000A0   7404         MOV     A,#0x4
   \   0000A2   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000A5   E9           MOV     A,R1
   \   0000A6   7026         JNZ     ??MT_SysOsalNVWrite_0
    485            {
    486              if (nvId == ZCD_NV_EXTADDR)
   \   0000A8   7401         MOV     A,#0x1
   \   0000AA   6E           XRL     A,R6
   \   0000AB   7003         JNZ     ??MT_SysOsalNVWrite_1
   \   0000AD   7400         MOV     A,#0x0
   \   0000AF   6F           XRL     A,R7
   \                     ??MT_SysOsalNVWrite_1:
   \   0000B0   7013         JNZ     ??MT_SysOsalNVWrite_2
    487              {
    488                rtrn = ZMacSetReq(ZMacExtAddr, pBuf);
   \   0000B2                ; Setup parameters for call to function ZMacSetReq
   \   0000B2   AA..         MOV     R2,?V0 + 0
   \   0000B4   AB..         MOV     R3,?V0 + 1
   \   0000B6   79E2         MOV     R1,#-0x1e
   \   0000B8   12....       LCALL   ??ZMacSetReq?relay
   \   0000BB   E9           MOV     A,R1
   \   0000BC   85..82       MOV     DPL,?XSP + 0
   \   0000BF   85..83       MOV     DPH,?XSP + 1
   \   0000C2   F0           MOVX    @DPTR,A
   \   0000C3   8009         SJMP    ??MT_SysOsalNVWrite_0
    489              }
    490              else
    491              {
    492                rtrn = ZSuccess;
   \                     ??MT_SysOsalNVWrite_2:
   \   0000C5   85..82       MOV     DPL,?XSP + 0
   \   0000C8   85..83       MOV     DPH,?XSP + 1
   \   0000CB   7400         MOV     A,#0x0
   \   0000CD   F0           MOVX    @DPTR,A
    493              }
    494            }
    495          
    496            /* Build and send back the response */
    497            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS),
    498                                           MT_SYS_OSAL_NV_WRITE, 1, &rtrn);
   \                     ??MT_SysOsalNVWrite_0:
   \   0000CE                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000CE   85..82       MOV     DPL,?XSP + 0
   \   0000D1   85..83       MOV     DPH,?XSP + 1
   \   0000D4   AC82         MOV     R4,DPL
   \   0000D6   AD83         MOV     R5,DPH
   \   0000D8   7B01         MOV     R3,#0x1
   \   0000DA   7A09         MOV     R2,#0x9
   \   0000DC   7961         MOV     R1,#0x61
   \   0000DE   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    499          }
   \   0000E1   7401         MOV     A,#0x1
   \   0000E3   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000E6   7F08         MOV     R7,#0x8
   \   0000E8   02....       LJMP    ?BANKED_LEAVE_XDATA
    500          
    501          /***************************************************************************************************
    502           * @fn      MT_SysOsalNVItemInit
    503           *
    504           * @brief   Attempt to create an NV item
    505           *
    506           * @param   uint8 pData - pointer to the data
    507           *
    508           * @return  None
    509           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    510          void MT_SysOsalNVItemInit(uint8 *pBuf)
   \                     MT_SysOsalNVItemInit:
    511          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
    512            uint8 ret;
    513            uint8 idLen;
    514            uint16 nvId;
    515            uint16 nvLen;
    516          
    517            /* Skip over RPC header */
    518            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   00000E   E5..         MOV     A,?V0 + 0
   \   000010   2403         ADD     A,#0x3
   \   000012   F5..         MOV     ?V0 + 0,A
   \   000014   E5..         MOV     A,?V0 + 1
   \   000016   3400         ADDC    A,#0x0
   \   000018   F5..         MOV     ?V0 + 1,A
    519          
    520            /* NV item ID */
    521            nvId = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   00001A   85..82       MOV     DPL,?V0 + 0
   \   00001D   85..83       MOV     DPH,?V0 + 1
   \   000020   E0           MOVX    A,@DPTR
   \   000021   FA           MOV     R2,A
   \   000022   7B00         MOV     R3,#0x0
   \   000024   85..82       MOV     DPL,?V0 + 0
   \   000027   85..83       MOV     DPH,?V0 + 1
   \   00002A   A3           INC     DPTR
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   F8           MOV     R0,A
   \   00002D   7900         MOV     R1,#0x0
   \   00002F   E4           CLR     A
   \   000030   C8           XCH     A,R0
   \   000031   F9           MOV     R1,A
   \   000032   EA           MOV     A,R2
   \   000033   28           ADD     A,R0
   \   000034   FE           MOV     R6,A
   \   000035   EB           MOV     A,R3
   \   000036   39           ADDC    A,R1
   \   000037   FF           MOV     R7,A
    522            /* NV item length */
    523            nvLen = BUILD_UINT16(pBuf[2], pBuf[3]);
   \   000038   85..82       MOV     DPL,?V0 + 0
   \   00003B   85..83       MOV     DPH,?V0 + 1
   \   00003E   A3           INC     DPTR
   \   00003F   A3           INC     DPTR
   \   000040   E0           MOVX    A,@DPTR
   \   000041   FA           MOV     R2,A
   \   000042   7B00         MOV     R3,#0x0
   \   000044   85..82       MOV     DPL,?V0 + 0
   \   000047   85..83       MOV     DPH,?V0 + 1
   \   00004A   A3           INC     DPTR
   \   00004B   A3           INC     DPTR
   \   00004C   A3           INC     DPTR
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   F8           MOV     R0,A
   \   00004F   7900         MOV     R1,#0x0
   \   000051   E4           CLR     A
   \   000052   C8           XCH     A,R0
   \   000053   F9           MOV     R1,A
   \   000054   EA           MOV     A,R2
   \   000055   28           ADD     A,R0
   \   000056   FC           MOV     R4,A
   \   000057   EB           MOV     A,R3
   \   000058   39           ADDC    A,R1
   \   000059   FD           MOV     R5,A
    524            /* Initialization data length */
    525            idLen = pBuf[4];
   \   00005A   85..82       MOV     DPL,?V0 + 0
   \   00005D   85..83       MOV     DPH,?V0 + 1
   \   000060   A3           INC     DPTR
   \   000061   A3           INC     DPTR
   \   000062   A3           INC     DPTR
   \   000063   A3           INC     DPTR
   \   000064   E0           MOVX    A,@DPTR
   \   000065   F5..         MOV     ?V0 + 4,A
    526            pBuf += 5;
   \   000067   E5..         MOV     A,?V0 + 0
   \   000069   2405         ADD     A,#0x5
   \   00006B   F5..         MOV     ?V0 + 0,A
   \   00006D   E5..         MOV     A,?V0 + 1
   \   00006F   3400         ADDC    A,#0x0
   \   000071   F5..         MOV     ?V0 + 1,A
    527          
    528            if ( idLen < nvLen )
   \   000073   85....       MOV     ?V0 + 2,?V0 + 4
   \   000076   75..00       MOV     ?V0 + 3,#0x0
   \   000079   C3           CLR     C
   \   00007A   E5..         MOV     A,?V0 + 2
   \   00007C   9C           SUBB    A,R4
   \   00007D   E5..         MOV     A,?V0 + 3
   \   00007F   9D           SUBB    A,R5
   \   000080   5050         JNC     ??MT_SysOsalNVItemInit_0
    529            {
    530              /* Attempt to create a new NV item */
    531              ret = osal_nv_item_init( nvId, nvLen, NULL );
   \   000082                ; Setup parameters for call to function osal_nv_item_init
   \   000082   E4           CLR     A
   \   000083   F5..         MOV     ?V0 + 2,A
   \   000085   F5..         MOV     ?V0 + 3,A
   \   000087   78..         MOV     R0,#?V0 + 2
   \   000089   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008C   EE           MOV     A,R6
   \   00008D   FA           MOV     R2,A
   \   00008E   EF           MOV     A,R7
   \   00008F   FB           MOV     R3,A
   \   000090   12....       LCALL   ??osal_nv_item_init?relay
   \   000093   7402         MOV     A,#0x2
   \   000095   12....       LCALL   ?DEALLOC_XSTACK8
   \   000098   E9           MOV     A,R1
   \   000099   85..82       MOV     DPL,?XSP + 0
   \   00009C   85..83       MOV     DPH,?XSP + 1
   \   00009F   F0           MOVX    @DPTR,A
    532              if ( (ret == NV_ITEM_UNINIT) && (idLen > 0) )
   \   0000A0   85..82       MOV     DPL,?XSP + 0
   \   0000A3   85..83       MOV     DPH,?XSP + 1
   \   0000A6   E0           MOVX    A,@DPTR
   \   0000A7   6409         XRL     A,#0x9
   \   0000A9   7040         JNZ     ??MT_SysOsalNVItemInit_1
   \   0000AB   E5..         MOV     A,?V0 + 4
   \   0000AD   C3           CLR     C
   \   0000AE   9401         SUBB    A,#0x1
   \   0000B0   4039         JC      ??MT_SysOsalNVItemInit_1
    533              {
    534                /* Write initialization data to first part of new item */
    535                (void) osal_nv_write( nvId, 0, (uint16)idLen, pBuf );
   \   0000B2                ; Setup parameters for call to function osal_nv_write
   \   0000B2   78..         MOV     R0,#?V0 + 0
   \   0000B4   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000B7   75..00       MOV     ?V0 + 5,#0x0
   \   0000BA   78..         MOV     R0,#?V0 + 4
   \   0000BC   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000BF   7C00         MOV     R4,#0x0
   \   0000C1   7D00         MOV     R5,#0x0
   \   0000C3   EE           MOV     A,R6
   \   0000C4   FA           MOV     R2,A
   \   0000C5   EF           MOV     A,R7
   \   0000C6   FB           MOV     R3,A
   \   0000C7   12....       LCALL   ??osal_nv_write?relay
   \   0000CA   7404         MOV     A,#0x4
   \   0000CC   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000CF   E9           MOV     A,R1
   \   0000D0   8019         SJMP    ??MT_SysOsalNVItemInit_1
    536              }
    537            }
    538            else
    539            {
    540              /* Attempt to create/initialize a new NV item */
    541              ret = osal_nv_item_init( nvId, nvLen, pBuf );
   \                     ??MT_SysOsalNVItemInit_0:
   \   0000D2                ; Setup parameters for call to function osal_nv_item_init
   \   0000D2   78..         MOV     R0,#?V0 + 0
   \   0000D4   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000D7   EE           MOV     A,R6
   \   0000D8   FA           MOV     R2,A
   \   0000D9   EF           MOV     A,R7
   \   0000DA   FB           MOV     R3,A
   \   0000DB   12....       LCALL   ??osal_nv_item_init?relay
   \   0000DE   7402         MOV     A,#0x2
   \   0000E0   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000E3   E9           MOV     A,R1
   \   0000E4   85..82       MOV     DPL,?XSP + 0
   \   0000E7   85..83       MOV     DPH,?XSP + 1
   \   0000EA   F0           MOVX    @DPTR,A
    542            }
    543          
    544            /* Build and send back the response */
    545            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS),
    546                                           MT_SYS_OSAL_NV_ITEM_INIT, 1, &ret);
   \                     ??MT_SysOsalNVItemInit_1:
   \   0000EB                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000EB   85..82       MOV     DPL,?XSP + 0
   \   0000EE   85..83       MOV     DPH,?XSP + 1
   \   0000F1   AC82         MOV     R4,DPL
   \   0000F3   AD83         MOV     R5,DPH
   \   0000F5   7B01         MOV     R3,#0x1
   \   0000F7   7A07         MOV     R2,#0x7
   \   0000F9   7961         MOV     R1,#0x61
   \   0000FB   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    547          }
   \   0000FE   7401         MOV     A,#0x1
   \   000100   12....       LCALL   ?DEALLOC_XSTACK8
   \   000103   7F06         MOV     R7,#0x6
   \   000105   02....       LJMP    ?BANKED_LEAVE_XDATA
    548          
    549          /***************************************************************************************************
    550           * @fn      MT_SysOsalNVDelete
    551           *
    552           * @brief   Attempt to delete an NV item
    553           *
    554           * @param   uint8 pData - pointer to the data
    555           *
    556           * @return  None
    557           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    558          void MT_SysOsalNVDelete(uint8 *pBuf)
   \                     MT_SysOsalNVDelete:
    559          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    560            uint16 nvId;
    561            uint16 nvLen;
    562            uint8 ret;
    563          
    564            /* Skip over RPC header */
    565            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   00000A   EA           MOV     A,R2
   \   00000B   2403         ADD     A,#0x3
   \   00000D   FA           MOV     R2,A
   \   00000E   EB           MOV     A,R3
   \   00000F   3400         ADDC    A,#0x0
   \   000011   FB           MOV     R3,A
    566          
    567            /* Get the ID */
    568            nvId = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   000012   8A82         MOV     DPL,R2
   \   000014   8B83         MOV     DPH,R3
   \   000016   E0           MOVX    A,@DPTR
   \   000017   FC           MOV     R4,A
   \   000018   7D00         MOV     R5,#0x0
   \   00001A   8A82         MOV     DPL,R2
   \   00001C   8B83         MOV     DPH,R3
   \   00001E   A3           INC     DPTR
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F8           MOV     R0,A
   \   000021   7900         MOV     R1,#0x0
   \   000023   E4           CLR     A
   \   000024   C8           XCH     A,R0
   \   000025   F9           MOV     R1,A
   \   000026   EC           MOV     A,R4
   \   000027   28           ADD     A,R0
   \   000028   F8           MOV     R0,A
   \   000029   ED           MOV     A,R5
   \   00002A   39           ADDC    A,R1
   \   00002B   F9           MOV     R1,A
    569            /* Get the length */
    570            nvLen = BUILD_UINT16(pBuf[2], pBuf[3]);
   \   00002C   8A82         MOV     DPL,R2
   \   00002E   8B83         MOV     DPH,R3
   \   000030   A3           INC     DPTR
   \   000031   A3           INC     DPTR
   \   000032   E0           MOVX    A,@DPTR
   \   000033   FC           MOV     R4,A
   \   000034   7D00         MOV     R5,#0x0
   \   000036   8A82         MOV     DPL,R2
   \   000038   8B83         MOV     DPH,R3
   \   00003A   A3           INC     DPTR
   \   00003B   A3           INC     DPTR
   \   00003C   A3           INC     DPTR
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   FA           MOV     R2,A
   \   00003F   7B00         MOV     R3,#0x0
   \   000041   E4           CLR     A
   \   000042   CA           XCH     A,R2
   \   000043   FB           MOV     R3,A
   \   000044   EC           MOV     A,R4
   \   000045   2A           ADD     A,R2
   \   000046   FC           MOV     R4,A
   \   000047   ED           MOV     A,R5
   \   000048   3B           ADDC    A,R3
   \   000049   FD           MOV     R5,A
    571          
    572            /* Attempt to delete the NV item */
    573            ret = osal_nv_delete( nvId, nvLen );
   \   00004A                ; Setup parameters for call to function osal_nv_delete
   \   00004A   E8           MOV     A,R0
   \   00004B   FA           MOV     R2,A
   \   00004C   E9           MOV     A,R1
   \   00004D   FB           MOV     R3,A
   \   00004E   12....       LCALL   ??osal_nv_delete?relay
   \   000051   E9           MOV     A,R1
   \   000052   85..82       MOV     DPL,?XSP + 0
   \   000055   85..83       MOV     DPH,?XSP + 1
   \   000058   F0           MOVX    @DPTR,A
    574          
    575            /* Build and send back the response */
    576            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS),
    577                                           MT_SYS_OSAL_NV_DELETE, 1, &ret);
   \   000059                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000059   85..82       MOV     DPL,?XSP + 0
   \   00005C   85..83       MOV     DPH,?XSP + 1
   \   00005F   AC82         MOV     R4,DPL
   \   000061   AD83         MOV     R5,DPH
   \   000063   7B01         MOV     R3,#0x1
   \   000065   7A12         MOV     R2,#0x12
   \   000067   7961         MOV     R1,#0x61
   \   000069   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    578          }
   \   00006C   7401         MOV     A,#0x1
   \   00006E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000071   7F01         MOV     R7,#0x1
   \   000073   02....       LJMP    ?BANKED_LEAVE_XDATA
    579          
    580          /***************************************************************************************************
    581           * @fn      MT_SysOsalNVLength
    582           *
    583           * @brief   Attempt to get the length to an NV item
    584           *
    585           * @param   uint8 pData - pointer to the data
    586           *
    587           * @return  None
    588           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    589          void MT_SysOsalNVLength(uint8 *pBuf)
   \                     MT_SysOsalNVLength:
    590          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    591            uint16 nvId;
    592            uint16 nvLen;
    593            uint8 rsp[2];
    594          
    595            /* Skip over RPC header */
    596            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   00000A   EA           MOV     A,R2
   \   00000B   2403         ADD     A,#0x3
   \   00000D   FA           MOV     R2,A
   \   00000E   EB           MOV     A,R3
   \   00000F   3400         ADDC    A,#0x0
   \   000011   FB           MOV     R3,A
    597          
    598            /* Get the ID */
    599            nvId = BUILD_UINT16(pBuf[0], pBuf[1]);
   \   000012   8A82         MOV     DPL,R2
   \   000014   8B83         MOV     DPH,R3
   \   000016   E0           MOVX    A,@DPTR
   \   000017   FC           MOV     R4,A
   \   000018   7D00         MOV     R5,#0x0
   \   00001A   8A82         MOV     DPL,R2
   \   00001C   8B83         MOV     DPH,R3
   \   00001E   A3           INC     DPTR
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F8           MOV     R0,A
   \   000021   7900         MOV     R1,#0x0
   \   000023   E4           CLR     A
   \   000024   C8           XCH     A,R0
   \   000025   F9           MOV     R1,A
   \   000026   EC           MOV     A,R4
   \   000027   28           ADD     A,R0
   \   000028   FA           MOV     R2,A
   \   000029   ED           MOV     A,R5
   \   00002A   39           ADDC    A,R1
   \   00002B   FB           MOV     R3,A
    600          
    601            /* Attempt to get NV item length */
    602            nvLen = osal_nv_item_len( nvId );
   \   00002C                ; Setup parameters for call to function osal_nv_item_len
   \   00002C   12....       LCALL   ??osal_nv_item_len?relay
   \   00002F   8A..         MOV     ?V0 + 0,R2
   \   000031   8B..         MOV     ?V0 + 1,R3
   \   000033   A8..         MOV     R0,?V0 + 0
   \   000035   A9..         MOV     R1,?V0 + 1
    603            rsp[0] = LO_UINT16( nvLen );
   \   000037   E8           MOV     A,R0
   \   000038   85..82       MOV     DPL,?XSP + 0
   \   00003B   85..83       MOV     DPH,?XSP + 1
   \   00003E   F0           MOVX    @DPTR,A
    604            rsp[1] = HI_UINT16( nvLen );
   \   00003F   E4           CLR     A
   \   000040   E5..         MOV     A,?V0 + 1
   \   000042   A8..         MOV     R0,?V0 + 1
   \   000044   E5..         MOV     A,?V0 + 1
   \   000046   7401         MOV     A,#0x1
   \   000048   12....       LCALL   ?XSTACK_DISP0_8
   \   00004B   E5..         MOV     A,?V0 + 1
   \   00004D   F0           MOVX    @DPTR,A
    605          
    606            /* Build and send back the response */
    607            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS),
    608                                           MT_SYS_OSAL_NV_LENGTH, 2, rsp);
   \   00004E                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00004E   85..82       MOV     DPL,?XSP + 0
   \   000051   85..83       MOV     DPH,?XSP + 1
   \   000054   AC82         MOV     R4,DPL
   \   000056   AD83         MOV     R5,DPH
   \   000058   7B02         MOV     R3,#0x2
   \   00005A   7A13         MOV     R2,#0x13
   \   00005C   7961         MOV     R1,#0x61
   \   00005E   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    609          }
   \   000061   7402         MOV     A,#0x2
   \   000063   12....       LCALL   ?DEALLOC_XSTACK8
   \   000066   7F02         MOV     R7,#0x2
   \   000068   02....       LJMP    ?BANKED_LEAVE_XDATA
    610          
    611          /***************************************************************************************************
    612           * @fn      MT_SysOsalStartTimer
    613           *
    614           * @brief
    615           *
    616           * @param   uint8 pData - pointer to the data
    617           *
    618           * @return  None
    619           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    620          void MT_SysOsalStartTimer(uint8 *pBuf)
   \                     MT_SysOsalStartTimer:
    621          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    622            uint16 eventId;
    623            uint8 retValue = ZFailure;
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   7401         MOV     A,#0x1
   \   000012   F0           MOVX    @DPTR,A
    624            uint8 cmdId;
    625          
    626            /* parse header */
    627            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   000013   8A82         MOV     DPL,R2
   \   000015   8B83         MOV     DPH,R3
   \   000017   A3           INC     DPTR
   \   000018   A3           INC     DPTR
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   FE           MOV     R6,A
    628            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   00001B   EA           MOV     A,R2
   \   00001C   2403         ADD     A,#0x3
   \   00001E   FA           MOV     R2,A
   \   00001F   EB           MOV     A,R3
   \   000020   3400         ADDC    A,#0x0
   \   000022   FB           MOV     R3,A
    629          
    630            if (*pBuf <= 3)
   \   000023   8A82         MOV     DPL,R2
   \   000025   8B83         MOV     DPH,R3
   \   000027   E0           MOVX    A,@DPTR
   \   000028   C3           CLR     C
   \   000029   9404         SUBB    A,#0x4
   \   00002B   505E         JNC     ??MT_SysOsalStartTimer_0
    631            {
    632              eventId = (uint16) MT_SysOsalEventId[*pBuf];
   \   00002D   8A82         MOV     DPL,R2
   \   00002F   8B83         MOV     DPH,R3
   \   000031   E0           MOVX    A,@DPTR
   \   000032   F8           MOV     R0,A
   \   000033   7900         MOV     R1,#0x0
   \   000035   E8           MOV     A,R0
   \   000036   75F002       MOV     B,#0x2
   \   000039   A4           MUL     AB
   \   00003A   C8           XCH     A,R0
   \   00003B   ACF0         MOV     R4,B
   \   00003D   75F000       MOV     B,#0x0
   \   000040   A4           MUL     AB
   \   000041   2C           ADD     A,R4
   \   000042   FC           MOV     R4,A
   \   000043   75F002       MOV     B,#0x2
   \   000046   E9           MOV     A,R1
   \   000047   A4           MUL     AB
   \   000048   2C           ADD     A,R4
   \   000049   F9           MOV     R1,A
   \   00004A   74..         MOV     A,#MT_SysOsalEventId & 0xff
   \   00004C   28           ADD     A,R0
   \   00004D   F582         MOV     DPL,A
   \   00004F   74..         MOV     A,#(MT_SysOsalEventId >> 8) & 0xff
   \   000051   39           ADDC    A,R1
   \   000052   F583         MOV     DPH,A
   \   000054   E0           MOVX    A,@DPTR
   \   000055   F8           MOV     R0,A
   \   000056   A3           INC     DPTR
   \   000057   E0           MOVX    A,@DPTR
   \   000058   F9           MOV     R1,A
    633              retValue = osal_start_timerEx(MT_TaskID, eventId, BUILD_UINT16(pBuf[1], pBuf[2]));
   \   000059                ; Setup parameters for call to function osal_start_timerEx
   \   000059   8A82         MOV     DPL,R2
   \   00005B   8B83         MOV     DPH,R3
   \   00005D   A3           INC     DPTR
   \   00005E   E0           MOVX    A,@DPTR
   \   00005F   FC           MOV     R4,A
   \   000060   7D00         MOV     R5,#0x0
   \   000062   8A82         MOV     DPL,R2
   \   000064   8B83         MOV     DPH,R3
   \   000066   A3           INC     DPTR
   \   000067   A3           INC     DPTR
   \   000068   E0           MOVX    A,@DPTR
   \   000069   FA           MOV     R2,A
   \   00006A   7B00         MOV     R3,#0x0
   \   00006C   E4           CLR     A
   \   00006D   CA           XCH     A,R2
   \   00006E   FB           MOV     R3,A
   \   00006F   EC           MOV     A,R4
   \   000070   2A           ADD     A,R2
   \   000071   FC           MOV     R4,A
   \   000072   ED           MOV     A,R5
   \   000073   3B           ADDC    A,R3
   \   000074   FD           MOV     R5,A
   \   000075   E8           MOV     A,R0
   \   000076   FA           MOV     R2,A
   \   000077   E9           MOV     A,R1
   \   000078   FB           MOV     R3,A
   \   000079   90....       MOV     DPTR,#MT_TaskID
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   F9           MOV     R1,A
   \   00007E   12....       LCALL   ??osal_start_timerEx?relay
   \   000081   E9           MOV     A,R1
   \   000082   85..82       MOV     DPL,?XSP + 0
   \   000085   85..83       MOV     DPH,?XSP + 1
   \   000088   F0           MOVX    @DPTR,A
   \   000089   8009         SJMP    ??MT_SysOsalStartTimer_1
    634            }
    635            else
    636            {
    637              retValue = ZInvalidParameter;
   \                     ??MT_SysOsalStartTimer_0:
   \   00008B   85..82       MOV     DPL,?XSP + 0
   \   00008E   85..83       MOV     DPH,?XSP + 1
   \   000091   7402         MOV     A,#0x2
   \   000093   F0           MOVX    @DPTR,A
    638            }
    639          
    640            /* Build and send back the response */
    641            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS), cmdId, 1, &retValue);
   \                     ??MT_SysOsalStartTimer_1:
   \   000094                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000094   85..82       MOV     DPL,?XSP + 0
   \   000097   85..83       MOV     DPH,?XSP + 1
   \   00009A   AC82         MOV     R4,DPL
   \   00009C   AD83         MOV     R5,DPH
   \   00009E   7B01         MOV     R3,#0x1
   \   0000A0   EE           MOV     A,R6
   \   0000A1   FA           MOV     R2,A
   \   0000A2   7961         MOV     R1,#0x61
   \   0000A4   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    642          }
   \   0000A7   7401         MOV     A,#0x1
   \   0000A9   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000AC   7F01         MOV     R7,#0x1
   \   0000AE   02....       LJMP    ?BANKED_LEAVE_XDATA
    643          
    644          /***************************************************************************************************
    645           * @fn      MT_SysOsalStopTimer
    646           *
    647           * @brief
    648           *
    649           * @param   uint8 pData - pointer to the data
    650           *
    651           * @return  None
    652           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    653          void MT_SysOsalStopTimer(uint8 *pBuf)
   \                     MT_SysOsalStopTimer:
    654          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    655            uint16 eventId;
    656            uint8 retValue = ZFailure;
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   7401         MOV     A,#0x1
   \   000012   F0           MOVX    @DPTR,A
    657            uint8 cmdId;
    658          
    659            /* parse header */
    660            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   000013   8A82         MOV     DPL,R2
   \   000015   8B83         MOV     DPH,R3
   \   000017   A3           INC     DPTR
   \   000018   A3           INC     DPTR
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   FE           MOV     R6,A
    661            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   00001B   EA           MOV     A,R2
   \   00001C   2403         ADD     A,#0x3
   \   00001E   FA           MOV     R2,A
   \   00001F   EB           MOV     A,R3
   \   000020   3400         ADDC    A,#0x0
   \   000022   FB           MOV     R3,A
    662          
    663            if (*pBuf <= 3)
   \   000023   8A82         MOV     DPL,R2
   \   000025   8B83         MOV     DPH,R3
   \   000027   E0           MOVX    A,@DPTR
   \   000028   C3           CLR     C
   \   000029   9404         SUBB    A,#0x4
   \   00002B   503E         JNC     ??MT_SysOsalStopTimer_0
    664            {
    665              eventId = (uint16) MT_SysOsalEventId[*pBuf];
   \   00002D   8A82         MOV     DPL,R2
   \   00002F   8B83         MOV     DPH,R3
   \   000031   E0           MOVX    A,@DPTR
   \   000032   F8           MOV     R0,A
   \   000033   7900         MOV     R1,#0x0
   \   000035   E8           MOV     A,R0
   \   000036   75F002       MOV     B,#0x2
   \   000039   A4           MUL     AB
   \   00003A   C8           XCH     A,R0
   \   00003B   AAF0         MOV     R2,B
   \   00003D   75F000       MOV     B,#0x0
   \   000040   A4           MUL     AB
   \   000041   2A           ADD     A,R2
   \   000042   FA           MOV     R2,A
   \   000043   75F002       MOV     B,#0x2
   \   000046   E9           MOV     A,R1
   \   000047   A4           MUL     AB
   \   000048   2A           ADD     A,R2
   \   000049   F9           MOV     R1,A
   \   00004A   74..         MOV     A,#MT_SysOsalEventId & 0xff
   \   00004C   28           ADD     A,R0
   \   00004D   F582         MOV     DPL,A
   \   00004F   74..         MOV     A,#(MT_SysOsalEventId >> 8) & 0xff
   \   000051   39           ADDC    A,R1
   \   000052   F583         MOV     DPH,A
   \   000054   E0           MOVX    A,@DPTR
   \   000055   FA           MOV     R2,A
   \   000056   A3           INC     DPTR
   \   000057   E0           MOVX    A,@DPTR
   \   000058   FB           MOV     R3,A
    666              retValue = osal_stop_timerEx(MT_TaskID, eventId);
   \   000059                ; Setup parameters for call to function osal_stop_timerEx
   \   000059   90....       MOV     DPTR,#MT_TaskID
   \   00005C   E0           MOVX    A,@DPTR
   \   00005D   F9           MOV     R1,A
   \   00005E   12....       LCALL   ??osal_stop_timerEx?relay
   \   000061   E9           MOV     A,R1
   \   000062   85..82       MOV     DPL,?XSP + 0
   \   000065   85..83       MOV     DPH,?XSP + 1
   \   000068   F0           MOVX    @DPTR,A
   \   000069   8009         SJMP    ??MT_SysOsalStopTimer_1
    667            }
    668            else
    669            {
    670              retValue = ZInvalidParameter;
   \                     ??MT_SysOsalStopTimer_0:
   \   00006B   85..82       MOV     DPL,?XSP + 0
   \   00006E   85..83       MOV     DPH,?XSP + 1
   \   000071   7402         MOV     A,#0x2
   \   000073   F0           MOVX    @DPTR,A
    671            }
    672          
    673            /* Build and send back the response */
    674            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS), cmdId, 1, &retValue );
   \                     ??MT_SysOsalStopTimer_1:
   \   000074                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000074   85..82       MOV     DPL,?XSP + 0
   \   000077   85..83       MOV     DPH,?XSP + 1
   \   00007A   AC82         MOV     R4,DPL
   \   00007C   AD83         MOV     R5,DPH
   \   00007E   7B01         MOV     R3,#0x1
   \   000080   EE           MOV     A,R6
   \   000081   FA           MOV     R2,A
   \   000082   7961         MOV     R1,#0x61
   \   000084   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    675          }
   \   000087   7401         MOV     A,#0x1
   \   000089   12....       LCALL   ?DEALLOC_XSTACK8
   \   00008C   7F01         MOV     R7,#0x1
   \   00008E   02....       LJMP    ?BANKED_LEAVE_XDATA
    676          
    677          /***************************************************************************************************
    678           * @fn      MT_SysRandom
    679           *
    680           * @brief
    681           *
    682           * @param   uint8 pData - pointer to the data
    683           *
    684           * @return  None
    685           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    686          void MT_SysRandom()
   \                     MT_SysRandom:
    687          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    688            uint16 randValue = Onboard_rand();
   \   00000A                ; Setup parameters for call to function Onboard_rand
   \   00000A   12....       LCALL   ??Onboard_rand?relay
   \   00000D   8A..         MOV     ?V0 + 0,R2
   \   00000F   8B..         MOV     ?V0 + 1,R3
   \   000011   A8..         MOV     R0,?V0 + 0
   \   000013   A9..         MOV     R1,?V0 + 1
    689            uint8 retArray[2];
    690          
    691            retArray[0] = LO_UINT16(randValue);
   \   000015   E8           MOV     A,R0
   \   000016   85..82       MOV     DPL,?XSP + 0
   \   000019   85..83       MOV     DPH,?XSP + 1
   \   00001C   F0           MOVX    @DPTR,A
    692            retArray[1] = HI_UINT16(randValue);
   \   00001D   E4           CLR     A
   \   00001E   E5..         MOV     A,?V0 + 1
   \   000020   A8..         MOV     R0,?V0 + 1
   \   000022   E5..         MOV     A,?V0 + 1
   \   000024   7401         MOV     A,#0x1
   \   000026   12....       LCALL   ?XSTACK_DISP0_8
   \   000029   E5..         MOV     A,?V0 + 1
   \   00002B   F0           MOVX    @DPTR,A
    693          
    694            /* Build and send back the response */
    695            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS), MT_SYS_RANDOM, 2, retArray );
   \   00002C                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00002C   85..82       MOV     DPL,?XSP + 0
   \   00002F   85..83       MOV     DPH,?XSP + 1
   \   000032   AC82         MOV     R4,DPL
   \   000034   AD83         MOV     R5,DPH
   \   000036   7B02         MOV     R3,#0x2
   \   000038   7A0C         MOV     R2,#0xc
   \   00003A   7961         MOV     R1,#0x61
   \   00003C   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    696          }
   \   00003F   7402         MOV     A,#0x2
   \   000041   12....       LCALL   ?DEALLOC_XSTACK8
   \   000044   7F02         MOV     R7,#0x2
   \   000046   02....       LJMP    ?BANKED_LEAVE_XDATA
    697          
    698          /***************************************************************************************************
    699           * @fn      MT_SysAdcRead
    700           *
    701           * @brief   Reading ADC value, temperature sensor and voltage
    702           *
    703           * @param   uint8 pData - pointer to the data
    704           *
    705           * @return  None
    706           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    707          void MT_SysAdcRead(uint8 *pBuf)
   \                     MT_SysAdcRead:
    708          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    709          #ifndef HAL_BOARD_LM3S
    710            uint8 channel, resolution;
    711            uint16 tempValue;
    712            uint8 retArray[2];
    713            uint8 cmdId;
    714          
    715            /* parse header */
    716            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   FE           MOV     R6,A
    717            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000012   EA           MOV     A,R2
   \   000013   2403         ADD     A,#0x3
   \   000015   FA           MOV     R2,A
   \   000016   EB           MOV     A,R3
   \   000017   3400         ADDC    A,#0x0
   \   000019   FB           MOV     R3,A
    718          
    719            /* Channel */
    720            channel = *pBuf++;
   \   00001A   8A82         MOV     DPL,R2
   \   00001C   8B83         MOV     DPH,R3
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   F9           MOV     R1,A
   \   000020   8A82         MOV     DPL,R2
   \   000022   8B83         MOV     DPH,R3
   \   000024   A3           INC     DPTR
   \   000025   AA82         MOV     R2,DPL
   \   000027   AB83         MOV     R3,DPH
    721          
    722            /* Resolution */
    723            resolution = *pBuf++;
   \   000029   8A82         MOV     DPL,R2
   \   00002B   8B83         MOV     DPH,R3
   \   00002D   E0           MOVX    A,@DPTR
   \   00002E   F8           MOV     R0,A
   \   00002F   8A82         MOV     DPL,R2
   \   000031   8B83         MOV     DPH,R3
   \   000033   A3           INC     DPTR
   \   000034   AA82         MOV     R2,DPL
   \   000036   AB83         MOV     R3,DPH
    724          
    725            /* Voltage reading */
    726            switch (channel)
   \   000038   E9           MOV     A,R1
   \   000039   12....       LCALL   ?UC_SWITCH_SPARSE
   \                     `?<Jumptable for MT_SysAdcRead>_0`:
   \   00003C   01           DB        1
   \   00003D   00           DB        0
   \   00003E   07           DB        7
   \   00003F   ....         DW        ??MT_SysAdcRead_0
   \   000041   02           DB        2
   \   000042   0E           DB        14
   \   000043   ....         DW        ??MT_SysAdcRead_1
   \   000045   0F           DB        15
   \   000046   ....         DW        ??MT_SysAdcRead_2
   \   000048   ....         DW        ??MT_SysAdcRead_3
    727            {
    728              /* Analog input channel */
    729              case HAL_ADC_CHANNEL_0:
    730              case HAL_ADC_CHANNEL_1:
    731              case HAL_ADC_CHANNEL_2:
    732              case HAL_ADC_CHANNEL_3:
    733              case HAL_ADC_CHANNEL_4:
    734              case HAL_ADC_CHANNEL_5:
    735              case HAL_ADC_CHANNEL_6:
    736              case HAL_ADC_CHANNEL_7:
    737                tempValue = HalAdcRead(channel, resolution);
   \                     ??MT_SysAdcRead_0:
   \   00004A                ; Setup parameters for call to function HalAdcRead
   \   00004A   E8           MOV     A,R0
   \   00004B   FA           MOV     R2,A
   \   00004C   12....       LCALL   ??HalAdcRead?relay
   \   00004F   8A..         MOV     ?V0 + 0,R2
   \   000051   8B..         MOV     ?V0 + 1,R3
   \   000053   A8..         MOV     R0,?V0 + 0
   \   000055   A9..         MOV     R1,?V0 + 1
    738                break;
   \   000057   8026         SJMP    ??MT_SysAdcRead_4
    739          
    740              /* Temperature sensor */
    741              case(HAL_ADC_CHANNEL_TEMP):
    742                tempValue = HalAdcRead(HAL_ADC_CHANNEL_TEMP, HAL_ADC_RESOLUTION_14);
   \                     ??MT_SysAdcRead_1:
   \   000059                ; Setup parameters for call to function HalAdcRead
   \   000059   7A04         MOV     R2,#0x4
   \   00005B   790E         MOV     R1,#0xe
   \   00005D   12....       LCALL   ??HalAdcRead?relay
   \   000060   8A..         MOV     ?V0 + 0,R2
   \   000062   8B..         MOV     ?V0 + 1,R3
   \   000064   A8..         MOV     R0,?V0 + 0
   \   000066   A9..         MOV     R1,?V0 + 1
    743                break;
   \   000068   8015         SJMP    ??MT_SysAdcRead_4
    744          
    745              /* Voltage reading */
    746              case(HAL_ADC_CHANNEL_VDD):
    747                tempValue = HalAdcRead(HAL_ADC_CHANNEL_VDD, HAL_ADC_RESOLUTION_14);
   \                     ??MT_SysAdcRead_2:
   \   00006A                ; Setup parameters for call to function HalAdcRead
   \   00006A   7A04         MOV     R2,#0x4
   \   00006C   790F         MOV     R1,#0xf
   \   00006E   12....       LCALL   ??HalAdcRead?relay
   \   000071   8A..         MOV     ?V0 + 0,R2
   \   000073   8B..         MOV     ?V0 + 1,R3
   \   000075   A8..         MOV     R0,?V0 + 0
   \   000077   A9..         MOV     R1,?V0 + 1
    748                break;
   \   000079   8004         SJMP    ??MT_SysAdcRead_4
    749          
    750              /* Undefined channels */
    751              default:
    752                tempValue = 0x00;
   \                     ??MT_SysAdcRead_3:
   \   00007B   7800         MOV     R0,#0x0
   \   00007D   7900         MOV     R1,#0x0
    753                break;
    754            }
    755          
    756            retArray[0] = LO_UINT16(tempValue);
   \                     ??MT_SysAdcRead_4:
   \   00007F   E8           MOV     A,R0
   \   000080   85..82       MOV     DPL,?XSP + 0
   \   000083   85..83       MOV     DPH,?XSP + 1
   \   000086   F0           MOVX    @DPTR,A
    757            retArray[1] = HI_UINT16(tempValue);
   \   000087   E4           CLR     A
   \   000088   E9           MOV     A,R1
   \   000089   F8           MOV     R0,A
   \   00008A   C0E0         PUSH    A
   \   00008C   7401         MOV     A,#0x1
   \   00008E   12....       LCALL   ?XSTACK_DISP0_8
   \   000091   D0E0         POP     A
   \   000093   F0           MOVX    @DPTR,A
    758          
    759            /* Build and send back the response */
    760            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS), cmdId, 2, retArray);
   \   000094                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000094   85..82       MOV     DPL,?XSP + 0
   \   000097   85..83       MOV     DPH,?XSP + 1
   \   00009A   AC82         MOV     R4,DPL
   \   00009C   AD83         MOV     R5,DPH
   \   00009E   7B02         MOV     R3,#0x2
   \   0000A0   EE           MOV     A,R6
   \   0000A1   FA           MOV     R2,A
   \   0000A2   7961         MOV     R1,#0x61
   \   0000A4   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    761          #endif /* #ifndef HAL_BOARD_LM3S */
    762          }
   \   0000A7   7402         MOV     A,#0x2
   \   0000A9   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000AC   7F02         MOV     R7,#0x2
   \   0000AE   02....       LJMP    ?BANKED_LEAVE_XDATA
    763          
    764          /**************************************************************************************************
    765           * @fn      MT_SysGpio
    766           *
    767           * @brief   ZAccel RPC interface for controlling the available GPIO pins.
    768           *
    769           * @param   uint8 pData - Pointer to the data.
    770           *
    771           * @return  None
    772           *************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    773          void MT_SysGpio(uint8 *pBuf)
   \                     MT_SysGpio:
    774          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 1
   \   000004   74FF         MOV     A,#-0x1
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
   \   000009   EA           MOV     A,R2
   \   00000A   F8           MOV     R0,A
   \   00000B   EB           MOV     A,R3
   \   00000C   F9           MOV     R1,A
    775            uint8 cmd, val;
    776            GPIO_Op_t op;
    777          
    778            cmd = pBuf[MT_RPC_POS_CMD1];
   \   00000D   8882         MOV     DPL,R0
   \   00000F   8983         MOV     DPH,R1
   \   000011   A3           INC     DPTR
   \   000012   A3           INC     DPTR
   \   000013   E0           MOVX    A,@DPTR
   \   000014   FA           MOV     R2,A
    779            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000015   E8           MOV     A,R0
   \   000016   2403         ADD     A,#0x3
   \   000018   F8           MOV     R0,A
   \   000019   E9           MOV     A,R1
   \   00001A   3400         ADDC    A,#0x0
   \   00001C   F9           MOV     R1,A
    780          
    781            op = (GPIO_Op_t)(*pBuf++);
   \   00001D   8882         MOV     DPL,R0
   \   00001F   8983         MOV     DPH,R1
   \   000021   E0           MOVX    A,@DPTR
   \   000022   FB           MOV     R3,A
   \   000023   8882         MOV     DPL,R0
   \   000025   8983         MOV     DPH,R1
   \   000027   A3           INC     DPTR
   \   000028   A882         MOV     R0,DPL
   \   00002A   A983         MOV     R1,DPH
    782            val = *pBuf;
   \   00002C   8882         MOV     DPL,R0
   \   00002E   8983         MOV     DPH,R1
   \   000030   E0           MOVX    A,@DPTR
   \   000031   85..82       MOV     DPL,?XSP + 0
   \   000034   85..83       MOV     DPH,?XSP + 1
   \   000037   F0           MOVX    @DPTR,A
    783          
    784            switch (op)
   \   000038   EB           MOV     A,R3
   \   000039   606C         JZ      ??MT_SysGpio_0
   \   00003B   14           DEC     A
   \   00003C   6012         JZ      ??MT_SysGpio_1
   \   00003E   14           DEC     A
   \   00003F   6066         JZ      ??MT_SysGpio_0
   \   000041   14           DEC     A
   \   000042   6063         JZ      ??MT_SysGpio_0
   \   000044   14           DEC     A
   \   000045   6060         JZ      ??MT_SysGpio_0
   \   000047   14           DEC     A
   \   000048   605D         JZ      ??MT_SysGpio_0
   \   00004A   24F3         ADD     A,#-0xd
   \   00004C   6028         JZ      ??MT_SysGpio_2
   \   00004E   8057         SJMP    ??MT_SysGpio_0
    785            {
    786              case GPIO_DIR:
    787                if (val & BV(0)) {GPIO_DIR_OUT(0);} else {GPIO_DIR_IN(0);}
    788                if (val & BV(1)) {GPIO_DIR_OUT(1);} else {GPIO_DIR_IN(1);}
    789                if (val & BV(2)) {GPIO_DIR_OUT(2);} else {GPIO_DIR_IN(2);}
    790                if (val & BV(3)) {GPIO_DIR_OUT(3);} else {GPIO_DIR_IN(3);}
    791                break;
    792          
    793              case GPIO_TRI:
    794                if(val & BV(0)) {GPIO_TRI(0);} else if(val & BV(4)) {GPIO_PULL_DN(0);} else {GPIO_PULL_UP(0);}
   \                     ??MT_SysGpio_1:
   \   000050   85..82       MOV     DPL,?XSP + 0
   \   000053   85..83       MOV     DPH,?XSP + 1
   \   000056   E0           MOVX    A,@DPTR
   \   000057   A2E0         MOV     C,0xE0 /* A   */.0
    795                if(val & BV(1)) {GPIO_TRI(1);} else if(val & BV(5)) {GPIO_PULL_DN(1);} else {GPIO_PULL_UP(1);}
   \   000059   85..82       MOV     DPL,?XSP + 0
   \   00005C   85..83       MOV     DPH,?XSP + 1
   \   00005F   E0           MOVX    A,@DPTR
   \   000060   A2E1         MOV     C,0xE0 /* A   */.1
    796                if(val & BV(2)) {GPIO_TRI(2);} else if(val & BV(6)) {GPIO_PULL_DN(2);} else {GPIO_PULL_UP(2);}
   \   000062   85..82       MOV     DPL,?XSP + 0
   \   000065   85..83       MOV     DPH,?XSP + 1
   \   000068   E0           MOVX    A,@DPTR
   \   000069   A2E2         MOV     C,0xE0 /* A   */.2
    797                if(val & BV(3)) {GPIO_TRI(3);} else if(val & BV(7)) {GPIO_PULL_DN(3);} else {GPIO_PULL_UP(3);}
   \   00006B   85..82       MOV     DPL,?XSP + 0
   \   00006E   85..83       MOV     DPH,?XSP + 1
   \   000071   E0           MOVX    A,@DPTR
   \   000072   A2E3         MOV     C,0xE0 /* A   */.3
    798                break;
   \   000074   8031         SJMP    ??MT_SysGpio_0
    799          
    800              case GPIO_SET:
    801                if (val & BV(0)) {GPIO_SET(0);}
    802                if (val & BV(1)) {GPIO_SET(1);}
    803                if (val & BV(2)) {GPIO_SET(2);}
    804                if (val & BV(3)) {GPIO_SET(3);}
    805                break;
    806          
    807              case GPIO_CLR:
    808                if (val & BV(0)) {GPIO_CLR(0);}
    809                if (val & BV(1)) {GPIO_CLR(1);}
    810                if (val & BV(2)) {GPIO_CLR(2);}
    811                if (val & BV(3)) {GPIO_CLR(3);}
    812                break;
    813          
    814              case GPIO_TOG:
    815                if (val & BV(0)) {GPIO_TOG(0);}
    816                if (val & BV(1)) {GPIO_TOG(1);}
    817                if (val & BV(2)) {GPIO_TOG(2);}
    818                if (val & BV(3)) {GPIO_TOG(3);}
    819                break;
    820          
    821              case GPIO_GET:
    822                break;
    823          
    824              case GPIO_HiD:
    825                (val) ? GPIO_HiD_SET() :  GPIO_HiD_CLR();
   \                     ??MT_SysGpio_2:
   \   000076   85..82       MOV     DPL,?XSP + 0
   \   000079   85..83       MOV     DPH,?XSP + 1
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   6015         JZ      ??MT_SysGpio_3
   \   00007F   7800         MOV     R0,#0x0
   \   000081   E8           MOV     A,R0
   \   000082   85..82       MOV     DPL,?XSP + 0
   \   000085   85..83       MOV     DPH,?XSP + 1
   \   000088   F0           MOVX    @DPTR,A
   \   000089   8882         MOV     DPL,R0
   \   00008B   758300       MOV     DPH,#0x0
   \   00008E   A882         MOV     R0,DPL
   \   000090   A983         MOV     R1,DPH
   \   000092   8013         SJMP    ??MT_SysGpio_0
   \                     ??MT_SysGpio_3:
   \   000094   7800         MOV     R0,#0x0
   \   000096   E8           MOV     A,R0
   \   000097   85..82       MOV     DPL,?XSP + 0
   \   00009A   85..83       MOV     DPH,?XSP + 1
   \   00009D   F0           MOVX    @DPTR,A
   \   00009E   8882         MOV     DPL,R0
   \   0000A0   758300       MOV     DPH,#0x0
   \   0000A3   A882         MOV     R0,DPL
   \   0000A5   A983         MOV     R1,DPH
    826                break;
    827          
    828              default:
    829                break;
    830            }
    831          
    832            val  = (GPIO_GET(0)) ? BV(0) : 0;
   \                     ??MT_SysGpio_0:
   \   0000A7   85..82       MOV     DPL,?XSP + 0
   \   0000AA   85..83       MOV     DPH,?XSP + 1
   \   0000AD   7400         MOV     A,#0x0
   \   0000AF   F0           MOVX    @DPTR,A
    833            val |= (GPIO_GET(1)) ? BV(1) : 0;
   \   0000B0   85..82       MOV     DPL,?XSP + 0
   \   0000B3   85..83       MOV     DPH,?XSP + 1
   \   0000B6   E0           MOVX    A,@DPTR
   \   0000B7   85..82       MOV     DPL,?XSP + 0
   \   0000BA   85..83       MOV     DPH,?XSP + 1
   \   0000BD   F0           MOVX    @DPTR,A
    834            val |= (GPIO_GET(2)) ? BV(2) : 0;
   \   0000BE   85..82       MOV     DPL,?XSP + 0
   \   0000C1   85..83       MOV     DPH,?XSP + 1
   \   0000C4   E0           MOVX    A,@DPTR
   \   0000C5   85..82       MOV     DPL,?XSP + 0
   \   0000C8   85..83       MOV     DPH,?XSP + 1
   \   0000CB   F0           MOVX    @DPTR,A
    835            val |= (GPIO_GET(3)) ? BV(3) : 0;
   \   0000CC   85..82       MOV     DPL,?XSP + 0
   \   0000CF   85..83       MOV     DPH,?XSP + 1
   \   0000D2   E0           MOVX    A,@DPTR
   \   0000D3   85..82       MOV     DPL,?XSP + 0
   \   0000D6   85..83       MOV     DPH,?XSP + 1
   \   0000D9   F0           MOVX    @DPTR,A
    836          
    837            /* Build and send back the response */
    838            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS), cmd, 1, &val);
   \   0000DA                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000DA   85..82       MOV     DPL,?XSP + 0
   \   0000DD   85..83       MOV     DPH,?XSP + 1
   \   0000E0   AC82         MOV     R4,DPL
   \   0000E2   AD83         MOV     R5,DPH
   \   0000E4   7B01         MOV     R3,#0x1
   \   0000E6   7961         MOV     R1,#0x61
   \   0000E8   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    839          }
   \   0000EB   7401         MOV     A,#0x1
   \   0000ED   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000F0   D083         POP     DPH
   \   0000F2   D082         POP     DPL
   \   0000F4   02....       LJMP    ?BRET
    840          
    841          /**************************************************************************************************
    842           * @fn      MT_SysStackTune
    843           *
    844           * @brief   ZAccel RPC interface for tuning the stack parameters to adjust performance
    845           *
    846           * @param   uint8 pData - Pointer to the data.
    847           *
    848           * @return  None
    849           *************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    850          void MT_SysStackTune(uint8 *pBuf)
   \                     MT_SysStackTune:
    851          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    852            uint8 cmd, rtrn;
    853          
    854            cmd = pBuf[MT_RPC_POS_CMD1];
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   FE           MOV     R6,A
    855            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000012   EA           MOV     A,R2
   \   000013   2403         ADD     A,#0x3
   \   000015   FA           MOV     R2,A
   \   000016   EB           MOV     A,R3
   \   000017   3400         ADDC    A,#0x0
   \   000019   FB           MOV     R3,A
    856          
    857            switch (*pBuf++)
   \   00001A   EA           MOV     A,R2
   \   00001B   F8           MOV     R0,A
   \   00001C   EB           MOV     A,R3
   \   00001D   F9           MOV     R1,A
   \   00001E   8882         MOV     DPL,R0
   \   000020   8983         MOV     DPH,R1
   \   000022   A3           INC     DPTR
   \   000023   AA82         MOV     R2,DPL
   \   000025   AB83         MOV     R3,DPH
   \   000027   8882         MOV     DPL,R0
   \   000029   8983         MOV     DPH,R1
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   6005         JZ      ??MT_SysStackTune_0
   \   00002E   14           DEC     A
   \   00002F   6011         JZ      ??MT_SysStackTune_1
   \   000031   8040         SJMP    ??MT_SysStackTune_2
    858            {
    859            case STK_TX_PWR:
    860              rtrn = ZMacSetReq(ZMacPhyTransmitPowerSigned, pBuf);
   \                     ??MT_SysStackTune_0:
   \   000033                ; Setup parameters for call to function ZMacSetReq
   \   000033   79E5         MOV     R1,#-0x1b
   \   000035   12....       LCALL   ??ZMacSetReq?relay
   \   000038   E9           MOV     A,R1
   \   000039   85..82       MOV     DPL,?XSP + 0
   \   00003C   85..83       MOV     DPH,?XSP + 1
   \   00003F   F0           MOVX    @DPTR,A
    861              break;
   \   000040   803A         SJMP    ??MT_SysStackTune_3
    862          
    863            case STK_RX_ON_IDLE:
    864              if ((*pBuf != TRUE) && (*pBuf != FALSE))
   \                     ??MT_SysStackTune_1:
   \   000042   8A82         MOV     DPL,R2
   \   000044   8B83         MOV     DPH,R3
   \   000046   E0           MOVX    A,@DPTR
   \   000047   6401         XRL     A,#0x1
   \   000049   6019         JZ      ??MT_SysStackTune_4
   \   00004B   8A82         MOV     DPL,R2
   \   00004D   8B83         MOV     DPH,R3
   \   00004F   E0           MOVX    A,@DPTR
   \   000050   6012         JZ      ??MT_SysStackTune_4
    865              {
    866                (void)ZMacGetReq(ZMacRxOnIdle, &rtrn);
   \   000052                ; Setup parameters for call to function ZMacGetReq
   \   000052   85..82       MOV     DPL,?XSP + 0
   \   000055   85..83       MOV     DPH,?XSP + 1
   \   000058   AA82         MOV     R2,DPL
   \   00005A   AB83         MOV     R3,DPH
   \   00005C   7952         MOV     R1,#0x52
   \   00005E   12....       LCALL   ??ZMacGetReq?relay
   \   000061   E9           MOV     A,R1
   \   000062   8018         SJMP    ??MT_SysStackTune_3
    867              }
    868              else
    869              {
    870                rtrn = ZMacSetReq(ZMacRxOnIdle, pBuf);
   \                     ??MT_SysStackTune_4:
   \   000064                ; Setup parameters for call to function ZMacSetReq
   \   000064   7952         MOV     R1,#0x52
   \   000066   12....       LCALL   ??ZMacSetReq?relay
   \   000069   E9           MOV     A,R1
   \   00006A   85..82       MOV     DPL,?XSP + 0
   \   00006D   85..83       MOV     DPH,?XSP + 1
   \   000070   F0           MOVX    @DPTR,A
    871              }
    872              break;
   \   000071   8009         SJMP    ??MT_SysStackTune_3
    873          
    874            default:
    875              rtrn = ZInvalidParameter;
   \                     ??MT_SysStackTune_2:
   \   000073   85..82       MOV     DPL,?XSP + 0
   \   000076   85..83       MOV     DPH,?XSP + 1
   \   000079   7402         MOV     A,#0x2
   \   00007B   F0           MOVX    @DPTR,A
    876              break;
    877            }
    878          
    879            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS), cmd, 1, &rtrn);
   \                     ??MT_SysStackTune_3:
   \   00007C                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00007C   85..82       MOV     DPL,?XSP + 0
   \   00007F   85..83       MOV     DPH,?XSP + 1
   \   000082   AC82         MOV     R4,DPL
   \   000084   AD83         MOV     R5,DPH
   \   000086   7B01         MOV     R3,#0x1
   \   000088   EE           MOV     A,R6
   \   000089   FA           MOV     R2,A
   \   00008A   7961         MOV     R1,#0x61
   \   00008C   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    880          }
   \   00008F   7401         MOV     A,#0x1
   \   000091   12....       LCALL   ?DEALLOC_XSTACK8
   \   000094   7F01         MOV     R7,#0x1
   \   000096   02....       LJMP    ?BANKED_LEAVE_XDATA
    881          
    882          /***************************************************************************************************
    883           * @fn      MT_SysSetUtcTime
    884           *
    885           * @brief   Set the OSAL UTC Time. UTC rollover is: 06:28:16 02/07/2136
    886           *
    887           * @param   pBuf - pointer to time parameters
    888           *
    889           * @return  None
    890           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    891          void MT_SysSetUtcTime(uint8 *pBuf)
   \                     MT_SysSetUtcTime:
    892          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 8
   \   000005   74F8         MOV     A,#-0x8
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    893            uint8 cmdId;
    894            uint8 retStat;
    895            UTCTime utcSecs;
    896          
    897            /* Parse header */
    898            cmdId = pBuf[MT_RPC_POS_CMD1];
   \   00000E   8E82         MOV     DPL,R6
   \   000010   8F83         MOV     DPH,R7
   \   000012   A3           INC     DPTR
   \   000013   A3           INC     DPTR
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F5..         MOV     ?V0 + 0,A
    899            pBuf += MT_RPC_FRAME_HDR_SZ;
   \   000017   EE           MOV     A,R6
   \   000018   2403         ADD     A,#0x3
   \   00001A   FE           MOV     R6,A
   \   00001B   EF           MOV     A,R7
   \   00001C   3400         ADDC    A,#0x0
   \   00001E   FF           MOV     R7,A
    900          
    901            utcSecs = osal_build_uint32( pBuf, 4 );
   \   00001F                ; Setup parameters for call to function osal_build_uint32
   \   00001F   7904         MOV     R1,#0x4
   \   000021   EE           MOV     A,R6
   \   000022   FA           MOV     R2,A
   \   000023   EF           MOV     A,R7
   \   000024   FB           MOV     R3,A
   \   000025   12....       LCALL   ??osal_build_uint32?relay
   \   000028   8A..         MOV     ?V0 + 4,R2
   \   00002A   8B..         MOV     ?V0 + 5,R3
   \   00002C   8C..         MOV     ?V0 + 6,R4
   \   00002E   8D..         MOV     ?V0 + 7,R5
    902            if ( utcSecs == 0 )
   \   000030   E5..         MOV     A,?V0 + 4
   \   000032   45..         ORL     A,?V0 + 5
   \   000034   45..         ORL     A,?V0 + 6
   \   000036   45..         ORL     A,?V0 + 7
   \   000038   6003         JZ      $+5
   \   00003A   02....       LJMP    ??MT_SysSetUtcTime_0 & 0xFFFF
    903            {
    904              UTCTimeStruct utc;
    905          
    906              /* Skip past UTC time */
    907              pBuf += 4;
   \   00003D   EE           MOV     A,R6
   \   00003E   2404         ADD     A,#0x4
   \   000040   FE           MOV     R6,A
   \   000041   EF           MOV     A,R7
   \   000042   3400         ADDC    A,#0x0
   \   000044   FF           MOV     R7,A
    908          
    909              /* Get time and date parameters */
    910              utc.hour = *pBuf++;
   \   000045   8E82         MOV     DPL,R6
   \   000047   8F83         MOV     DPH,R7
   \   000049   E0           MOVX    A,@DPTR
   \   00004A   C0E0         PUSH    A
   \   00004C   7403         MOV     A,#0x3
   \   00004E   12....       LCALL   ?XSTACK_DISP0_8
   \   000051   D0E0         POP     A
   \   000053   F0           MOVX    @DPTR,A
   \   000054   8E82         MOV     DPL,R6
   \   000056   8F83         MOV     DPH,R7
   \   000058   A3           INC     DPTR
   \   000059   AE82         MOV     R6,DPL
   \   00005B   AF83         MOV     R7,DPH
    911              utc.minutes = *pBuf++;
   \   00005D   8E82         MOV     DPL,R6
   \   00005F   8F83         MOV     DPH,R7
   \   000061   E0           MOVX    A,@DPTR
   \   000062   C0E0         PUSH    A
   \   000064   7402         MOV     A,#0x2
   \   000066   12....       LCALL   ?XSTACK_DISP0_8
   \   000069   D0E0         POP     A
   \   00006B   F0           MOVX    @DPTR,A
   \   00006C   8E82         MOV     DPL,R6
   \   00006E   8F83         MOV     DPH,R7
   \   000070   A3           INC     DPTR
   \   000071   AE82         MOV     R6,DPL
   \   000073   AF83         MOV     R7,DPH
    912              utc.seconds = *pBuf++;
   \   000075   8E82         MOV     DPL,R6
   \   000077   8F83         MOV     DPH,R7
   \   000079   E0           MOVX    A,@DPTR
   \   00007A   C0E0         PUSH    A
   \   00007C   7401         MOV     A,#0x1
   \   00007E   12....       LCALL   ?XSTACK_DISP0_8
   \   000081   D0E0         POP     A
   \   000083   F0           MOVX    @DPTR,A
   \   000084   8E82         MOV     DPL,R6
   \   000086   8F83         MOV     DPH,R7
   \   000088   A3           INC     DPTR
   \   000089   AE82         MOV     R6,DPL
   \   00008B   AF83         MOV     R7,DPH
    913              utc.month = (*pBuf++) - 1;
   \   00008D   8E82         MOV     DPL,R6
   \   00008F   8F83         MOV     DPH,R7
   \   000091   E0           MOVX    A,@DPTR
   \   000092   24FF         ADD     A,#-0x1
   \   000094   C0E0         PUSH    A
   \   000096   7405         MOV     A,#0x5
   \   000098   12....       LCALL   ?XSTACK_DISP0_8
   \   00009B   D0E0         POP     A
   \   00009D   F0           MOVX    @DPTR,A
   \   00009E   8E82         MOV     DPL,R6
   \   0000A0   8F83         MOV     DPH,R7
   \   0000A2   A3           INC     DPTR
   \   0000A3   AE82         MOV     R6,DPL
   \   0000A5   AF83         MOV     R7,DPH
    914              utc.day = (*pBuf++) - 1;
   \   0000A7   8E82         MOV     DPL,R6
   \   0000A9   8F83         MOV     DPH,R7
   \   0000AB   E0           MOVX    A,@DPTR
   \   0000AC   24FF         ADD     A,#-0x1
   \   0000AE   C0E0         PUSH    A
   \   0000B0   7404         MOV     A,#0x4
   \   0000B2   12....       LCALL   ?XSTACK_DISP0_8
   \   0000B5   D0E0         POP     A
   \   0000B7   F0           MOVX    @DPTR,A
   \   0000B8   8E82         MOV     DPL,R6
   \   0000BA   8F83         MOV     DPH,R7
   \   0000BC   A3           INC     DPTR
   \   0000BD   AE82         MOV     R6,DPL
   \   0000BF   AF83         MOV     R7,DPH
    915              utc.year = osal_build_uint16 ( pBuf );
   \   0000C1                ; Setup parameters for call to function osal_build_uint16
   \   0000C1   E582         MOV     A,DPL
   \   0000C3   AA82         MOV     R2,DPL
   \   0000C5   E583         MOV     A,DPH
   \   0000C7   AB83         MOV     R3,DPH
   \   0000C9   12....       LCALL   ??osal_build_uint16?relay
   \   0000CC   7406         MOV     A,#0x6
   \   0000CE   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D1   EA           MOV     A,R2
   \   0000D2   F0           MOVX    @DPTR,A
   \   0000D3   A3           INC     DPTR
   \   0000D4   EB           MOV     A,R3
   \   0000D5   F0           MOVX    @DPTR,A
    916          
    917              if ((utc.hour < 24) && (utc.minutes < 60) && (utc.seconds < 60) &&
    918                  (utc.month < 12) && (utc.day < 31) && (utc.year > 1999) && (utc.year < 2136))
   \   0000D6   7403         MOV     A,#0x3
   \   0000D8   12....       LCALL   ?XSTACK_DISP0_8
   \   0000DB   E0           MOVX    A,@DPTR
   \   0000DC   C3           CLR     C
   \   0000DD   9418         SUBB    A,#0x18
   \   0000DF   4003         JC      $+5
   \   0000E1   02....       LJMP    ??MT_SysSetUtcTime_0 & 0xFFFF
   \   0000E4   7402         MOV     A,#0x2
   \   0000E6   12....       LCALL   ?XSTACK_DISP0_8
   \   0000E9   E0           MOVX    A,@DPTR
   \   0000EA   C3           CLR     C
   \   0000EB   943C         SUBB    A,#0x3c
   \   0000ED   4003         JC      $+5
   \   0000EF   02....       LJMP    ??MT_SysSetUtcTime_0 & 0xFFFF
   \   0000F2   7401         MOV     A,#0x1
   \   0000F4   12....       LCALL   ?XSTACK_DISP0_8
   \   0000F7   E0           MOVX    A,@DPTR
   \   0000F8   C3           CLR     C
   \   0000F9   943C         SUBB    A,#0x3c
   \   0000FB   4003         JC      $+5
   \   0000FD   02....       LJMP    ??MT_SysSetUtcTime_0 & 0xFFFF
   \   000100   7405         MOV     A,#0x5
   \   000102   12....       LCALL   ?XSTACK_DISP0_8
   \   000105   E0           MOVX    A,@DPTR
   \   000106   C3           CLR     C
   \   000107   940C         SUBB    A,#0xc
   \   000109   4003         JC      $+5
   \   00010B   02....       LJMP    ??MT_SysSetUtcTime_0 & 0xFFFF
   \   00010E   7404         MOV     A,#0x4
   \   000110   12....       LCALL   ?XSTACK_DISP0_8
   \   000113   E0           MOVX    A,@DPTR
   \   000114   C3           CLR     C
   \   000115   941F         SUBB    A,#0x1f
   \   000117   4003         JC      $+5
   \   000119   02....       LJMP    ??MT_SysSetUtcTime_0 & 0xFFFF
   \   00011C   7406         MOV     A,#0x6
   \   00011E   12....       LCALL   ?XSTACK_DISP0_8
   \   000121   E0           MOVX    A,@DPTR
   \   000122   C3           CLR     C
   \   000123   94D0         SUBB    A,#-0x30
   \   000125   F8           MOV     R0,A
   \   000126   A3           INC     DPTR
   \   000127   E0           MOVX    A,@DPTR
   \   000128   9407         SUBB    A,#0x7
   \   00012A   F9           MOV     R1,A
   \   00012B   C3           CLR     C
   \   00012C   E8           MOV     A,R0
   \   00012D   9488         SUBB    A,#-0x78
   \   00012F   E9           MOV     A,R1
   \   000130   9400         SUBB    A,#0x0
   \   000132   4003         JC      $+5
   \   000134   02....       LJMP    ??MT_SysSetUtcTime_0 & 0xFFFF
    919              {
    920                /* Got past the course filter, now check for leap year */
    921                if ((utc.month != 1) || (utc.day < (IsLeapYear( utc.year ) ? 29 : 28)))
   \   000137   7405         MOV     A,#0x5
   \   000139   12....       LCALL   ?XSTACK_DISP0_8
   \   00013C   E0           MOVX    A,@DPTR
   \   00013D   6401         XRL     A,#0x1
   \   00013F   706F         JNZ     ??MT_SysSetUtcTime_1
   \   000141   7406         MOV     A,#0x6
   \   000143   12....       LCALL   ?XSTACK_DISP0_8
   \   000146   E0           MOVX    A,@DPTR
   \   000147   F8           MOV     R0,A
   \   000148   A3           INC     DPTR
   \   000149   E0           MOVX    A,@DPTR
   \   00014A   F9           MOV     R1,A
   \   00014B   7A90         MOV     R2,#-0x70
   \   00014D   7B01         MOV     R3,#0x1
   \   00014F   12....       LCALL   ?US_DIV_MOD
   \   000152   8A..         MOV     ?V0 + 2,R2
   \   000154   8B..         MOV     ?V0 + 3,R3
   \   000156   E5..         MOV     A,?V0 + 2
   \   000158   45..         ORL     A,?V0 + 3
   \   00015A   6036         JZ      ??MT_SysSetUtcTime_2
   \   00015C   7406         MOV     A,#0x6
   \   00015E   12....       LCALL   ?XSTACK_DISP0_8
   \   000161   E0           MOVX    A,@DPTR
   \   000162   F8           MOV     R0,A
   \   000163   A3           INC     DPTR
   \   000164   E0           MOVX    A,@DPTR
   \   000165   F9           MOV     R1,A
   \   000166   7A64         MOV     R2,#0x64
   \   000168   7B00         MOV     R3,#0x0
   \   00016A   12....       LCALL   ?US_DIV_MOD
   \   00016D   8A..         MOV     ?V0 + 2,R2
   \   00016F   8B..         MOV     ?V0 + 3,R3
   \   000171   E5..         MOV     A,?V0 + 2
   \   000173   45..         ORL     A,?V0 + 3
   \   000175   6021         JZ      ??MT_SysSetUtcTime_3
   \   000177   7406         MOV     A,#0x6
   \   000179   12....       LCALL   ?XSTACK_DISP0_8
   \   00017C   E0           MOVX    A,@DPTR
   \   00017D   F8           MOV     R0,A
   \   00017E   A3           INC     DPTR
   \   00017F   E0           MOVX    A,@DPTR
   \   000180   F9           MOV     R1,A
   \   000181   7A04         MOV     R2,#0x4
   \   000183   7B00         MOV     R3,#0x0
   \   000185   12....       LCALL   ?US_DIV_MOD
   \   000188   8A..         MOV     ?V0 + 2,R2
   \   00018A   8B..         MOV     ?V0 + 3,R3
   \   00018C   E5..         MOV     A,?V0 + 2
   \   00018E   45..         ORL     A,?V0 + 3
   \   000190   7006         JNZ     ??MT_SysSetUtcTime_3
   \                     ??MT_SysSetUtcTime_2:
   \   000192   781D         MOV     R0,#0x1d
   \   000194   7900         MOV     R1,#0x0
   \   000196   8004         SJMP    ??MT_SysSetUtcTime_4
   \                     ??MT_SysSetUtcTime_3:
   \   000198   781C         MOV     R0,#0x1c
   \   00019A   7900         MOV     R1,#0x0
   \                     ??MT_SysSetUtcTime_4:
   \   00019C   7404         MOV     A,#0x4
   \   00019E   12....       LCALL   ?XSTACK_DISP0_8
   \   0001A1   E0           MOVX    A,@DPTR
   \   0001A2   FA           MOV     R2,A
   \   0001A3   7B00         MOV     R3,#0x0
   \   0001A5   C3           CLR     C
   \   0001A6   98           SUBB    A,R0
   \   0001A7   EB           MOV     A,R3
   \   0001A8   99           SUBB    A,R1
   \   0001A9   A2D2         MOV     C,0xD0 /* PSW */.2
   \   0001AB   65D0         XRL     A,PSW
   \   0001AD   33           RLC     A
   \   0001AE   5014         JNC     ??MT_SysSetUtcTime_0
    922                {
    923                  /* Numbers look reasonable, convert to UTC */
    924                  utcSecs = osal_ConvertUTCSecs( &utc );
   \                     ??MT_SysSetUtcTime_1:
   \   0001B0                ; Setup parameters for call to function osal_ConvertUTCSecs
   \   0001B0   7401         MOV     A,#0x1
   \   0001B2   12....       LCALL   ?XSTACK_DISP0_8
   \   0001B5   AA82         MOV     R2,DPL
   \   0001B7   AB83         MOV     R3,DPH
   \   0001B9   12....       LCALL   ??osal_ConvertUTCSecs?relay
   \   0001BC   8A..         MOV     ?V0 + 4,R2
   \   0001BE   8B..         MOV     ?V0 + 5,R3
   \   0001C0   8C..         MOV     ?V0 + 6,R4
   \   0001C2   8D..         MOV     ?V0 + 7,R5
    925                }
    926              }
    927            }
    928          
    929            if ( utcSecs == 0 )
   \                     ??MT_SysSetUtcTime_0:
   \   0001C4   E5..         MOV     A,?V0 + 4
   \   0001C6   45..         ORL     A,?V0 + 5
   \   0001C8   45..         ORL     A,?V0 + 6
   \   0001CA   45..         ORL     A,?V0 + 7
   \   0001CC   700B         JNZ     ??MT_SysSetUtcTime_5
    930            {
    931              /* Bad parameter(s) */
    932              retStat = ZInvalidParameter;
   \   0001CE   85..82       MOV     DPL,?XSP + 0
   \   0001D1   85..83       MOV     DPH,?XSP + 1
   \   0001D4   7402         MOV     A,#0x2
   \   0001D6   F0           MOVX    @DPTR,A
   \   0001D7   8014         SJMP    ??MT_SysSetUtcTime_6
    933            }
    934            else
    935            {
    936              /* Parameters accepted, set the time */
    937              osal_setClock( utcSecs );
   \                     ??MT_SysSetUtcTime_5:
   \   0001D9                ; Setup parameters for call to function osal_setClock
   \   0001D9   AA..         MOV     R2,?V0 + 4
   \   0001DB   AB..         MOV     R3,?V0 + 5
   \   0001DD   AC..         MOV     R4,?V0 + 6
   \   0001DF   AD..         MOV     R5,?V0 + 7
   \   0001E1   12....       LCALL   ??osal_setClock?relay
    938              retStat = ZSuccess;
   \   0001E4   85..82       MOV     DPL,?XSP + 0
   \   0001E7   85..83       MOV     DPH,?XSP + 1
   \   0001EA   7400         MOV     A,#0x0
   \   0001EC   F0           MOVX    @DPTR,A
    939            }
    940          
    941            /* Build and send back the response */
    942            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS),
    943                                           cmdId, 1, &retStat);
   \                     ??MT_SysSetUtcTime_6:
   \   0001ED                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0001ED   85..82       MOV     DPL,?XSP + 0
   \   0001F0   85..83       MOV     DPH,?XSP + 1
   \   0001F3   AC82         MOV     R4,DPL
   \   0001F5   AD83         MOV     R5,DPH
   \   0001F7   7B01         MOV     R3,#0x1
   \   0001F9   AA..         MOV     R2,?V0 + 0
   \   0001FB   7961         MOV     R1,#0x61
   \   0001FD   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    944          }
   \   000200   7408         MOV     A,#0x8
   \   000202   12....       LCALL   ?DEALLOC_XSTACK8
   \   000205   7F08         MOV     R7,#0x8
   \   000207   02....       LJMP    ?BANKED_LEAVE_XDATA
    945          
    946          /***************************************************************************************************
    947           * @fn      MT_SysGetUtcTime
    948           *
    949           * @brief   Get the OSAL UTC time
    950           *
    951           * @param   None
    952           *
    953           * @return  32-bit and Parsed UTC time
    954           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    955          void MT_SysGetUtcTime(void)
   \                     MT_SysGetUtcTime:
    956          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 7
   \   000005   74F9         MOV     A,#-0x7
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    957            uint8 len;
    958            uint8 *buf;
    959          
    960            len = sizeof( UTCTime ) + sizeof( UTCTimeStruct );
   \   00000A   75..0B       MOV     ?V0 + 0,#0xb
    961          
    962            buf = osal_mem_alloc( len );
   \   00000D                ; Setup parameters for call to function osal_mem_alloc
   \   00000D   75..00       MOV     ?V0 + 1,#0x0
   \   000010   AA..         MOV     R2,?V0 + 0
   \   000012   AB..         MOV     R3,?V0 + 1
   \   000014   12....       LCALL   ??osal_mem_alloc?relay
   \   000017   8A..         MOV     ?V0 + 0,R2
   \   000019   8B..         MOV     ?V0 + 1,R3
   \   00001B   AE..         MOV     R6,?V0 + 0
   \   00001D   AF..         MOV     R7,?V0 + 1
    963            if ( buf )
   \   00001F   EE           MOV     A,R6
   \   000020   4F           ORL     A,R7
   \   000021   7003         JNZ     $+5
   \   000023   02....       LJMP    ??MT_SysGetUtcTime_0 & 0xFFFF
    964            {
    965              uint8 *pBuf;
    966              UTCTime utcSecs;
    967              UTCTimeStruct utcTime;
    968          
    969              // Get current 32-bit UTC time and parse it
    970              utcSecs = osal_getClock();
   \   000026                ; Setup parameters for call to function osal_getClock
   \   000026   12....       LCALL   ??osal_getClock?relay
   \   000029   8A..         MOV     ?V0 + 0,R2
   \   00002B   8B..         MOV     ?V0 + 1,R3
   \   00002D   8C..         MOV     ?V0 + 2,R4
   \   00002F   8D..         MOV     ?V0 + 3,R5
    971              osal_ConvertUTCTime( &utcTime, utcSecs );
   \   000031                ; Setup parameters for call to function osal_ConvertUTCTime
   \   000031   78..         MOV     R0,#?V0 + 0
   \   000033   12....       LCALL   ?PUSH_XSTACK_I_FOUR
   \   000036   7404         MOV     A,#0x4
   \   000038   12....       LCALL   ?XSTACK_DISP0_8
   \   00003B   AA82         MOV     R2,DPL
   \   00003D   AB83         MOV     R3,DPH
   \   00003F   12....       LCALL   ??osal_ConvertUTCTime?relay
   \   000042   7404         MOV     A,#0x4
   \   000044   12....       LCALL   ?DEALLOC_XSTACK8
    972          
    973              // Start with 32-bit UTC time
    974              pBuf = osal_buffer_uint32( buf, utcSecs );
   \   000047                ; Setup parameters for call to function osal_buffer_uint32
   \   000047   78..         MOV     R0,#?V0 + 0
   \   000049   12....       LCALL   ?PUSH_XSTACK_I_FOUR
   \   00004C   EE           MOV     A,R6
   \   00004D   FA           MOV     R2,A
   \   00004E   EF           MOV     A,R7
   \   00004F   FB           MOV     R3,A
   \   000050   12....       LCALL   ??osal_buffer_uint32?relay
   \   000053   7404         MOV     A,#0x4
   \   000055   12....       LCALL   ?DEALLOC_XSTACK8
   \   000058   8A..         MOV     ?V0 + 0,R2
   \   00005A   8B..         MOV     ?V0 + 1,R3
   \   00005C   A8..         MOV     R0,?V0 + 0
   \   00005E   A9..         MOV     R1,?V0 + 1
    975          
    976              // Concatenate parsed UTC time fields
    977              *pBuf++ = utcTime.hour;
   \   000060   7402         MOV     A,#0x2
   \   000062   12....       LCALL   ?XSTACK_DISP0_8
   \   000065   E0           MOVX    A,@DPTR
   \   000066   8882         MOV     DPL,R0
   \   000068   8983         MOV     DPH,R1
   \   00006A   F0           MOVX    @DPTR,A
   \   00006B   8882         MOV     DPL,R0
   \   00006D   8983         MOV     DPH,R1
   \   00006F   A3           INC     DPTR
   \   000070   A882         MOV     R0,DPL
   \   000072   A983         MOV     R1,DPH
    978              *pBuf++ = utcTime.minutes;
   \   000074   7401         MOV     A,#0x1
   \   000076   12....       LCALL   ?XSTACK_DISP0_8
   \   000079   E0           MOVX    A,@DPTR
   \   00007A   8882         MOV     DPL,R0
   \   00007C   8983         MOV     DPH,R1
   \   00007E   F0           MOVX    @DPTR,A
   \   00007F   8882         MOV     DPL,R0
   \   000081   8983         MOV     DPH,R1
   \   000083   A3           INC     DPTR
   \   000084   A882         MOV     R0,DPL
   \   000086   A983         MOV     R1,DPH
    979              *pBuf++ = utcTime.seconds;
   \   000088   85..82       MOV     DPL,?XSP + 0
   \   00008B   85..83       MOV     DPH,?XSP + 1
   \   00008E   E0           MOVX    A,@DPTR
   \   00008F   8882         MOV     DPL,R0
   \   000091   8983         MOV     DPH,R1
   \   000093   F0           MOVX    @DPTR,A
   \   000094   8882         MOV     DPL,R0
   \   000096   8983         MOV     DPH,R1
   \   000098   A3           INC     DPTR
   \   000099   A882         MOV     R0,DPL
   \   00009B   A983         MOV     R1,DPH
    980              *pBuf++ = utcTime.month + 1;  // Convert to human numbers
   \   00009D   7404         MOV     A,#0x4
   \   00009F   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A2   E0           MOVX    A,@DPTR
   \   0000A3   2401         ADD     A,#0x1
   \   0000A5   8882         MOV     DPL,R0
   \   0000A7   8983         MOV     DPH,R1
   \   0000A9   F0           MOVX    @DPTR,A
   \   0000AA   8882         MOV     DPL,R0
   \   0000AC   8983         MOV     DPH,R1
   \   0000AE   A3           INC     DPTR
   \   0000AF   A882         MOV     R0,DPL
   \   0000B1   A983         MOV     R1,DPH
    981              *pBuf++ = utcTime.day + 1;
   \   0000B3   7403         MOV     A,#0x3
   \   0000B5   12....       LCALL   ?XSTACK_DISP0_8
   \   0000B8   E0           MOVX    A,@DPTR
   \   0000B9   2401         ADD     A,#0x1
   \   0000BB   8882         MOV     DPL,R0
   \   0000BD   8983         MOV     DPH,R1
   \   0000BF   F0           MOVX    @DPTR,A
   \   0000C0   8882         MOV     DPL,R0
   \   0000C2   8983         MOV     DPH,R1
   \   0000C4   A3           INC     DPTR
   \   0000C5   A882         MOV     R0,DPL
   \   0000C7   A983         MOV     R1,DPH
    982              *pBuf++ = LO_UINT16( utcTime.year );
   \   0000C9   7405         MOV     A,#0x5
   \   0000CB   12....       LCALL   ?XSTACK_DISP0_8
   \   0000CE   E0           MOVX    A,@DPTR
   \   0000CF   FA           MOV     R2,A
   \   0000D0   A3           INC     DPTR
   \   0000D1   E0           MOVX    A,@DPTR
   \   0000D2   FB           MOV     R3,A
   \   0000D3   EA           MOV     A,R2
   \   0000D4   8882         MOV     DPL,R0
   \   0000D6   8983         MOV     DPH,R1
   \   0000D8   F0           MOVX    @DPTR,A
   \   0000D9   8882         MOV     DPL,R0
   \   0000DB   8983         MOV     DPH,R1
   \   0000DD   A3           INC     DPTR
   \   0000DE   A882         MOV     R0,DPL
   \   0000E0   A983         MOV     R1,DPH
    983              *pBuf++ = HI_UINT16( utcTime.year );
   \   0000E2   7405         MOV     A,#0x5
   \   0000E4   12....       LCALL   ?XSTACK_DISP0_8
   \   0000E7   E0           MOVX    A,@DPTR
   \   0000E8   FA           MOV     R2,A
   \   0000E9   A3           INC     DPTR
   \   0000EA   E0           MOVX    A,@DPTR
   \   0000EB   FB           MOV     R3,A
   \   0000EC   E4           CLR     A
   \   0000ED   EB           MOV     A,R3
   \   0000EE   FA           MOV     R2,A
   \   0000EF   8882         MOV     DPL,R0
   \   0000F1   8983         MOV     DPH,R1
   \   0000F3   F0           MOVX    @DPTR,A
   \   0000F4   8882         MOV     DPL,R0
   \   0000F6   8983         MOV     DPH,R1
   \   0000F8   A3           INC     DPTR
   \   0000F9   A882         MOV     R0,DPL
   \   0000FB   A983         MOV     R1,DPH
    984          
    985              /* Build and send back the response */
    986              MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS),
    987                                             MT_SYS_GET_TIME, (uint8)(pBuf-buf), buf);
   \   0000FD                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   0000FD   EE           MOV     A,R6
   \   0000FE   FC           MOV     R4,A
   \   0000FF   EF           MOV     A,R7
   \   000100   FD           MOV     R5,A
   \   000101   EE           MOV     A,R6
   \   000102   FA           MOV     R2,A
   \   000103   E582         MOV     A,DPL
   \   000105   C3           CLR     C
   \   000106   9A           SUBB    A,R2
   \   000107   FB           MOV     R3,A
   \   000108   7A11         MOV     R2,#0x11
   \   00010A   7961         MOV     R1,#0x61
   \   00010C   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
    988          
    989              osal_mem_free( buf );
   \   00010F                ; Setup parameters for call to function osal_mem_free
   \   00010F   EE           MOV     A,R6
   \   000110   FA           MOV     R2,A
   \   000111   EF           MOV     A,R7
   \   000112   FB           MOV     R3,A
   \   000113   12....       LCALL   ??osal_mem_free?relay
    990            }
    991          }
   \                     ??MT_SysGetUtcTime_0:
   \   000116   7407         MOV     A,#0x7
   \   000118   12....       LCALL   ?DEALLOC_XSTACK8
   \   00011B   7F04         MOV     R7,#0x4
   \   00011D   02....       LJMP    ?BANKED_LEAVE_XDATA
    992          
    993          /***************************************************************************************************
    994           * @fn      MT_SysSetTxPower
    995           *
    996           * @brief   Set the transmit power.
    997           *
    998           * @param   pBuf - MT message containing the ZMacTransmitPower_t power level to set.
    999           *
   1000           * @return  None
   1001           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1002          void MT_SysSetTxPower(uint8 *pBuf)
   \                     MT_SysSetTxPower:
   1003          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1004            /* A local variable to hold the signed dBm value of TxPower that is being requested. */
   1005            uint8 signed_dBm_of_TxPower_requeseted;
   1006          
   1007            /*
   1008             * A local variable to hold the signed dBm value of TxPower that can be set which is closest to
   1009             * the requested dBm value of TxPower, but which is also valid according to a complex set of
   1010             * compile-time and run-time configuration which is interpreted by the macRadioSetTxPower()
   1011             * function.
   1012             */
   1013            uint8 signed_dBm_of_TxPower_range_corrected;
   1014          
   1015            /* Parse the requested dBm from the RPC message. */
   1016            signed_dBm_of_TxPower_requeseted = pBuf[MT_RPC_POS_DAT0];
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   85..82       MOV     DPL,?XSP + 0
   \   000015   85..83       MOV     DPH,?XSP + 1
   \   000018   F0           MOVX    @DPTR,A
   1017          
   1018            /*
   1019             * MAC_MlmeSetReq() will store an out-of-range dBm parameter value into the NIB. So it is not
   1020             * possible to learn the actual dBm value that will be set by invoking MACMlmeGetReq().
   1021             * But this actual dBm value is a required return value in the SRSP to this SREQ. Therefore,
   1022             * it is necessary to make this redundant pre-call to macRadioSetTxPower() here in order to run
   1023             * the code that will properly constrain the requested dBm to a valid range based on both the
   1024             * compile-time and the run-time configurations that affect the available valid ranges
   1025             * (i.e. MAC_MlmeSetReq() itself will invoke for a second time the macRadioSetTxPower() function).
   1026             */
   1027            signed_dBm_of_TxPower_range_corrected = macRadioSetTxPower(signed_dBm_of_TxPower_requeseted);
   \   000019                ; Setup parameters for call to function macRadioSetTxPower
   \   000019   85..82       MOV     DPL,?XSP + 0
   \   00001C   85..83       MOV     DPH,?XSP + 1
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F9           MOV     R1,A
   \   000021   12....       LCALL   ??macRadioSetTxPower?relay
   \   000024   E9           MOV     A,R1
   \   000025   C0E0         PUSH    A
   \   000027   7401         MOV     A,#0x1
   \   000029   12....       LCALL   ?XSTACK_DISP0_8
   \   00002C   D0E0         POP     A
   \   00002E   F0           MOVX    @DPTR,A
   1028          
   1029            /*
   1030             * Call the function to store the requested dBm in the MAC PIB and to set the TxPower as closely
   1031             * as possible within the TxPower range that is valid for the compile-time and run-time
   1032             * configuration.
   1033             */
   1034            (void)MAC_MlmeSetReq(MAC_PHY_TRANSMIT_POWER_SIGNED, &signed_dBm_of_TxPower_requeseted);
   \   00002F                ; Setup parameters for call to function MAC_MlmeSetReq
   \   00002F   85..82       MOV     DPL,?XSP + 0
   \   000032   85..83       MOV     DPH,?XSP + 1
   \   000035   AA82         MOV     R2,DPL
   \   000037   AB83         MOV     R3,DPH
   \   000039   79E5         MOV     R1,#-0x1b
   \   00003B   12....       LCALL   ??MAC_MlmeSetReq?relay
   \   00003E   E9           MOV     A,R1
   \   00003F   FE           MOV     R6,A
   1035          
   1036            /* Build and send back the response that includes the actual dBm TxPower that can be set. */
   1037            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_SYS),
   1038                                                 MT_SYS_SET_TX_POWER, 1,
   1039                                                 &signed_dBm_of_TxPower_range_corrected);
   \   000040                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000040   7401         MOV     A,#0x1
   \   000042   12....       LCALL   ?XSTACK_DISP0_8
   \   000045   AC82         MOV     R4,DPL
   \   000047   AD83         MOV     R5,DPH
   \   000049   7B01         MOV     R3,#0x1
   \   00004B   7A14         MOV     R2,#0x14
   \   00004D   7961         MOV     R1,#0x61
   \   00004F   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   1040          }
   \   000052   7402         MOV     A,#0x2
   \   000054   12....       LCALL   ?DEALLOC_XSTACK8
   \   000057   7F01         MOV     R7,#0x1
   \   000059   02....       LJMP    ?BANKED_LEAVE_XDATA
   1041          #endif /* MT_SYS_FUNC */
   1042          
   1043          /***************************************************************************************************
   1044           * SUPPORT
   1045           ***************************************************************************************************/
   1046          
   1047          /***************************************************************************************************
   1048           * @fn      MT_SysResetInd()
   1049           *
   1050           * @brief   Sends a ZTOOL "reset response" message.
   1051           *
   1052           * @param   None
   1053           *
   1054           * @return  None
   1055           *
   1056           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1057          void MT_SysResetInd(void)
   \                     MT_SysResetInd:
   1058          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 6
   \   000005   74FA         MOV     A,#-0x6
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1059            uint8 retArray[6];
   1060          
   1061            retArray[0] = ResetReason();   /* Reason */
   \   00000A   E59D         MOV     A,0x9d
   \   00000C   13           RRC     A
   \   00000D   13           RRC     A
   \   00000E   13           RRC     A
   \   00000F   541F         ANL     A,#0x1f
   \   000011   5403         ANL     A,#0x3
   \   000013   85..82       MOV     DPL,?XSP + 0
   \   000016   85..83       MOV     DPH,?XSP + 1
   \   000019   F0           MOVX    @DPTR,A
   1062            osal_memcpy( &retArray[1], MTVersionString, 5 );   /* Revision info */
   \   00001A                ; Setup parameters for call to function osal_memcpy
   \   00001A   75....       MOV     ?V0 + 0,#MTVersionString & 0xff
   \   00001D   75....       MOV     ?V0 + 1,#(MTVersionString >> 8) & 0xff
   \   000020   75..00       MOV     ?V0 + 2,#0x0
   \   000023   78..         MOV     R0,#?V0 + 0
   \   000025   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000028   7C05         MOV     R4,#0x5
   \   00002A   7D00         MOV     R5,#0x0
   \   00002C   7404         MOV     A,#0x4
   \   00002E   12....       LCALL   ?XSTACK_DISP0_8
   \   000031   AA82         MOV     R2,DPL
   \   000033   AB83         MOV     R3,DPH
   \   000035   12....       LCALL   ??osal_memcpy?relay
   \   000038   7403         MOV     A,#0x3
   \   00003A   12....       LCALL   ?DEALLOC_XSTACK8
   1063          
   1064            /* Send out Reset Response message */
   1065            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_SYS), MT_SYS_RESET_IND,
   1066                                          sizeof(retArray), retArray);
   \   00003D                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   00003D   85..82       MOV     DPL,?XSP + 0
   \   000040   85..83       MOV     DPH,?XSP + 1
   \   000043   AC82         MOV     R4,DPL
   \   000045   AD83         MOV     R5,DPH
   \   000047   7B06         MOV     R3,#0x6
   \   000049   7A80         MOV     R2,#-0x80
   \   00004B   7941         MOV     R1,#0x41
   \   00004D   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   1067          }
   \   000050   7406         MOV     A,#0x6
   \   000052   12....       LCALL   ?DEALLOC_XSTACK8
   \   000055   7F03         MOV     R7,#0x3
   \   000057   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   00005A                REQUIRE SLEEPSTA
   1068          
   1069          /***************************************************************************************************
   1070           * @fn      MT_SysOsalTimerExpired()
   1071           *
   1072           * @brief   Sends a SYS Osal Timer Expired
   1073           *
   1074           * @param   None
   1075           *
   1076           * @return  None
   1077           *
   1078           ***************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1079          void MT_SysOsalTimerExpired(uint8 Id)
   \                     MT_SysOsalTimerExpired:
   1080          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
   1081            uint8 retValue;
   1082            retValue = Id;
   \   00000C   85..82       MOV     DPL,?XSP + 0
   \   00000F   85..83       MOV     DPH,?XSP + 1
   \   000012   F0           MOVX    @DPTR,A
   1083            MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_SYS), MT_SYS_OSAL_TIMER_EXPIRED, 1, &retValue);
   \   000013                ; Setup parameters for call to function MT_BuildAndSendZToolResponse
   \   000013   85..82       MOV     DPL,?XSP + 0
   \   000016   85..83       MOV     DPH,?XSP + 1
   \   000019   AC82         MOV     R4,DPL
   \   00001B   AD83         MOV     R5,DPH
   \   00001D   7B01         MOV     R3,#0x1
   \   00001F   7A81         MOV     R2,#-0x7f
   \   000021   7941         MOV     R1,#0x41
   \   000023   12....       LCALL   ??MT_BuildAndSendZToolResponse?relay
   1084          }
   \   000026   7401         MOV     A,#0x1
   \   000028   12....       LCALL   ?DEALLOC_XSTACK8
   \   00002B   7F01         MOV     R7,#0x1
   \   00002D   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysCommandProcessing?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysCommandProcessing

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysPing?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysPing

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysVersion?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysVersion

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysSetExtAddr?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysSetExtAddr

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysGetExtAddr?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysGetExtAddr

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysOsalNVRead?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysOsalNVRead

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysOsalNVWrite?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysOsalNVWrite

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysOsalNVItemInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysOsalNVItemInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysOsalNVDelete?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysOsalNVDelete

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysOsalNVLength?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysOsalNVLength

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysOsalStartTimer?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysOsalStartTimer

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysOsalStopTimer?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysOsalStopTimer

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysRandom?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysRandom

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysAdcRead?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysAdcRead

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysGpio?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysGpio

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysStackTune?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysStackTune

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysSetUtcTime?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysSetUtcTime

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysGetUtcTime?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysGetUtcTime

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysSetTxPower?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysSetTxPower

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysResetInd?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysResetInd

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??MT_SysOsalTimerExpired?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    MT_SysOsalTimerExpired

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant {2, 0}>`:
   \   000000   02           DB 2
   \   000001   00           DB 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant {2, 0}>_1`:
   \   000000   02           DB 2
   \   000001   00           DB 0
   1085          
   1086          /***************************************************************************************************
   1087           ***************************************************************************************************/

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     MT_SysAdcRead                      1      0     21
       -> HalAdcRead                    0      0     24
       -> HalAdcRead                    0      0     24
       -> HalAdcRead                    0      0     24
       -> MT_BuildAndSendZToolResponse
                                        0      0     24
     MT_SysCommandProcessing            0      0      9
       -> MT_SysReset                   0      0     18
       -> MT_SysPing                    0      0     18
       -> MT_SysVersion                 0      0     18
       -> MT_SysSetExtAddr              0      0     18
       -> MT_SysGetExtAddr              0      0     18
       -> MT_SysOsalNVDelete            0      0     18
       -> MT_SysOsalNVItemInit          0      0     18
       -> MT_SysOsalNVLength            0      0     18
       -> MT_SysOsalNVRead              0      0     18
       -> MT_SysOsalNVWrite             0      0     18
       -> MT_SysOsalStartTimer          0      0     18
       -> MT_SysOsalStopTimer           0      0     18
       -> MT_SysRandom                  0      0     18
       -> MT_SysAdcRead                 0      0     18
       -> MT_SysGpio                    0      0     18
       -> MT_SysStackTune               0      0     18
       -> MT_SysSetUtcTime              0      0     18
       -> MT_SysGetUtcTime              0      0     18
       -> MT_SysSetTxPower              0      0     18
     MT_SysGetExtAddr                   2      0     17
       -> ZMacGetReq                    4      0     16
       -> MT_BuildAndSendZToolResponse
                                        4      0     16
     MT_SysGetUtcTime                   1      0     32
       -> osal_mem_alloc                0      0     38
       -> osal_getClock                 0      0     38
       -> osal_ConvertUTCTime           0      0     46
       -> osal_buffer_uint32            0      0     46
       -> MT_BuildAndSendZToolResponse
                                        0      0     38
       -> osal_mem_free                 0      0     38
     MT_SysGpio                         3      0     10
       -> MT_BuildAndSendZToolResponse
                                        4      0      2
     MT_SysOsalNVDelete                 1      0     19
       -> osal_nv_delete                0      0     20
       -> MT_BuildAndSendZToolResponse
                                        0      0     20
     MT_SysOsalNVItemInit               1      0     28
       -> osal_nv_item_init             0      0     34
       -> osal_nv_write                 0      0     38
       -> osal_nv_item_init             0      0     34
       -> MT_BuildAndSendZToolResponse
                                        0      0     30
     MT_SysOsalNVLength                 1      0     21
       -> osal_nv_item_len              0      0     24
       -> MT_BuildAndSendZToolResponse
                                        0      0     24
     MT_SysOsalNVRead                   2      0     33
       -> MT_BuildAndSendZToolResponse
                                        0      0     40
       -> MT_BuildAndSendZToolResponse
                                        0      0     40
       -> osal_nv_item_len              0      0     40
       -> osal_mem_alloc                0      0     40
       -> osal_memset                   0      0     40
       -> osal_nv_read                  0      0     48
       -> MT_BuildAndSendZToolResponse
                                        0      0     40
       -> osal_mem_free                 0      0     40
     MT_SysOsalNVWrite                  1      0     30
       -> zgSetItem                     0      0     38
       -> osal_nv_write                 0      0     42
       -> ZMacSetReq                    0      0     34
       -> MT_BuildAndSendZToolResponse
                                        0      0     34
     MT_SysOsalStartTimer               1      0     19
       -> osal_start_timerEx            0      0     20
       -> MT_BuildAndSendZToolResponse
                                        0      0     20
     MT_SysOsalStopTimer                1      0     19
       -> osal_stop_timerEx             0      0     20
       -> MT_BuildAndSendZToolResponse
                                        0      0     20
     MT_SysOsalTimerExpired             1      0     10
       -> MT_BuildAndSendZToolResponse
                                        0      0     20
     MT_SysPing                         3      0     11
       -> MT_BuildAndSendZToolResponse
                                        4      0      4
     MT_SysRandom                       1      0     21
       -> Onboard_rand                  0      0     24
       -> MT_BuildAndSendZToolResponse
                                        0      0     24
     MT_SysReset                        2      0      9
       -> Onboard_soft_reset            4      0      0
     MT_SysResetInd                     1      0     20
       -> osal_memcpy                   0      0     40
       -> MT_BuildAndSendZToolResponse
                                        0      0     34
     MT_SysSetExtAddr                   1      0     24
       -> ZMacSetReq                    0      0     22
       -> osal_nv_write                 0      0     30
       -> MT_BuildAndSendZToolResponse
                                        0      0     22
     MT_SysSetTxPower                   1      0     20
       -> macRadioSetTxPower            0      0     22
       -> MAC_MlmeSetReq                0      0     22
       -> MT_BuildAndSendZToolResponse
                                        0      0     22
     MT_SysSetUtcTime                   1      0     33
       -> osal_build_uint32             0      0     48
       -> osal_build_uint16             0      0     48
       -> osal_ConvertUTCSecs           0      0     48
       -> osal_setClock                 0      0     48
       -> MT_BuildAndSendZToolResponse
                                        0      0     48
     MT_SysStackTune                    1      0     19
       -> ZMacSetReq                    0      0     20
       -> ZMacGetReq                    0      0     20
       -> ZMacSetReq                    0      0     20
       -> MT_BuildAndSendZToolResponse
                                        0      0     20
     MT_SysVersion                      2      0      9
       -> MT_BuildAndSendZToolResponse
                                        4      0      0


   Segment part sizes:

     Function/Label                  Bytes
     --------------                  -----
     SLEEPSTA                           1
     _A_IEN0                            1
     WDCTL                              1
     MT_SysOsalEventId                  8
     MT_SysCommandProcessing          167
     MT_SysReset                       36
     MT_SysPing                        65
     MT_SysVersion                     24
     MT_SysSetExtAddr                 126
     MT_SysGetExtAddr                  56
     MT_SysOsalNVRead                 546
     MT_SysOsalNVWrite                235
     MT_SysOsalNVItemInit             264
     MT_SysOsalNVDelete               118
     MT_SysOsalNVLength               107
     MT_SysOsalStartTimer             177
     MT_SysOsalStopTimer              145
     MT_SysRandom                      73
     MT_SysAdcRead                    177
     MT_SysGpio                       247
     MT_SysStackTune                  153
     MT_SysSetUtcTime                 522
     MT_SysGetUtcTime                 288
     MT_SysSetTxPower                  92
     MT_SysResetInd                    90
     MT_SysOsalTimerExpired            48
     ??MT_SysCommandProcessing?relay    6
     ??MT_SysReset?relay                6
     ??MT_SysPing?relay                 6
     ??MT_SysVersion?relay              6
     ??MT_SysSetExtAddr?relay           6
     ??MT_SysGetExtAddr?relay           6
     ??MT_SysOsalNVRead?relay           6
     ??MT_SysOsalNVWrite?relay          6
     ??MT_SysOsalNVItemInit?relay       6
     ??MT_SysOsalNVDelete?relay         6
     ??MT_SysOsalNVLength?relay         6
     ??MT_SysOsalStartTimer?relay       6
     ??MT_SysOsalStopTimer?relay        6
     ??MT_SysRandom?relay               6
     ??MT_SysAdcRead?relay              6
     ??MT_SysGpio?relay                 6
     ??MT_SysStackTune?relay            6
     ??MT_SysSetUtcTime?relay           6
     ??MT_SysGetUtcTime?relay           6
     ??MT_SysSetTxPower?relay           6
     ??MT_SysResetInd?relay             6
     ??MT_SysOsalTimerExpired?relay     6
     ?<Constant {2, 0}>                 2
     ?<Constant {2, 0}>_1               2

 
 3 756 bytes in segment BANKED_CODE
   132 bytes in segment BANK_RELAYS
     3 bytes in segment SFR_AN
    12 bytes in segment XDATA_ROM_C
 
 3 888 bytes of CODE  memory
    12 bytes of CONST memory
     0 bytes of DATA  memory (+ 3 bytes shared)

Errors: none
Warnings: none
